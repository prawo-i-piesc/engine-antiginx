
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../Runner/">
      
      
        <link rel="next" href="../../Engined/">
      
      
        
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.1">
    
    
      
        <title>Tests - Engine-AntiGinx Documentation</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.484c7ddc.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CJetBrains+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"JetBrains Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../css/timeago.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#httpstest-module" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Engine-AntiGinx Documentation" class="md-header__button md-logo" aria-label="Engine-AntiGinx Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Engine-AntiGinx Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Tests
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="indigo"  aria-label="Dark Mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Dark Mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent="indigo"  aria-label="Light Mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Light Mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/prawo-i-piesc/engine-antiginx" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    prawo-i-piesc/engine-antiginx
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../" class="md-tabs__link">
          
  
  
  App Documentation

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../Engined/" class="md-tabs__link">
          
  
  
  Engined Documentation

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Engine-AntiGinx Documentation" class="md-nav__button md-logo" aria-label="Engine-AntiGinx Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Engine-AntiGinx Documentation
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/prawo-i-piesc/engine-antiginx" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    prawo-i-piesc/engine-antiginx
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Home
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    App Documentation
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    App Documentation
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    App
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../CVE/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    CVE
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Errors/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Errors
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Helpers/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Helpers
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../HTTP/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    HTTP
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../parser/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Parameter-Parser
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Registry/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Registry
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Reporter/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Reporter
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Runner/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Runner
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    Tests
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    Tests
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#httpstest-module" class="md-nav__link">
    <span class="md-ellipsis">
      
        HTTPSTest Module
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#serverheadertest-module" class="md-nav__link">
    <span class="md-ellipsis">
      
        ServerHeaderTest Module
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#index" class="md-nav__link">
    <span class="md-ellipsis">
      
        Index
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#variables" class="md-nav__link">
    <span class="md-ellipsis">
      
        Variables
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#func-aggregatesecurityissues" class="md-nav__link">
    <span class="md-ellipsis">
      
        func aggregateSecurityIssues
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#func-analyzecrossoriginheaders" class="md-nav__link">
    <span class="md-ellipsis">
      
        func analyzeCrossOriginHeaders
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#func-analyzedirectivesecurity" class="md-nav__link">
    <span class="md-ellipsis">
      
        func analyzeDirectiveSecurity
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#func-analyzehstsheader" class="md-nav__link">
    <span class="md-ellipsis">
      
        func analyzeHSTSHeader
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#func-analyzeindividualcookiesecurity" class="md-nav__link">
    <span class="md-ellipsis">
      
        func analyzeIndividualCookieSecurity
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#func-analyzepermissionspolicyheader" class="md-nav__link">
    <span class="md-ellipsis">
      
        func analyzePermissionsPolicyHeader
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#func-analyzereferrerpolicyheader" class="md-nav__link">
    <span class="md-ellipsis">
      
        func analyzeReferrerPolicyHeader
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#func-analyzexcontenttypeoptionsheader" class="md-nav__link">
    <span class="md-ellipsis">
      
        func analyzeXContentTypeOptionsHeader
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#func-assessembeddingcapability" class="md-nav__link">
    <span class="md-ellipsis">
      
        func assessEmbeddingCapability
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#func-calculatecookiesecurityscore" class="md-nav__link">
    <span class="md-ellipsis">
      
        func calculateCookieSecurityScore
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#func-calculateindividualcookiescore" class="md-nav__link">
    <span class="md-ellipsis">
      
        func calculateIndividualCookieScore
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#func-calculateobfuscationscore" class="md-nav__link">
    <span class="md-ellipsis">
      
        func calculateObfuscationScore
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#func-calculatepolicystrength" class="md-nav__link">
    <span class="md-ellipsis">
      
        func calculatePolicyStrength
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#func-checkmissingdirectives" class="md-nav__link">
    <span class="md-ellipsis">
      
        func checkMissingDirectives
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#func-containshash" class="md-nav__link">
    <span class="md-ellipsis">
      
        func containsHash
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#func-containsnonce" class="md-nav__link">
    <span class="md-ellipsis">
      
        func containsNonce
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#func-detectbase64encoding" class="md-nav__link">
    <span class="md-ellipsis">
      
        func detectBase64Encoding
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#func-detectcharcodeobfuscation" class="md-nav__link">
    <span class="md-ellipsis">
      
        func detectCharCodeObfuscation
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#func-detectdynamicexecution" class="md-nav__link">
    <span class="md-ellipsis">
      
        func detectDynamicExecution
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#func-detectencodedstrings" class="md-nav__link">
    <span class="md-ellipsis">
      
        func detectEncodedStrings
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#func-detectescapesequences" class="md-nav__link">
    <span class="md-ellipsis">
      
        func detectEscapeSequences
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#func-detectmaliciousindicators" class="md-nav__link">
    <span class="md-ellipsis">
      
        func detectMaliciousIndicators
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#func-detectsuspiciouspatterns" class="md-nav__link">
    <span class="md-ellipsis">
      
        func detectSuspiciousPatterns
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#func-detecttechnologies" class="md-nav__link">
    <span class="md-ellipsis">
      
        func detectTechnologies
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#func-determinecspprotectionlevel" class="md-nav__link">
    <span class="md-ellipsis">
      
        func determineCSPProtectionLevel
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#func-determineobfuscationlevel" class="md-nav__link">
    <span class="md-ellipsis">
      
        func determineObfuscationLevel
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#func-determineprotectionlevel" class="md-nav__link">
    <span class="md-ellipsis">
      
        func determineProtectionLevel
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#func-evaluatedirectivecompliance" class="md-nav__link">
    <span class="md-ellipsis">
      
        func evaluateDirectiveCompliance
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#func-extractframeancestorsvalue" class="md-nav__link">
    <span class="md-ellipsis">
      
        func extractFrameAncestorsValue
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#func-extractmaxage" class="md-nav__link">
    <span class="md-ellipsis">
      
        func extractMaxAge
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#func-extractscriptcontent" class="md-nav__link">
    <span class="md-ellipsis">
      
        func extractScriptContent
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#func-extractversion" class="md-nav__link">
    <span class="md-ellipsis">
      
        func extractVersion
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#func-formatduration" class="md-nav__link">
    <span class="md-ellipsis">
      
        func formatDuration
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#func-formatmaxage" class="md-nav__link">
    <span class="md-ellipsis">
      
        func formatMaxAge
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#func-generatecspdescription" class="md-nav__link">
    <span class="md-ellipsis">
      
        func generateCSPDescription
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#func-generatecookiedescription" class="md-nav__link">
    <span class="md-ellipsis">
      
        func generateCookieDescription
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#func-generatecrossorigindescription" class="md-nav__link">
    <span class="md-ellipsis">
      
        func generateCrossOriginDescription
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#func-generatedescription" class="md-nav__link">
    <span class="md-ellipsis">
      
        func generateDescription
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#func-generatehstsdescription" class="md-nav__link">
    <span class="md-ellipsis">
      
        func generateHSTSDescription
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#func-generateobfuscationdescription" class="md-nav__link">
    <span class="md-ellipsis">
      
        func generateObfuscationDescription
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#func-generatepermissionspolicydescription" class="md-nav__link">
    <span class="md-ellipsis">
      
        func generatePermissionsPolicyDescription
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#func-generatereferrerpolicydescription" class="md-nav__link">
    <span class="md-ellipsis">
      
        func generateReferrerPolicyDescription
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#func-generateserverexposuredescription" class="md-nav__link">
    <span class="md-ellipsis">
      
        func generateServerExposureDescription
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#func-generatexcontenttypeoptionsdescription" class="md-nav__link">
    <span class="md-ellipsis">
      
        func generateXContentTypeOptionsDescription
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#func-getsamesitestring" class="md-nav__link">
    <span class="md-ellipsis">
      
        func getSameSiteString
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#func-hasonlybroadsources" class="md-nav__link">
    <span class="md-ellipsis">
      
        func hasOnlyBroadSources
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#func-hasspecificdomains" class="md-nav__link">
    <span class="md-ellipsis">
      
        func hasSpecificDomains
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#func-isallowlistrestricted" class="md-nav__link">
    <span class="md-ellipsis">
      
        func isAllowlistRestricted
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#func-ispredictablevalue" class="md-nav__link">
    <span class="md-ellipsis">
      
        func isPredictableValue
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#func-issessioncookie" class="md-nav__link">
    <span class="md-ellipsis">
      
        func isSessionCookie
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#type-cspanalysis" class="md-nav__link">
    <span class="md-ellipsis">
      
        type CSPAnalysis
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="type CSPAnalysis">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#func-analyzecspheader" class="md-nav__link">
    <span class="md-ellipsis">
      
        func analyzeCSPHeader
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#type-cookiesecurityanalysis" class="md-nav__link">
    <span class="md-ellipsis">
      
        type CookieSecurityAnalysis
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="type CookieSecurityAnalysis">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#func-analyzecookiesecurity" class="md-nav__link">
    <span class="md-ellipsis">
      
        func analyzeCookieSecurity
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#type-cookiesecuritydetail" class="md-nav__link">
    <span class="md-ellipsis">
      
        type CookieSecurityDetail
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="type CookieSecurityDetail">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#func-analyzesinglecookie" class="md-nav__link">
    <span class="md-ellipsis">
      
        func analyzeSingleCookie
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#type-crossoriginanalysis" class="md-nav__link">
    <span class="md-ellipsis">
      
        type CrossOriginAnalysis
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#type-jsobfuscationanalysis" class="md-nav__link">
    <span class="md-ellipsis">
      
        type JSObfuscationAnalysis
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="type JSObfuscationAnalysis">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#func-analyzejsobfuscation" class="md-nav__link">
    <span class="md-ellipsis">
      
        func analyzeJSObfuscation
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#type-responsetest" class="md-nav__link">
    <span class="md-ellipsis">
      
        type ResponseTest
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="type ResponseTest">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#func-newcsptest" class="md-nav__link">
    <span class="md-ellipsis">
      
        func NewCSPTest
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#func-newcookiesecuritytest" class="md-nav__link">
    <span class="md-ellipsis">
      
        func NewCookieSecurityTest
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#func-newcrossorigintest" class="md-nav__link">
    <span class="md-ellipsis">
      
        func NewCrossOriginTest
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#func-newhststest" class="md-nav__link">
    <span class="md-ellipsis">
      
        func NewHSTSTest
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#func-newhttpstest" class="md-nav__link">
    <span class="md-ellipsis">
      
        func NewHTTPSTest
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#func-newjsobfuscationtest" class="md-nav__link">
    <span class="md-ellipsis">
      
        func NewJSObfuscationTest
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#func-newpermissionspolicytest" class="md-nav__link">
    <span class="md-ellipsis">
      
        func NewPermissionsPolicyTest
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#func-newreferrerpolicytest" class="md-nav__link">
    <span class="md-ellipsis">
      
        func NewReferrerPolicyTest
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#func-newserverheadertest" class="md-nav__link">
    <span class="md-ellipsis">
      
        func NewServerHeaderTest
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#func-newxcontenttypeoptionstest" class="md-nav__link">
    <span class="md-ellipsis">
      
        func NewXContentTypeOptionsTest
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#func-newxframetest" class="md-nav__link">
    <span class="md-ellipsis">
      
        func NewXFrameTest
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#func-responsetest-getdescription" class="md-nav__link">
    <span class="md-ellipsis">
      
        func (*ResponseTest) GetDescription
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#func-responsetest-getid" class="md-nav__link">
    <span class="md-ellipsis">
      
        func (*ResponseTest) GetId
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#func-responsetest-getname" class="md-nav__link">
    <span class="md-ellipsis">
      
        func (*ResponseTest) GetName
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#func-responsetest-run" class="md-nav__link">
    <span class="md-ellipsis">
      
        func (*ResponseTest) Run
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#type-responsetestparams" class="md-nav__link">
    <span class="md-ellipsis">
      
        type ResponseTestParams
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#type-serverheaderanalysis" class="md-nav__link">
    <span class="md-ellipsis">
      
        type ServerHeaderAnalysis
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="type ServerHeaderAnalysis">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#func-analyzeserverheaders" class="md-nav__link">
    <span class="md-ellipsis">
      
        func analyzeServerHeaders
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#type-testresult" class="md-nav__link">
    <span class="md-ellipsis">
      
        type TestResult
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#type-testresultwrapper" class="md-nav__link">
    <span class="md-ellipsis">
      
        type TestResultWrapper
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#type-threatlevel" class="md-nav__link">
    <span class="md-ellipsis">
      
        type ThreatLevel
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="type ThreatLevel">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#func-evaluatecspthreatlevel" class="md-nav__link">
    <span class="md-ellipsis">
      
        func evaluateCSPThreatLevel
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#func-evaluatecookiethreatlevel" class="md-nav__link">
    <span class="md-ellipsis">
      
        func evaluateCookieThreatLevel
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#func-evaluatecrossoriginthreatlevel" class="md-nav__link">
    <span class="md-ellipsis">
      
        func evaluateCrossOriginThreatLevel
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#func-evaluatehststhreatlevel" class="md-nav__link">
    <span class="md-ellipsis">
      
        func evaluateHSTSThreatLevel
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#func-evaluateobfuscationthreat" class="md-nav__link">
    <span class="md-ellipsis">
      
        func evaluateObfuscationThreat
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#func-evaluatepermissionspolicythreatlevel" class="md-nav__link">
    <span class="md-ellipsis">
      
        func evaluatePermissionsPolicyThreatLevel
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#func-evaluatereferrerpolicythreatlevel" class="md-nav__link">
    <span class="md-ellipsis">
      
        func evaluateReferrerPolicyThreatLevel
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#func-evaluateserverexposurethreatlevel" class="md-nav__link">
    <span class="md-ellipsis">
      
        func evaluateServerExposureThreatLevel
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#func-evaluatexcontenttypeoptionsthreatlevel" class="md-nav__link">
    <span class="md-ellipsis">
      
        func evaluateXContentTypeOptionsThreatLevel
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#func-mapcvethreatlevel" class="md-nav__link">
    <span class="md-ellipsis">
      
        func mapCVEThreatLevel
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#func-threatlevel-marshaljson" class="md-nav__link">
    <span class="md-ellipsis">
      
        func (ThreatLevel) MarshalJSON
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#func-threatlevel-string" class="md-nav__link">
    <span class="md-ellipsis">
      
        func (ThreatLevel) String
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Engined Documentation
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Engined Documentation
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Engined/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Daemon
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#httpstest-module" class="md-nav__link">
    <span class="md-ellipsis">
      
        HTTPSTest Module
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#serverheadertest-module" class="md-nav__link">
    <span class="md-ellipsis">
      
        ServerHeaderTest Module
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#index" class="md-nav__link">
    <span class="md-ellipsis">
      
        Index
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#variables" class="md-nav__link">
    <span class="md-ellipsis">
      
        Variables
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#func-aggregatesecurityissues" class="md-nav__link">
    <span class="md-ellipsis">
      
        func aggregateSecurityIssues
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#func-analyzecrossoriginheaders" class="md-nav__link">
    <span class="md-ellipsis">
      
        func analyzeCrossOriginHeaders
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#func-analyzedirectivesecurity" class="md-nav__link">
    <span class="md-ellipsis">
      
        func analyzeDirectiveSecurity
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#func-analyzehstsheader" class="md-nav__link">
    <span class="md-ellipsis">
      
        func analyzeHSTSHeader
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#func-analyzeindividualcookiesecurity" class="md-nav__link">
    <span class="md-ellipsis">
      
        func analyzeIndividualCookieSecurity
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#func-analyzepermissionspolicyheader" class="md-nav__link">
    <span class="md-ellipsis">
      
        func analyzePermissionsPolicyHeader
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#func-analyzereferrerpolicyheader" class="md-nav__link">
    <span class="md-ellipsis">
      
        func analyzeReferrerPolicyHeader
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#func-analyzexcontenttypeoptionsheader" class="md-nav__link">
    <span class="md-ellipsis">
      
        func analyzeXContentTypeOptionsHeader
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#func-assessembeddingcapability" class="md-nav__link">
    <span class="md-ellipsis">
      
        func assessEmbeddingCapability
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#func-calculatecookiesecurityscore" class="md-nav__link">
    <span class="md-ellipsis">
      
        func calculateCookieSecurityScore
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#func-calculateindividualcookiescore" class="md-nav__link">
    <span class="md-ellipsis">
      
        func calculateIndividualCookieScore
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#func-calculateobfuscationscore" class="md-nav__link">
    <span class="md-ellipsis">
      
        func calculateObfuscationScore
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#func-calculatepolicystrength" class="md-nav__link">
    <span class="md-ellipsis">
      
        func calculatePolicyStrength
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#func-checkmissingdirectives" class="md-nav__link">
    <span class="md-ellipsis">
      
        func checkMissingDirectives
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#func-containshash" class="md-nav__link">
    <span class="md-ellipsis">
      
        func containsHash
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#func-containsnonce" class="md-nav__link">
    <span class="md-ellipsis">
      
        func containsNonce
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#func-detectbase64encoding" class="md-nav__link">
    <span class="md-ellipsis">
      
        func detectBase64Encoding
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#func-detectcharcodeobfuscation" class="md-nav__link">
    <span class="md-ellipsis">
      
        func detectCharCodeObfuscation
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#func-detectdynamicexecution" class="md-nav__link">
    <span class="md-ellipsis">
      
        func detectDynamicExecution
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#func-detectencodedstrings" class="md-nav__link">
    <span class="md-ellipsis">
      
        func detectEncodedStrings
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#func-detectescapesequences" class="md-nav__link">
    <span class="md-ellipsis">
      
        func detectEscapeSequences
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#func-detectmaliciousindicators" class="md-nav__link">
    <span class="md-ellipsis">
      
        func detectMaliciousIndicators
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#func-detectsuspiciouspatterns" class="md-nav__link">
    <span class="md-ellipsis">
      
        func detectSuspiciousPatterns
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#func-detecttechnologies" class="md-nav__link">
    <span class="md-ellipsis">
      
        func detectTechnologies
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#func-determinecspprotectionlevel" class="md-nav__link">
    <span class="md-ellipsis">
      
        func determineCSPProtectionLevel
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#func-determineobfuscationlevel" class="md-nav__link">
    <span class="md-ellipsis">
      
        func determineObfuscationLevel
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#func-determineprotectionlevel" class="md-nav__link">
    <span class="md-ellipsis">
      
        func determineProtectionLevel
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#func-evaluatedirectivecompliance" class="md-nav__link">
    <span class="md-ellipsis">
      
        func evaluateDirectiveCompliance
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#func-extractframeancestorsvalue" class="md-nav__link">
    <span class="md-ellipsis">
      
        func extractFrameAncestorsValue
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#func-extractmaxage" class="md-nav__link">
    <span class="md-ellipsis">
      
        func extractMaxAge
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#func-extractscriptcontent" class="md-nav__link">
    <span class="md-ellipsis">
      
        func extractScriptContent
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#func-extractversion" class="md-nav__link">
    <span class="md-ellipsis">
      
        func extractVersion
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#func-formatduration" class="md-nav__link">
    <span class="md-ellipsis">
      
        func formatDuration
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#func-formatmaxage" class="md-nav__link">
    <span class="md-ellipsis">
      
        func formatMaxAge
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#func-generatecspdescription" class="md-nav__link">
    <span class="md-ellipsis">
      
        func generateCSPDescription
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#func-generatecookiedescription" class="md-nav__link">
    <span class="md-ellipsis">
      
        func generateCookieDescription
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#func-generatecrossorigindescription" class="md-nav__link">
    <span class="md-ellipsis">
      
        func generateCrossOriginDescription
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#func-generatedescription" class="md-nav__link">
    <span class="md-ellipsis">
      
        func generateDescription
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#func-generatehstsdescription" class="md-nav__link">
    <span class="md-ellipsis">
      
        func generateHSTSDescription
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#func-generateobfuscationdescription" class="md-nav__link">
    <span class="md-ellipsis">
      
        func generateObfuscationDescription
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#func-generatepermissionspolicydescription" class="md-nav__link">
    <span class="md-ellipsis">
      
        func generatePermissionsPolicyDescription
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#func-generatereferrerpolicydescription" class="md-nav__link">
    <span class="md-ellipsis">
      
        func generateReferrerPolicyDescription
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#func-generateserverexposuredescription" class="md-nav__link">
    <span class="md-ellipsis">
      
        func generateServerExposureDescription
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#func-generatexcontenttypeoptionsdescription" class="md-nav__link">
    <span class="md-ellipsis">
      
        func generateXContentTypeOptionsDescription
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#func-getsamesitestring" class="md-nav__link">
    <span class="md-ellipsis">
      
        func getSameSiteString
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#func-hasonlybroadsources" class="md-nav__link">
    <span class="md-ellipsis">
      
        func hasOnlyBroadSources
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#func-hasspecificdomains" class="md-nav__link">
    <span class="md-ellipsis">
      
        func hasSpecificDomains
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#func-isallowlistrestricted" class="md-nav__link">
    <span class="md-ellipsis">
      
        func isAllowlistRestricted
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#func-ispredictablevalue" class="md-nav__link">
    <span class="md-ellipsis">
      
        func isPredictableValue
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#func-issessioncookie" class="md-nav__link">
    <span class="md-ellipsis">
      
        func isSessionCookie
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#type-cspanalysis" class="md-nav__link">
    <span class="md-ellipsis">
      
        type CSPAnalysis
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="type CSPAnalysis">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#func-analyzecspheader" class="md-nav__link">
    <span class="md-ellipsis">
      
        func analyzeCSPHeader
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#type-cookiesecurityanalysis" class="md-nav__link">
    <span class="md-ellipsis">
      
        type CookieSecurityAnalysis
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="type CookieSecurityAnalysis">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#func-analyzecookiesecurity" class="md-nav__link">
    <span class="md-ellipsis">
      
        func analyzeCookieSecurity
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#type-cookiesecuritydetail" class="md-nav__link">
    <span class="md-ellipsis">
      
        type CookieSecurityDetail
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="type CookieSecurityDetail">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#func-analyzesinglecookie" class="md-nav__link">
    <span class="md-ellipsis">
      
        func analyzeSingleCookie
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#type-crossoriginanalysis" class="md-nav__link">
    <span class="md-ellipsis">
      
        type CrossOriginAnalysis
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#type-jsobfuscationanalysis" class="md-nav__link">
    <span class="md-ellipsis">
      
        type JSObfuscationAnalysis
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="type JSObfuscationAnalysis">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#func-analyzejsobfuscation" class="md-nav__link">
    <span class="md-ellipsis">
      
        func analyzeJSObfuscation
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#type-responsetest" class="md-nav__link">
    <span class="md-ellipsis">
      
        type ResponseTest
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="type ResponseTest">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#func-newcsptest" class="md-nav__link">
    <span class="md-ellipsis">
      
        func NewCSPTest
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#func-newcookiesecuritytest" class="md-nav__link">
    <span class="md-ellipsis">
      
        func NewCookieSecurityTest
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#func-newcrossorigintest" class="md-nav__link">
    <span class="md-ellipsis">
      
        func NewCrossOriginTest
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#func-newhststest" class="md-nav__link">
    <span class="md-ellipsis">
      
        func NewHSTSTest
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#func-newhttpstest" class="md-nav__link">
    <span class="md-ellipsis">
      
        func NewHTTPSTest
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#func-newjsobfuscationtest" class="md-nav__link">
    <span class="md-ellipsis">
      
        func NewJSObfuscationTest
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#func-newpermissionspolicytest" class="md-nav__link">
    <span class="md-ellipsis">
      
        func NewPermissionsPolicyTest
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#func-newreferrerpolicytest" class="md-nav__link">
    <span class="md-ellipsis">
      
        func NewReferrerPolicyTest
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#func-newserverheadertest" class="md-nav__link">
    <span class="md-ellipsis">
      
        func NewServerHeaderTest
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#func-newxcontenttypeoptionstest" class="md-nav__link">
    <span class="md-ellipsis">
      
        func NewXContentTypeOptionsTest
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#func-newxframetest" class="md-nav__link">
    <span class="md-ellipsis">
      
        func NewXFrameTest
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#func-responsetest-getdescription" class="md-nav__link">
    <span class="md-ellipsis">
      
        func (*ResponseTest) GetDescription
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#func-responsetest-getid" class="md-nav__link">
    <span class="md-ellipsis">
      
        func (*ResponseTest) GetId
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#func-responsetest-getname" class="md-nav__link">
    <span class="md-ellipsis">
      
        func (*ResponseTest) GetName
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#func-responsetest-run" class="md-nav__link">
    <span class="md-ellipsis">
      
        func (*ResponseTest) Run
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#type-responsetestparams" class="md-nav__link">
    <span class="md-ellipsis">
      
        type ResponseTestParams
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#type-serverheaderanalysis" class="md-nav__link">
    <span class="md-ellipsis">
      
        type ServerHeaderAnalysis
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="type ServerHeaderAnalysis">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#func-analyzeserverheaders" class="md-nav__link">
    <span class="md-ellipsis">
      
        func analyzeServerHeaders
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#type-testresult" class="md-nav__link">
    <span class="md-ellipsis">
      
        type TestResult
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#type-testresultwrapper" class="md-nav__link">
    <span class="md-ellipsis">
      
        type TestResultWrapper
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#type-threatlevel" class="md-nav__link">
    <span class="md-ellipsis">
      
        type ThreatLevel
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="type ThreatLevel">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#func-evaluatecspthreatlevel" class="md-nav__link">
    <span class="md-ellipsis">
      
        func evaluateCSPThreatLevel
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#func-evaluatecookiethreatlevel" class="md-nav__link">
    <span class="md-ellipsis">
      
        func evaluateCookieThreatLevel
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#func-evaluatecrossoriginthreatlevel" class="md-nav__link">
    <span class="md-ellipsis">
      
        func evaluateCrossOriginThreatLevel
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#func-evaluatehststhreatlevel" class="md-nav__link">
    <span class="md-ellipsis">
      
        func evaluateHSTSThreatLevel
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#func-evaluateobfuscationthreat" class="md-nav__link">
    <span class="md-ellipsis">
      
        func evaluateObfuscationThreat
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#func-evaluatepermissionspolicythreatlevel" class="md-nav__link">
    <span class="md-ellipsis">
      
        func evaluatePermissionsPolicyThreatLevel
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#func-evaluatereferrerpolicythreatlevel" class="md-nav__link">
    <span class="md-ellipsis">
      
        func evaluateReferrerPolicyThreatLevel
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#func-evaluateserverexposurethreatlevel" class="md-nav__link">
    <span class="md-ellipsis">
      
        func evaluateServerExposureThreatLevel
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#func-evaluatexcontenttypeoptionsthreatlevel" class="md-nav__link">
    <span class="md-ellipsis">
      
        func evaluateXContentTypeOptionsThreatLevel
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#func-mapcvethreatlevel" class="md-nav__link">
    <span class="md-ellipsis">
      
        func mapCVEThreatLevel
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#func-threatlevel-marshaljson" class="md-nav__link">
    <span class="md-ellipsis">
      
        func (ThreatLevel) MarshalJSON
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#func-threatlevel-string" class="md-nav__link">
    <span class="md-ellipsis">
      
        func (ThreatLevel) String
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
                



  


  <nav class="md-path" aria-label="Navigation" >
    <ol class="md-path__list">
      
        
  
  
    <li class="md-path__item">
      <a href="../.." class="md-path__link">
        
  <span class="md-ellipsis">
    Home
  </span>

      </a>
    </li>
  

      
      
        
  
  
    
    
      <li class="md-path__item">
        <a href="../" class="md-path__link">
          
  <span class="md-ellipsis">
    App Documentation
  </span>

        </a>
      </li>
    
  

      
    </ol>
  </nav>

              
              <article class="md-content__inner md-typeset">
                
                  


  
  


<!-- Code generated by gomarkdoc. DO NOT EDIT -->

<h1 id="tests">Tests<a class="headerlink" href="#tests" title="Permanent link">&para;</a></h1>
<div class="language-go highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="kn">import</span><span class="w"> </span><span class="s">&quot;Engine-AntiGinx/App/Tests&quot;</span>
</span></code></pre></div>
<p>Package Tests provides security test implementations for HTTP response analysis. This file contains the CSP (Content Security Policy) test that analyzes Content-Security-Policy header configuration to assess protection against XSS, data injection, and other web vulnerabilities.</p>
<p>Package Tests provides security test implementations for HTTP response analysis. This file contains the Cookie Security test that analyzes Set-Cookie headers for security best practices including HttpOnly, Secure, SameSite attributes, expiration times, and potential session fixation vulnerabilities.</p>
<p>Package Tests provides security test implementations for HTTP response analysis. This file contains the Cross-Origin security headers test that analyzes Cross-Origin-Embedder-Policy (COEP), Cross-Origin-Resource-Policy (CORP), and Cross-Origin-Opener-Policy (COOP) headers to assess protection against cross-origin attacks and isolation vulnerabilities.</p>
<p>Package Tests provides security test implementations for HTTP response analysis. This file contains the HSTS (HTTP Strict Transport Security) test that checks for proper HSTS header configuration to prevent protocol downgrade attacks.</p>
<p>Package Tests provides security testing functionality for Engine-AntiGinx.</p>
<h3 id="httpstest-module">HTTPSTest Module<a class="headerlink" href="#httpstest-module" title="Permanent link">&para;</a></h3>
<p>This module implements HTTPS protocol verification to ensure secure communication channels. It validates whether websites enforce encrypted HTTPS connections instead of insecure HTTP, which is critical for protecting data in transit.</p>
<p>Security Importance:</p>
<p>HTTPS (HTTP Secure) uses TLS/SSL encryption to:</p>
<ul>
<li>Encrypt data transmission preventing eavesdropping</li>
<li>Authenticate the server preventing man-in-the-middle attacks</li>
<li>Ensure data integrity preventing tampering</li>
<li>Meet compliance requirements (PCI DSS, GDPR, HIPAA)</li>
</ul>
<p>HTTP vs HTTPS:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>HTTP:  No encryption, data sent in plaintext  High threat
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a>HTTPS: TLS/SSL encryption, secure transmission  No threat
</span></code></pre></div>
<p>Threat Assessment:</p>
<ul>
<li>ThreatLevel.None: Website uses HTTPS with proper encryption</li>
<li>ThreatLevel.High: Website uses HTTP exposing data to interception</li>
</ul>
<p>This test is typically the first security check performed as it validates the fundamental security posture of a web application.</p>
<p>Integration:</p>
<p>This test is registered in the test registry and executed by the job runner during security scanning operations.</p>
<p>Package Tests provides security test implementations for HTTP response analysis. This file contains the JavaScript Obfuscation test that detects obfuscated JavaScript code which may indicate malicious activity, code hiding, or security evasion techniques.</p>
<p>Package Tests provides security test implementations for HTTP response analysis. This file contains the Permissions-Policy test that checks for proper browser feature access control configuration to prevent abuse of sensitive browser APIs.</p>
<p>Package Tests provides security test implementations for HTTP response analysis. This file contains the Referrer-Policy test that checks for proper referrer information control configuration to prevent information leakage and protect user privacy.</p>
<p>Package Tests provides security testing functionality for Engine-AntiGinx.</p>
<h3 id="serverheadertest-module">ServerHeaderTest Module<a class="headerlink" href="#serverheadertest-module" title="Permanent link">&para;</a></h3>
<p>This module analyzes HTTP response headers to identify information disclosure vulnerabilities where servers expose technology stack details. Such exposure provides attackers with reconnaissance data useful for targeted attacks.</p>
<p>Security Context:</p>
<p>Information disclosure through HTTP headers violates the principle of security through obscurity and assists attackers in:</p>
<ul>
<li>Identifying specific software versions with known vulnerabilities</li>
<li>Crafting targeted exploits for detected technologies</li>
<li>Mapping the technology stack for attack surface analysis</li>
<li>Accelerating reconnaissance phases of security assessments</li>
</ul>
<p>Analyzed Headers:</p>
<ul>
<li>Server: Web server type and version (Apache, Nginx, IIS)</li>
<li>X-Powered-By: Application framework (PHP, Express, Django)</li>
<li>X-AspNet-Version: ASP.NET framework version</li>
<li>X-AspNetMvc-Version: ASP.NET MVC version</li>
<li>X-Framework: Custom framework identifiers</li>
<li>X-Generator: Content management systems (WordPress, Drupal)</li>
<li>X-Drupal-Cache: Drupal CMS indicator</li>
<li>X-Mod-Pagespeed: Google PageSpeed module</li>
<li>X-Varnish: Varnish Cache presence</li>
<li>X-Served-By: CDN or hosting service information</li>
<li>X-Cache: Caching layer details</li>
<li>X-Runtime: Application runtime information</li>
</ul>
<p>CVE Integration:</p>
<p>This test integrates with the NIST NVD (National Vulnerability Database) to:</p>
<ul>
<li>Query known vulnerabilities for detected technologies</li>
<li>Assess severity based on CVSS scores</li>
<li>Elevate threat levels when high-severity CVEs exist</li>
<li>Provide contextual vulnerability intelligence</li>
</ul>
<p>Threat Assessment Algorithm:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a>Base Level (by exposure count):
</span><span id="__span-2-2"><a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a>  0 exposures   None
</span><span id="__span-2-3"><a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a>  1-2 exposures  Info
</span><span id="__span-2-4"><a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a>  3-4 exposures  Low
</span><span id="__span-2-5"><a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a>  5+ exposures   Medium
</span><span id="__span-2-6"><a id="__codelineno-2-6" name="__codelineno-2-6" href="#__codelineno-2-6"></a>
</span><span id="__span-2-7"><a id="__codelineno-2-7" name="__codelineno-2-7" href="#__codelineno-2-7"></a>CVE Enhancement:
</span><span id="__span-2-8"><a id="__codelineno-2-8" name="__codelineno-2-8" href="#__codelineno-2-8"></a>  High severity CVE present     Critical
</span><span id="__span-2-9"><a id="__codelineno-2-9" name="__codelineno-2-9" href="#__codelineno-2-9"></a>  6+ medium severity CVEs        High
</span><span id="__span-2-10"><a id="__codelineno-2-10" name="__codelineno-2-10" href="#__codelineno-2-10"></a>  1-5 medium severity CVEs       Medium
</span><span id="__span-2-11"><a id="__codelineno-2-11" name="__codelineno-2-11" href="#__codelineno-2-11"></a>  11+ low severity CVEs          Medium
</span><span id="__span-2-12"><a id="__codelineno-2-12" name="__codelineno-2-12" href="#__codelineno-2-12"></a>  1-10 low severity CVEs         Low
</span><span id="__span-2-13"><a id="__codelineno-2-13" name="__codelineno-2-13" href="#__codelineno-2-13"></a>
</span><span id="__span-2-14"><a id="__codelineno-2-14" name="__codelineno-2-14" href="#__codelineno-2-14"></a>Heuristic Enhancement:
</span><span id="__span-2-15"><a id="__codelineno-2-15" name="__codelineno-2-15" href="#__codelineno-2-15"></a>  Debug/test/dev identifiers     Critical
</span><span id="__span-2-16"><a id="__codelineno-2-16" name="__codelineno-2-16" href="#__codelineno-2-16"></a>  Common web servers exposed     High
</span></code></pre></div>
<p>Best Practices:</p>
<p>To mitigate information disclosure:</p>
<ul>
<li>Remove or customize Server headers</li>
<li>Disable X-Powered-By and version headers</li>
<li>Use reverse proxies to normalize header output</li>
<li>Implement header security policies</li>
<li>Regular security audits of exposed headers</li>
</ul>
<p>Package Tests provides the core testing framework for security analysis of HTTP responses. This file defines fundamental types including ThreatLevel enumeration, TestResult structure, and the ResponseTest interface that all security tests must implement.</p>
<p>The framework enables:</p>
<ul>
<li>Standardized security threat classification (None to Critical)</li>
<li>Structured test results with metadata</li>
<li>Extensible test implementations</li>
<li>JSON serialization for reporting</li>
</ul>
<p>Package Tests provides security test implementations for HTTP response analysis. This file contains the X-Content-Type-Options test that checks for proper MIME type sniffing protection to prevent content-type confusion attacks.</p>
<p>Package Tests provides security test implementations for HTTP response analysis. This file contains the X-Frame-Options test that checks for proper clickjacking protection by analyzing X-Frame-Options and Content-Security-Policy frame directives.</p>
<h2 id="index">Index<a class="headerlink" href="#index" title="Permanent link">&para;</a></h2>
<ul>
<li><a href="#variables">Variables</a></li>
<li><a href="#aggregateSecurityIssues">func aggregateSecurityIssues(analysis *CookieSecurityAnalysis)</a></li>
<li><a href="#analyzeCrossOriginHeaders">func analyzeCrossOriginHeaders(coepHeader, corpHeader, coopHeader string) map[string]interface{}</a></li>
<li><a href="#analyzeDirectiveSecurity">func analyzeDirectiveSecurity(analysis *CSPAnalysis)</a></li>
<li><a href="#analyzeHSTSHeader">func analyzeHSTSHeader(hstsHeader string) map[string]interface{}</a></li>
<li><a href="#analyzeIndividualCookieSecurity">func analyzeIndividualCookieSecurity(detail *CookieSecurityDetail, cookie *http.Cookie, headers []string, index int)</a></li>
<li><a href="#analyzePermissionsPolicyHeader">func analyzePermissionsPolicyHeader(permissionsPolicyHeader string) map[string]interface{}</a></li>
<li><a href="#analyzeReferrerPolicyHeader">func analyzeReferrerPolicyHeader(referrerPolicyHeader string) map[string]interface{}</a></li>
<li><a href="#analyzeXContentTypeOptionsHeader">func analyzeXContentTypeOptionsHeader(xContentTypeHeader string) map[string]interface{}</a></li>
<li><a href="#assessEmbeddingCapability">func assessEmbeddingCapability(xframeDirective, cspFrameValue string, xframeValid bool) string</a></li>
<li><a href="#calculateCookieSecurityScore">func calculateCookieSecurityScore(analysis *CookieSecurityAnalysis)</a></li>
<li><a href="#calculateIndividualCookieScore">func calculateIndividualCookieScore(detail CookieSecurityDetail) int</a></li>
<li><a href="#calculateObfuscationScore">func calculateObfuscationScore(analysis *JSObfuscationAnalysis)</a></li>
<li><a href="#calculatePolicyStrength">func calculatePolicyStrength(analysis *CSPAnalysis)</a></li>
<li><a href="#checkMissingDirectives">func checkMissingDirectives(analysis *CSPAnalysis)</a></li>
<li><a href="#containsHash">func containsHash(values []string) bool</a></li>
<li><a href="#containsNonce">func containsNonce(values []string) bool</a></li>
<li><a href="#detectBase64Encoding">func detectBase64Encoding(analysis *JSObfuscationAnalysis, content string)</a></li>
<li><a href="#detectCharCodeObfuscation">func detectCharCodeObfuscation(analysis *JSObfuscationAnalysis, content string)</a></li>
<li><a href="#detectDynamicExecution">func detectDynamicExecution(analysis *JSObfuscationAnalysis, content string)</a></li>
<li><a href="#detectEncodedStrings">func detectEncodedStrings(analysis *JSObfuscationAnalysis, content string)</a></li>
<li><a href="#detectEscapeSequences">func detectEscapeSequences(analysis *JSObfuscationAnalysis, content string)</a></li>
<li><a href="#detectMaliciousIndicators">func detectMaliciousIndicators(analysis *JSObfuscationAnalysis, content string)</a></li>
<li><a href="#detectSuspiciousPatterns">func detectSuspiciousPatterns(analysis *JSObfuscationAnalysis, content string)</a></li>
<li><a href="#detectTechnologies">func detectTechnologies(headerName string, headerValue string) map[string]string</a></li>
<li><a href="#determineCSPProtectionLevel">func determineCSPProtectionLevel(analysis *CSPAnalysis)</a></li>
<li><a href="#determineObfuscationLevel">func determineObfuscationLevel(analysis *JSObfuscationAnalysis)</a></li>
<li><a href="#determineProtectionLevel">func determineProtectionLevel(xframeDirective, cspFrameValue string, xframeValid bool) string</a></li>
<li><a href="#evaluateDirectiveCompliance">func evaluateDirectiveCompliance(analysis *CSPAnalysis, directiveName string, values []string)</a></li>
<li><a href="#extractFrameAncestorsValue">func extractFrameAncestorsValue(cspHeader string) string</a></li>
<li><a href="#extractMaxAge">func extractMaxAge(hstsHeader string) int</a></li>
<li><a href="#extractScriptContent">func extractScriptContent(html string) []string</a></li>
<li><a href="#extractVersion">func extractVersion(headerValue, technology string) string</a></li>
<li><a href="#formatDuration">func formatDuration(d time.Duration) string</a></li>
<li><a href="#formatMaxAge">func formatMaxAge(seconds int) string</a></li>
<li><a href="#generateCSPDescription">func generateCSPDescription(analysis CSPAnalysis) string</a></li>
<li><a href="#generateCookieDescription">func generateCookieDescription(analysis CookieSecurityAnalysis) string</a></li>
<li><a href="#generateCrossOriginDescription">func generateCrossOriginDescription(metadata map[string]interface{}) string</a></li>
<li><a href="#generateDescription">func generateDescription(protectionLevel string, hasXFrame, hasCSP bool, canBeEmbedded string) string</a></li>
<li><a href="#generateHSTSDescription">func generateHSTSDescription(metadata map[string]interface{}) string</a></li>
<li><a href="#generateObfuscationDescription">func generateObfuscationDescription(analysis JSObfuscationAnalysis) string</a></li>
<li><a href="#generatePermissionsPolicyDescription">func generatePermissionsPolicyDescription(metadata map[string]interface{}) string</a></li>
<li><a href="#generateReferrerPolicyDescription">func generateReferrerPolicyDescription(metadata map[string]interface{}) string</a></li>
<li><a href="#generateServerExposureDescription">func generateServerExposureDescription(analysis *ServerHeaderAnalysis) string</a></li>
<li><a href="#generateXContentTypeOptionsDescription">func generateXContentTypeOptionsDescription(metadata map[string]interface{}) string</a></li>
<li><a href="#getSameSiteString">func getSameSiteString(sameSite http.SameSite) string</a></li>
<li><a href="#hasOnlyBroadSources">func hasOnlyBroadSources(cspLower string) bool</a></li>
<li><a href="#hasSpecificDomains">func hasSpecificDomains(cspLower string) bool</a></li>
<li><a href="#isAllowlistRestricted">func isAllowlistRestricted(allowlist string) bool</a></li>
<li><a href="#isPredictableValue">func isPredictableValue(value string) bool</a></li>
<li><a href="#isSessionCookie">func isSessionCookie(cookie *http.Cookie) bool</a></li>
<li><a href="#CSPAnalysis">type CSPAnalysis</a></li>
<li><a href="#analyzeCSPHeader">func analyzeCSPHeader(cspHeader string) CSPAnalysis</a></li>
<li><a href="#CookieSecurityAnalysis">type CookieSecurityAnalysis</a></li>
<li><a href="#analyzeCookieSecurity">func analyzeCookieSecurity(cookies []*http.Cookie, headers http.Header) CookieSecurityAnalysis</a></li>
<li><a href="#CookieSecurityDetail">type CookieSecurityDetail</a></li>
<li><a href="#analyzeSingleCookie">func analyzeSingleCookie(cookie *http.Cookie, setCookieHeaders []string, index int) CookieSecurityDetail</a></li>
<li><a href="#CrossOriginAnalysis">type CrossOriginAnalysis</a></li>
<li><a href="#JSObfuscationAnalysis">type JSObfuscationAnalysis</a></li>
<li><a href="#analyzeJSObfuscation">func analyzeJSObfuscation(content string) JSObfuscationAnalysis</a></li>
<li><a href="#ResponseTest">type ResponseTest</a></li>
<li><a href="#NewCSPTest">func NewCSPTest() *ResponseTest</a></li>
<li><a href="#NewCookieSecurityTest">func NewCookieSecurityTest() *ResponseTest</a></li>
<li><a href="#NewCrossOriginTest">func NewCrossOriginTest() *ResponseTest</a></li>
<li><a href="#NewHSTSTest">func NewHSTSTest() *ResponseTest</a></li>
<li><a href="#NewHTTPSTest">func NewHTTPSTest() *ResponseTest</a></li>
<li><a href="#NewJSObfuscationTest">func NewJSObfuscationTest() *ResponseTest</a></li>
<li><a href="#NewPermissionsPolicyTest">func NewPermissionsPolicyTest() *ResponseTest</a></li>
<li><a href="#NewReferrerPolicyTest">func NewReferrerPolicyTest() *ResponseTest</a></li>
<li><a href="#NewServerHeaderTest">func NewServerHeaderTest() *ResponseTest</a></li>
<li><a href="#NewXContentTypeOptionsTest">func NewXContentTypeOptionsTest() *ResponseTest</a></li>
<li><a href="#NewXFrameTest">func NewXFrameTest() *ResponseTest</a></li>
<li><a href="#ResponseTest.GetDescription">func (brt *ResponseTest) GetDescription() string</a></li>
<li><a href="#ResponseTest.GetId">func (brt *ResponseTest) GetId() string</a></li>
<li><a href="#ResponseTest.GetName">func (brt *ResponseTest) GetName() string</a></li>
<li><a href="#ResponseTest.Run">func (rt *ResponseTest) Run(params ResponseTestParams) TestResult</a></li>
<li><a href="#ResponseTestParams">type ResponseTestParams</a></li>
<li><a href="#ServerHeaderAnalysis">type ServerHeaderAnalysis</a></li>
<li><a href="#analyzeServerHeaders">func analyzeServerHeaders(headers map[string]string) *ServerHeaderAnalysis</a></li>
<li><a href="#TestResult">type TestResult</a></li>
<li><a href="#TestResultWrapper">type TestResultWrapper</a></li>
<li><a href="#ThreatLevel">type ThreatLevel</a></li>
<li><a href="#evaluateCSPThreatLevel">func evaluateCSPThreatLevel(analysis CSPAnalysis) ThreatLevel</a></li>
<li><a href="#evaluateCookieThreatLevel">func evaluateCookieThreatLevel(analysis CookieSecurityAnalysis) ThreatLevel</a></li>
<li><a href="#evaluateCrossOriginThreatLevel">func evaluateCrossOriginThreatLevel(metadata map[string]interface{}) ThreatLevel</a></li>
<li><a href="#evaluateHSTSThreatLevel">func evaluateHSTSThreatLevel(metadata map[string]interface{}) ThreatLevel</a></li>
<li><a href="#evaluateObfuscationThreat">func evaluateObfuscationThreat(analysis JSObfuscationAnalysis) ThreatLevel</a></li>
<li><a href="#evaluatePermissionsPolicyThreatLevel">func evaluatePermissionsPolicyThreatLevel(metadata map[string]interface{}) ThreatLevel</a></li>
<li><a href="#evaluateReferrerPolicyThreatLevel">func evaluateReferrerPolicyThreatLevel(metadata map[string]interface{}) ThreatLevel</a></li>
<li><a href="#evaluateServerExposureThreatLevel">func evaluateServerExposureThreatLevel(analysis *ServerHeaderAnalysis) ThreatLevel</a></li>
<li><a href="#evaluateXContentTypeOptionsThreatLevel">func evaluateXContentTypeOptionsThreatLevel(metadata map[string]interface{}) ThreatLevel</a></li>
<li><a href="#mapCVEThreatLevel">func mapCVEThreatLevel(assessment CVE.VulnerabilityAssessment) ThreatLevel</a></li>
<li><a href="#ThreatLevel.MarshalJSON">func (t ThreatLevel) MarshalJSON() ([]byte, error)</a></li>
<li><a href="#ThreatLevel.String">func (t ThreatLevel) String() string</a></li>
</ul>
<h2 id="variables">Variables<a class="headerlink" href="#variables" title="Permanent link">&para;</a></h2>
<p><a name="cspBroadSources"></a>cspBroadSources contains CSP sources that allow broad access and don't represent specific domain restrictions.</p>
<div class="language-go highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="kd">var</span><span class="w"> </span><span class="nx">cspBroadSources</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="kd">map</span><span class="p">[</span><span class="kt">string</span><span class="p">]</span><span class="kt">bool</span><span class="p">{</span>
</span><span id="__span-3-2"><a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a><span class="w">    </span><span class="s">&quot;https:&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
</span><span id="__span-3-3"><a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a><span class="w">    </span><span class="s">&quot;http:&quot;</span><span class="p">:</span><span class="w">  </span><span class="kc">true</span><span class="p">,</span>
</span><span id="__span-3-4"><a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a><span class="w">    </span><span class="s">&quot;*&quot;</span><span class="p">:</span><span class="w">      </span><span class="kc">true</span><span class="p">,</span>
</span><span id="__span-3-5"><a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a><span class="p">}</span>
</span></code></pre></div>
<p><a name="cspKeywords"></a>cspKeywords contains CSP keywords that are not domain restrictions.</p>
<div class="language-go highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="kd">var</span><span class="w"> </span><span class="nx">cspKeywords</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="kd">map</span><span class="p">[</span><span class="kt">string</span><span class="p">]</span><span class="kt">bool</span><span class="p">{</span>
</span><span id="__span-4-2"><a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a><span class="w">    </span><span class="s">&quot;&#39;self&#39;&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
</span><span id="__span-4-3"><a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a><span class="w">    </span><span class="s">&quot;&#39;none&#39;&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
</span><span id="__span-4-4"><a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a><span class="p">}</span>
</span></code></pre></div>
<p><a name="aggregateSecurityIssues"></a></p>
<h2 id="func-aggregatesecurityissues">func aggregateSecurityIssues<a class="headerlink" href="#func-aggregatesecurityissues" title="Permanent link">&para;</a></h2>
<div class="language-go highlight"><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="kd">func</span><span class="w"> </span><span class="nx">aggregateSecurityIssues</span><span class="p">(</span><span class="nx">analysis</span><span class="w"> </span><span class="o">*</span><span class="nx">CookieSecurityAnalysis</span><span class="p">)</span>
</span></code></pre></div>
<p>aggregateSecurityIssues creates high-level security issue summaries</p>
<p><a name="analyzeCrossOriginHeaders"></a></p>
<h2 id="func-analyzecrossoriginheaders">func analyzeCrossOriginHeaders<a class="headerlink" href="#func-analyzecrossoriginheaders" title="Permanent link">&para;</a></h2>
<div class="language-go highlight"><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="kd">func</span><span class="w"> </span><span class="nx">analyzeCrossOriginHeaders</span><span class="p">(</span><span class="nx">coepHeader</span><span class="p">,</span><span class="w"> </span><span class="nx">corpHeader</span><span class="p">,</span><span class="w"> </span><span class="nx">coopHeader</span><span class="w"> </span><span class="kt">string</span><span class="p">)</span><span class="w"> </span><span class="kd">map</span><span class="p">[</span><span class="kt">string</span><span class="p">]</span><span class="kd">interface</span><span class="p">{}</span>
</span></code></pre></div>
<p>analyzeCrossOriginHeaders parses and analyzes all three cross-origin security headers to determine the overall security posture and isolation effectiveness.</p>
<p>Parameters:</p>
<ul>
<li>coepHeader: Cross-Origin-Embedder-Policy header value</li>
<li>corpHeader: Cross-Origin-Resource-Policy header value</li>
<li>coopHeader: Cross-Origin-Opener-Policy header value</li>
</ul>
<p>Returns:</p>
<ul>
<li>map[string]interface{}: Structured metadata containing cross-origin security analysis</li>
</ul>
<p><a name="analyzeDirectiveSecurity"></a></p>
<h2 id="func-analyzedirectivesecurity">func analyzeDirectiveSecurity<a class="headerlink" href="#func-analyzedirectivesecurity" title="Permanent link">&para;</a></h2>
<div class="language-go highlight"><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a><span class="kd">func</span><span class="w"> </span><span class="nx">analyzeDirectiveSecurity</span><span class="p">(</span><span class="nx">analysis</span><span class="w"> </span><span class="o">*</span><span class="nx">CSPAnalysis</span><span class="p">)</span>
</span></code></pre></div>
<p>analyzeDirectiveSecurity checks each directive for security issues</p>
<p><a name="analyzeHSTSHeader"></a></p>
<h2 id="func-analyzehstsheader">func analyzeHSTSHeader<a class="headerlink" href="#func-analyzehstsheader" title="Permanent link">&para;</a></h2>
<div class="language-go highlight"><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a><span class="kd">func</span><span class="w"> </span><span class="nx">analyzeHSTSHeader</span><span class="p">(</span><span class="nx">hstsHeader</span><span class="w"> </span><span class="kt">string</span><span class="p">)</span><span class="w"> </span><span class="kd">map</span><span class="p">[</span><span class="kt">string</span><span class="p">]</span><span class="kd">interface</span><span class="p">{}</span>
</span></code></pre></div>
<p>analyzeHSTSHeader parses the Strict-Transport-Security header value and extracts configuration directives into a structured metadata map. This function performs case-insensitive parsing to handle various header formats.</p>
<p>Parsed directives:</p>
<ul>
<li>max-age: The time (in seconds) that the browser should remember to access the site using HTTPS</li>
<li>includeSubDomains: Whether the HSTS policy applies to all subdomains</li>
<li>preload: Whether the site is eligible for HSTS preload list inclusion</li>
</ul>
<p>The function handles various header formats including:</p>
<ul>
<li>"max-age=31536000; includeSubDomains; preload"</li>
<li>"max-age=31536000"</li>
<li>"MAX-AGE=31536000; INCLUDESUBDOMAINS" (case-insensitive)</li>
</ul>
<p>Parameters:</p>
<ul>
<li>hstsHeader: Raw Strict-Transport-Security header value from HTTP response</li>
</ul>
<p>Returns:</p>
<ul>
<li>map[string]interface{}: Structured metadata containing:</li>
<li>"include_subdomains" (bool): includeSubDomains directive present</li>
<li>"preload" (bool): preload directive present</li>
<li>"max_age" (int): max-age value in seconds (0 if missing/invalid)</li>
<li>"directives" ([]string): List of present optional directives</li>
</ul>
<p>Example:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-9-1"><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a>header := &quot;max-age=31536000; includeSubDomains; preload&quot;
</span><span id="__span-9-2"><a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a>metadata := analyzeHSTSHeader(header)
</span><span id="__span-9-3"><a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a>// Returns: {
</span><span id="__span-9-4"><a id="__codelineno-9-4" name="__codelineno-9-4" href="#__codelineno-9-4"></a>//   &quot;include_subdomains&quot;: true,
</span><span id="__span-9-5"><a id="__codelineno-9-5" name="__codelineno-9-5" href="#__codelineno-9-5"></a>//   &quot;preload&quot;: true,
</span><span id="__span-9-6"><a id="__codelineno-9-6" name="__codelineno-9-6" href="#__codelineno-9-6"></a>//   &quot;max_age&quot;: 31536000,
</span><span id="__span-9-7"><a id="__codelineno-9-7" name="__codelineno-9-7" href="#__codelineno-9-7"></a>//   &quot;directives&quot;: [&quot;includeSubDomains&quot;, &quot;preload&quot;]
</span><span id="__span-9-8"><a id="__codelineno-9-8" name="__codelineno-9-8" href="#__codelineno-9-8"></a>// }
</span></code></pre></div>
<p><a name="analyzeIndividualCookieSecurity"></a></p>
<h2 id="func-analyzeindividualcookiesecurity">func analyzeIndividualCookieSecurity<a class="headerlink" href="#func-analyzeindividualcookiesecurity" title="Permanent link">&para;</a></h2>
<div class="language-go highlight"><pre><span></span><code><span id="__span-10-1"><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a><span class="kd">func</span><span class="w"> </span><span class="nx">analyzeIndividualCookieSecurity</span><span class="p">(</span><span class="nx">detail</span><span class="w"> </span><span class="o">*</span><span class="nx">CookieSecurityDetail</span><span class="p">,</span><span class="w"> </span><span class="nx">cookie</span><span class="w"> </span><span class="o">*</span><span class="nx">http</span><span class="p">.</span><span class="nx">Cookie</span><span class="p">,</span><span class="w"> </span><span class="nx">headers</span><span class="w"> </span><span class="p">[]</span><span class="kt">string</span><span class="p">,</span><span class="w"> </span><span class="nx">index</span><span class="w"> </span><span class="kt">int</span><span class="p">)</span>
</span></code></pre></div>
<p>analyzeIndividualCookieSecurity identifies specific security issues</p>
<p><a name="analyzePermissionsPolicyHeader"></a></p>
<h2 id="func-analyzepermissionspolicyheader">func analyzePermissionsPolicyHeader<a class="headerlink" href="#func-analyzepermissionspolicyheader" title="Permanent link">&para;</a></h2>
<div class="language-go highlight"><pre><span></span><code><span id="__span-11-1"><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a><span class="kd">func</span><span class="w"> </span><span class="nx">analyzePermissionsPolicyHeader</span><span class="p">(</span><span class="nx">permissionsPolicyHeader</span><span class="w"> </span><span class="kt">string</span><span class="p">)</span><span class="w"> </span><span class="kd">map</span><span class="p">[</span><span class="kt">string</span><span class="p">]</span><span class="kd">interface</span><span class="p">{}</span>
</span></code></pre></div>
<p><a name="analyzeReferrerPolicyHeader"></a></p>
<h2 id="func-analyzereferrerpolicyheader">func analyzeReferrerPolicyHeader<a class="headerlink" href="#func-analyzereferrerpolicyheader" title="Permanent link">&para;</a></h2>
<div class="language-go highlight"><pre><span></span><code><span id="__span-12-1"><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a><span class="kd">func</span><span class="w"> </span><span class="nx">analyzeReferrerPolicyHeader</span><span class="p">(</span><span class="nx">referrerPolicyHeader</span><span class="w"> </span><span class="kt">string</span><span class="p">)</span><span class="w"> </span><span class="kd">map</span><span class="p">[</span><span class="kt">string</span><span class="p">]</span><span class="kd">interface</span><span class="p">{}</span>
</span></code></pre></div>
<p>analyzeReferrerPolicyHeader parses the Referrer-Policy header value and extracts policy directives into a structured metadata map. This function handles multiple comma-separated values and normalizes case variations.</p>
<p>Parsed information:</p>
<ul>
<li>policies: List of referrer policy directives from the header</li>
<li>effective_policy: The policy that will be applied (last valid one)</li>
<li>policy_count: Number of policies specified</li>
<li>has_unsafe: Whether unsafe policies are present</li>
</ul>
<p>The function handles various header formats including:</p>
<ul>
<li>"strict-origin-when-cross-origin"</li>
<li>"no-referrer, strict-origin-when-cross-origin" (multiple policies)</li>
<li>"SAME-ORIGIN" (case-insensitive)</li>
<li>"no-referrer , origin" (with spaces)</li>
</ul>
<p>Parameters:</p>
<ul>
<li>referrerPolicyHeader: Raw Referrer-Policy header value from HTTP response</li>
</ul>
<p>Returns:</p>
<ul>
<li>map[string]interface{}: Structured metadata containing:</li>
<li>policies: []string - List of policy directives</li>
<li>effective_policy: string - The effective policy (last valid one)</li>
<li>policy_count: int - Number of policies specified</li>
<li>has_unsafe: bool - Whether unsafe policies (unsafe-url) are present</li>
<li>invalid_policies: []string - List of unrecognized policy values</li>
</ul>
<p>Example:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-13-1"><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a>metadata1 := analyzeReferrerPolicyHeader(&quot;strict-origin-when-cross-origin&quot;)
</span><span id="__span-13-2"><a id="__codelineno-13-2" name="__codelineno-13-2" href="#__codelineno-13-2"></a>// Returns: {policies: [&quot;strict-origin-when-cross-origin&quot;], effective_policy: &quot;strict-origin-when-cross-origin&quot;, ...}
</span><span id="__span-13-3"><a id="__codelineno-13-3" name="__codelineno-13-3" href="#__codelineno-13-3"></a>
</span><span id="__span-13-4"><a id="__codelineno-13-4" name="__codelineno-13-4" href="#__codelineno-13-4"></a>metadata2 := analyzeReferrerPolicyHeader(&quot;no-referrer, unsafe-url&quot;)
</span><span id="__span-13-5"><a id="__codelineno-13-5" name="__codelineno-13-5" href="#__codelineno-13-5"></a>// Returns: {policies: [&quot;no-referrer&quot;, &quot;unsafe-url&quot;], effective_policy: &quot;unsafe-url&quot;, has_unsafe: true, ...}
</span></code></pre></div>
<p><a name="analyzeXContentTypeOptionsHeader"></a></p>
<h2 id="func-analyzexcontenttypeoptionsheader">func analyzeXContentTypeOptionsHeader<a class="headerlink" href="#func-analyzexcontenttypeoptionsheader" title="Permanent link">&para;</a></h2>
<div class="language-go highlight"><pre><span></span><code><span id="__span-14-1"><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a><span class="kd">func</span><span class="w"> </span><span class="nx">analyzeXContentTypeOptionsHeader</span><span class="p">(</span><span class="nx">xContentTypeHeader</span><span class="w"> </span><span class="kt">string</span><span class="p">)</span><span class="w"> </span><span class="kd">map</span><span class="p">[</span><span class="kt">string</span><span class="p">]</span><span class="kd">interface</span><span class="p">{}</span>
</span></code></pre></div>
<p>analyzeXContentTypeOptionsHeader parses the X-Content-Type-Options header value</p>
<p><a name="assessEmbeddingCapability"></a></p>
<h2 id="func-assessembeddingcapability">func assessEmbeddingCapability<a class="headerlink" href="#func-assessembeddingcapability" title="Permanent link">&para;</a></h2>
<div class="language-go highlight"><pre><span></span><code><span id="__span-15-1"><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a><span class="kd">func</span><span class="w"> </span><span class="nx">assessEmbeddingCapability</span><span class="p">(</span><span class="nx">xframeDirective</span><span class="p">,</span><span class="w"> </span><span class="nx">cspFrameValue</span><span class="w"> </span><span class="kt">string</span><span class="p">,</span><span class="w"> </span><span class="nx">xframeValid</span><span class="w"> </span><span class="kt">bool</span><span class="p">)</span><span class="w"> </span><span class="kt">string</span>
</span></code></pre></div>
<p>assessEmbeddingCapability determines whether the page can be embedded in an iframe based on the configured frame protection headers.</p>
<p>Parameters:</p>
<ul>
<li>xframeDirective: X-Frame-Options directive value</li>
<li>cspFrameValue: CSP frame-ancestors directive value</li>
<li>xframeValid: Whether X-Frame-Options syntax is valid</li>
</ul>
<p>Returns:</p>
<ul>
<li>string: Embedding capability (blocked, same-origin, limited, allowed)</li>
</ul>
<p><a name="calculateCookieSecurityScore"></a></p>
<h2 id="func-calculatecookiesecurityscore">func calculateCookieSecurityScore<a class="headerlink" href="#func-calculatecookiesecurityscore" title="Permanent link">&para;</a></h2>
<div class="language-go highlight"><pre><span></span><code><span id="__span-16-1"><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a><span class="kd">func</span><span class="w"> </span><span class="nx">calculateCookieSecurityScore</span><span class="p">(</span><span class="nx">analysis</span><span class="w"> </span><span class="o">*</span><span class="nx">CookieSecurityAnalysis</span><span class="p">)</span>
</span></code></pre></div>
<p>calculateCookieSecurityScore calculates overall security score (0-100)</p>
<p><a name="calculateIndividualCookieScore"></a></p>
<h2 id="func-calculateindividualcookiescore">func calculateIndividualCookieScore<a class="headerlink" href="#func-calculateindividualcookiescore" title="Permanent link">&para;</a></h2>
<div class="language-go highlight"><pre><span></span><code><span id="__span-17-1"><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a><span class="kd">func</span><span class="w"> </span><span class="nx">calculateIndividualCookieScore</span><span class="p">(</span><span class="nx">detail</span><span class="w"> </span><span class="nx">CookieSecurityDetail</span><span class="p">)</span><span class="w"> </span><span class="kt">int</span>
</span></code></pre></div>
<p>calculateIndividualCookieScore calculates security score for a single cookie</p>
<p><a name="calculateObfuscationScore"></a></p>
<h2 id="func-calculateobfuscationscore">func calculateObfuscationScore<a class="headerlink" href="#func-calculateobfuscationscore" title="Permanent link">&para;</a></h2>
<div class="language-go highlight"><pre><span></span><code><span id="__span-18-1"><a id="__codelineno-18-1" name="__codelineno-18-1" href="#__codelineno-18-1"></a><span class="kd">func</span><span class="w"> </span><span class="nx">calculateObfuscationScore</span><span class="p">(</span><span class="nx">analysis</span><span class="w"> </span><span class="o">*</span><span class="nx">JSObfuscationAnalysis</span><span class="p">)</span>
</span></code></pre></div>
<p>calculateObfuscationScore calculates overall obfuscation score (0-100)</p>
<p><a name="calculatePolicyStrength"></a></p>
<h2 id="func-calculatepolicystrength">func calculatePolicyStrength<a class="headerlink" href="#func-calculatepolicystrength" title="Permanent link">&para;</a></h2>
<div class="language-go highlight"><pre><span></span><code><span id="__span-19-1"><a id="__codelineno-19-1" name="__codelineno-19-1" href="#__codelineno-19-1"></a><span class="kd">func</span><span class="w"> </span><span class="nx">calculatePolicyStrength</span><span class="p">(</span><span class="nx">analysis</span><span class="w"> </span><span class="o">*</span><span class="nx">CSPAnalysis</span><span class="p">)</span>
</span></code></pre></div>
<p>calculatePolicyStrength calculates a numerical strength score (0-100)</p>
<p><a name="checkMissingDirectives"></a></p>
<h2 id="func-checkmissingdirectives">func checkMissingDirectives<a class="headerlink" href="#func-checkmissingdirectives" title="Permanent link">&para;</a></h2>
<div class="language-go highlight"><pre><span></span><code><span id="__span-20-1"><a id="__codelineno-20-1" name="__codelineno-20-1" href="#__codelineno-20-1"></a><span class="kd">func</span><span class="w"> </span><span class="nx">checkMissingDirectives</span><span class="p">(</span><span class="nx">analysis</span><span class="w"> </span><span class="o">*</span><span class="nx">CSPAnalysis</span><span class="p">)</span>
</span></code></pre></div>
<p>checkMissingDirectives identifies important missing CSP directives</p>
<p><a name="containsHash"></a></p>
<h2 id="func-containshash">func containsHash<a class="headerlink" href="#func-containshash" title="Permanent link">&para;</a></h2>
<div class="language-go highlight"><pre><span></span><code><span id="__span-21-1"><a id="__codelineno-21-1" name="__codelineno-21-1" href="#__codelineno-21-1"></a><span class="kd">func</span><span class="w"> </span><span class="nx">containsHash</span><span class="p">(</span><span class="nx">values</span><span class="w"> </span><span class="p">[]</span><span class="kt">string</span><span class="p">)</span><span class="w"> </span><span class="kt">bool</span>
</span></code></pre></div>
<p><a name="containsNonce"></a></p>
<h2 id="func-containsnonce">func containsNonce<a class="headerlink" href="#func-containsnonce" title="Permanent link">&para;</a></h2>
<div class="language-go highlight"><pre><span></span><code><span id="__span-22-1"><a id="__codelineno-22-1" name="__codelineno-22-1" href="#__codelineno-22-1"></a><span class="kd">func</span><span class="w"> </span><span class="nx">containsNonce</span><span class="p">(</span><span class="nx">values</span><span class="w"> </span><span class="p">[]</span><span class="kt">string</span><span class="p">)</span><span class="w"> </span><span class="kt">bool</span>
</span></code></pre></div>
<p>CSP-specific utility functions</p>
<p><a name="detectBase64Encoding"></a></p>
<h2 id="func-detectbase64encoding">func detectBase64Encoding<a class="headerlink" href="#func-detectbase64encoding" title="Permanent link">&para;</a></h2>
<div class="language-go highlight"><pre><span></span><code><span id="__span-23-1"><a id="__codelineno-23-1" name="__codelineno-23-1" href="#__codelineno-23-1"></a><span class="kd">func</span><span class="w"> </span><span class="nx">detectBase64Encoding</span><span class="p">(</span><span class="nx">analysis</span><span class="w"> </span><span class="o">*</span><span class="nx">JSObfuscationAnalysis</span><span class="p">,</span><span class="w"> </span><span class="nx">content</span><span class="w"> </span><span class="kt">string</span><span class="p">)</span>
</span></code></pre></div>
<p>detectBase64Encoding detects Base64 encoded strings</p>
<p><a name="detectCharCodeObfuscation"></a></p>
<h2 id="func-detectcharcodeobfuscation">func detectCharCodeObfuscation<a class="headerlink" href="#func-detectcharcodeobfuscation" title="Permanent link">&para;</a></h2>
<div class="language-go highlight"><pre><span></span><code><span id="__span-24-1"><a id="__codelineno-24-1" name="__codelineno-24-1" href="#__codelineno-24-1"></a><span class="kd">func</span><span class="w"> </span><span class="nx">detectCharCodeObfuscation</span><span class="p">(</span><span class="nx">analysis</span><span class="w"> </span><span class="o">*</span><span class="nx">JSObfuscationAnalysis</span><span class="p">,</span><span class="w"> </span><span class="nx">content</span><span class="w"> </span><span class="kt">string</span><span class="p">)</span>
</span></code></pre></div>
<p>detectCharCodeObfuscation detects String.fromCharCode obfuscation</p>
<p><a name="detectDynamicExecution"></a></p>
<h2 id="func-detectdynamicexecution">func detectDynamicExecution<a class="headerlink" href="#func-detectdynamicexecution" title="Permanent link">&para;</a></h2>
<div class="language-go highlight"><pre><span></span><code><span id="__span-25-1"><a id="__codelineno-25-1" name="__codelineno-25-1" href="#__codelineno-25-1"></a><span class="kd">func</span><span class="w"> </span><span class="nx">detectDynamicExecution</span><span class="p">(</span><span class="nx">analysis</span><span class="w"> </span><span class="o">*</span><span class="nx">JSObfuscationAnalysis</span><span class="p">,</span><span class="w"> </span><span class="nx">content</span><span class="w"> </span><span class="kt">string</span><span class="p">)</span>
</span></code></pre></div>
<p>detectDynamicExecution detects eval, Function, and similar dynamic code execution</p>
<p><a name="detectEncodedStrings"></a></p>
<h2 id="func-detectencodedstrings">func detectEncodedStrings<a class="headerlink" href="#func-detectencodedstrings" title="Permanent link">&para;</a></h2>
<div class="language-go highlight"><pre><span></span><code><span id="__span-26-1"><a id="__codelineno-26-1" name="__codelineno-26-1" href="#__codelineno-26-1"></a><span class="kd">func</span><span class="w"> </span><span class="nx">detectEncodedStrings</span><span class="p">(</span><span class="nx">analysis</span><span class="w"> </span><span class="o">*</span><span class="nx">JSObfuscationAnalysis</span><span class="p">,</span><span class="w"> </span><span class="nx">content</span><span class="w"> </span><span class="kt">string</span><span class="p">)</span>
</span></code></pre></div>
<p>detectEncodedStrings detects various string encoding methods</p>
<p><a name="detectEscapeSequences"></a></p>
<h2 id="func-detectescapesequences">func detectEscapeSequences<a class="headerlink" href="#func-detectescapesequences" title="Permanent link">&para;</a></h2>
<div class="language-go highlight"><pre><span></span><code><span id="__span-27-1"><a id="__codelineno-27-1" name="__codelineno-27-1" href="#__codelineno-27-1"></a><span class="kd">func</span><span class="w"> </span><span class="nx">detectEscapeSequences</span><span class="p">(</span><span class="nx">analysis</span><span class="w"> </span><span class="o">*</span><span class="nx">JSObfuscationAnalysis</span><span class="p">,</span><span class="w"> </span><span class="nx">content</span><span class="w"> </span><span class="kt">string</span><span class="p">)</span>
</span></code></pre></div>
<p>detectEscapeSequences detects hex and unicode escape sequences</p>
<p><a name="detectMaliciousIndicators"></a></p>
<h2 id="func-detectmaliciousindicators">func detectMaliciousIndicators<a class="headerlink" href="#func-detectmaliciousindicators" title="Permanent link">&para;</a></h2>
<div class="language-go highlight"><pre><span></span><code><span id="__span-28-1"><a id="__codelineno-28-1" name="__codelineno-28-1" href="#__codelineno-28-1"></a><span class="kd">func</span><span class="w"> </span><span class="nx">detectMaliciousIndicators</span><span class="p">(</span><span class="nx">analysis</span><span class="w"> </span><span class="o">*</span><span class="nx">JSObfuscationAnalysis</span><span class="p">,</span><span class="w"> </span><span class="nx">content</span><span class="w"> </span><span class="kt">string</span><span class="p">)</span>
</span></code></pre></div>
<p>detectMaliciousIndicators detects patterns strongly associated with malicious code</p>
<p><a name="detectSuspiciousPatterns"></a></p>
<h2 id="func-detectsuspiciouspatterns">func detectSuspiciousPatterns<a class="headerlink" href="#func-detectsuspiciouspatterns" title="Permanent link">&para;</a></h2>
<div class="language-go highlight"><pre><span></span><code><span id="__span-29-1"><a id="__codelineno-29-1" name="__codelineno-29-1" href="#__codelineno-29-1"></a><span class="kd">func</span><span class="w"> </span><span class="nx">detectSuspiciousPatterns</span><span class="p">(</span><span class="nx">analysis</span><span class="w"> </span><span class="o">*</span><span class="nx">JSObfuscationAnalysis</span><span class="p">,</span><span class="w"> </span><span class="nx">content</span><span class="w"> </span><span class="kt">string</span><span class="p">)</span>
</span></code></pre></div>
<p>detectSuspiciousPatterns detects patterns commonly associated with obfuscation</p>
<p><a name="detectTechnologies"></a></p>
<h2 id="func-detecttechnologies">func detectTechnologies<a class="headerlink" href="#func-detecttechnologies" title="Permanent link">&para;</a></h2>
<div class="language-go highlight"><pre><span></span><code><span id="__span-30-1"><a id="__codelineno-30-1" name="__codelineno-30-1" href="#__codelineno-30-1"></a><span class="kd">func</span><span class="w"> </span><span class="nx">detectTechnologies</span><span class="p">(</span><span class="nx">headerName</span><span class="w"> </span><span class="kt">string</span><span class="p">,</span><span class="w"> </span><span class="nx">headerValue</span><span class="w"> </span><span class="kt">string</span><span class="p">)</span><span class="w"> </span><span class="kd">map</span><span class="p">[</span><span class="kt">string</span><span class="p">]</span><span class="kt">string</span>
</span></code></pre></div>
<p>detectTechnologies identifies specific technologies and their versions from HTTP header values.</p>
<p>This function uses pattern matching and heuristics to recognize common web servers, application frameworks, content management systems, and infrastructure components based on the header name and value.</p>
<p>Detection Strategy:</p>
<p>The function employs a switch-case approach for each header type:</p>
<ul>
<li>Server: Detects web servers (Apache, Nginx, IIS, Cloudflare, etc.)</li>
<li>X-Powered-By: Identifies frameworks (Express, Django, PHP, Laravel, etc.)</li>
<li>X-AspNet-Version: Captures ASP.NET version directly</li>
<li>X-AspNetMvc-Version: Captures ASP.NET MVC version directly</li>
<li>X-Generator: Detects CMS (Drupal, WordPress)</li>
<li>Other headers: Various specialized detections</li>
</ul>
<p>Version Extraction:</p>
<p>When possible, versions are extracted using the extractVersion() function which parses patterns like "nginx/1.18.0" or "PHP/7.4.3".</p>
<p>Recognized Technologies:</p>
<p>Web Servers:</p>
<ul>
<li>Apache, Nginx, Microsoft IIS, Cloudflare, Gunicorn, Uvicorn</li>
</ul>
<p>Frameworks:</p>
<ul>
<li>Express.js, Django, ASP.NET, PHP, Laravel, Ruby on Rails, Flask, Spring Framework</li>
</ul>
<p>CMS:</p>
<ul>
<li>Drupal, WordPress</li>
</ul>
<p>Infrastructure:</p>
<ul>
<li>Google PageSpeed, Varnish Cache, Dynamic Runtime</li>
</ul>
<p>Parameters:</p>
<ul>
<li>headerName: The HTTP header name (e.g., "Server", "X-Powered-By")</li>
<li>headerValue: The actual value of the header</li>
</ul>
<p>Returns:</p>
<ul>
<li>map[string]string: Map of detected technologies to their versions</li>
<li>Keys are technology names (e.g., "Nginx", "PHP")</li>
<li>Values are versions if detected, or empty string/generic indicator</li>
</ul>
<p>Example:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-31-1"><a id="__codelineno-31-1" name="__codelineno-31-1" href="#__codelineno-31-1"></a>// Web server detection
</span><span id="__span-31-2"><a id="__codelineno-31-2" name="__codelineno-31-2" href="#__codelineno-31-2"></a>tech := detectTechnologies(&quot;Server&quot;, &quot;nginx/1.18.0 (Ubuntu)&quot;)
</span><span id="__span-31-3"><a id="__codelineno-31-3" name="__codelineno-31-3" href="#__codelineno-31-3"></a>// Returns: {&quot;Nginx&quot;: &quot;1.18.0&quot;}
</span><span id="__span-31-4"><a id="__codelineno-31-4" name="__codelineno-31-4" href="#__codelineno-31-4"></a>
</span><span id="__span-31-5"><a id="__codelineno-31-5" name="__codelineno-31-5" href="#__codelineno-31-5"></a>// Framework detection
</span><span id="__span-31-6"><a id="__codelineno-31-6" name="__codelineno-31-6" href="#__codelineno-31-6"></a>tech := detectTechnologies(&quot;X-Powered-By&quot;, &quot;PHP/7.4.3&quot;)
</span><span id="__span-31-7"><a id="__codelineno-31-7" name="__codelineno-31-7" href="#__codelineno-31-7"></a>// Returns: {&quot;PHP&quot;: &quot;7.4.3&quot;}
</span><span id="__span-31-8"><a id="__codelineno-31-8" name="__codelineno-31-8" href="#__codelineno-31-8"></a>
</span><span id="__span-31-9"><a id="__codelineno-31-9" name="__codelineno-31-9" href="#__codelineno-31-9"></a>// Multiple technologies in one header
</span><span id="__span-31-10"><a id="__codelineno-31-10" name="__codelineno-31-10" href="#__codelineno-31-10"></a>tech := detectTechnologies(&quot;Server&quot;, &quot;Apache/2.4.41 (Ubuntu) OpenSSL/1.1.1f&quot;)
</span><span id="__span-31-11"><a id="__codelineno-31-11" name="__codelineno-31-11" href="#__codelineno-31-11"></a>// Returns: {&quot;Apache&quot;: &quot;2.4.41&quot;}
</span><span id="__span-31-12"><a id="__codelineno-31-12" name="__codelineno-31-12" href="#__codelineno-31-12"></a>
</span><span id="__span-31-13"><a id="__codelineno-31-13" name="__codelineno-31-13" href="#__codelineno-31-13"></a>// Version-less detection
</span><span id="__span-31-14"><a id="__codelineno-31-14" name="__codelineno-31-14" href="#__codelineno-31-14"></a>tech := detectTechnologies(&quot;X-Powered-By&quot;, &quot;Express&quot;)
</span><span id="__span-31-15"><a id="__codelineno-31-15" name="__codelineno-31-15" href="#__codelineno-31-15"></a>// Returns: {&quot;Express.js&quot;: &quot;&quot;}
</span></code></pre></div>
<p>Note:</p>
<p>Case-insensitive matching is used to handle variations in header formatting. Not all technologies can have versions extracted; some return empty strings.</p>
<p><a name="determineCSPProtectionLevel"></a></p>
<h2 id="func-determinecspprotectionlevel">func determineCSPProtectionLevel<a class="headerlink" href="#func-determinecspprotectionlevel" title="Permanent link">&para;</a></h2>
<div class="language-go highlight"><pre><span></span><code><span id="__span-32-1"><a id="__codelineno-32-1" name="__codelineno-32-1" href="#__codelineno-32-1"></a><span class="kd">func</span><span class="w"> </span><span class="nx">determineCSPProtectionLevel</span><span class="p">(</span><span class="nx">analysis</span><span class="w"> </span><span class="o">*</span><span class="nx">CSPAnalysis</span><span class="p">)</span>
</span></code></pre></div>
<p>determineCSPProtectionLevel sets overall protection assessment</p>
<p><a name="determineObfuscationLevel"></a></p>
<h2 id="func-determineobfuscationlevel">func determineObfuscationLevel<a class="headerlink" href="#func-determineobfuscationlevel" title="Permanent link">&para;</a></h2>
<div class="language-go highlight"><pre><span></span><code><span id="__span-33-1"><a id="__codelineno-33-1" name="__codelineno-33-1" href="#__codelineno-33-1"></a><span class="kd">func</span><span class="w"> </span><span class="nx">determineObfuscationLevel</span><span class="p">(</span><span class="nx">analysis</span><span class="w"> </span><span class="o">*</span><span class="nx">JSObfuscationAnalysis</span><span class="p">)</span>
</span></code></pre></div>
<p>determineObfuscationLevel categorizes obfuscation severity</p>
<p><a name="determineProtectionLevel"></a></p>
<h2 id="func-determineprotectionlevel">func determineProtectionLevel<a class="headerlink" href="#func-determineprotectionlevel" title="Permanent link">&para;</a></h2>
<div class="language-go highlight"><pre><span></span><code><span id="__span-34-1"><a id="__codelineno-34-1" name="__codelineno-34-1" href="#__codelineno-34-1"></a><span class="kd">func</span><span class="w"> </span><span class="nx">determineProtectionLevel</span><span class="p">(</span><span class="nx">xframeDirective</span><span class="p">,</span><span class="w"> </span><span class="nx">cspFrameValue</span><span class="w"> </span><span class="kt">string</span><span class="p">,</span><span class="w"> </span><span class="nx">xframeValid</span><span class="w"> </span><span class="kt">bool</span><span class="p">)</span><span class="w"> </span><span class="kt">string</span>
</span></code></pre></div>
<p>determineProtectionLevel assesses the overall frame protection strength based on configured headers and directives.</p>
<p>Parameters:</p>
<ul>
<li>xframeDirective: X-Frame-Options directive value</li>
<li>cspFrameValue: CSP frame-ancestors directive value</li>
<li>xframeValid: Whether X-Frame-Options syntax is valid</li>
</ul>
<p>Returns:</p>
<ul>
<li>string: Protection level (excellent, good, limited, weak, vulnerable)</li>
</ul>
<p><a name="evaluateDirectiveCompliance"></a></p>
<h2 id="func-evaluatedirectivecompliance">func evaluateDirectiveCompliance<a class="headerlink" href="#func-evaluatedirectivecompliance" title="Permanent link">&para;</a></h2>
<div class="language-go highlight"><pre><span></span><code><span id="__span-35-1"><a id="__codelineno-35-1" name="__codelineno-35-1" href="#__codelineno-35-1"></a><span class="kd">func</span><span class="w"> </span><span class="nx">evaluateDirectiveCompliance</span><span class="p">(</span><span class="nx">analysis</span><span class="w"> </span><span class="o">*</span><span class="nx">CSPAnalysis</span><span class="p">,</span><span class="w"> </span><span class="nx">directiveName</span><span class="w"> </span><span class="kt">string</span><span class="p">,</span><span class="w"> </span><span class="nx">values</span><span class="w"> </span><span class="p">[]</span><span class="kt">string</span><span class="p">)</span>
</span></code></pre></div>
<p>evaluateDirectiveCompliance assesses individual directive configurations</p>
<p><a name="extractFrameAncestorsValue"></a></p>
<h2 id="func-extractframeancestorsvalue">func extractFrameAncestorsValue<a class="headerlink" href="#func-extractframeancestorsvalue" title="Permanent link">&para;</a></h2>
<div class="language-go highlight"><pre><span></span><code><span id="__span-36-1"><a id="__codelineno-36-1" name="__codelineno-36-1" href="#__codelineno-36-1"></a><span class="kd">func</span><span class="w"> </span><span class="nx">extractFrameAncestorsValue</span><span class="p">(</span><span class="nx">cspHeader</span><span class="w"> </span><span class="kt">string</span><span class="p">)</span><span class="w"> </span><span class="kt">string</span>
</span></code></pre></div>
<p>extractFrameAncestorsValue parses the Content-Security-Policy header to extract the frame-ancestors directive value.</p>
<p>Parameters:</p>
<ul>
<li>cspHeader: Complete CSP header value</li>
</ul>
<p>Returns:</p>
<ul>
<li>string: frame-ancestors directive value or empty string if not found</li>
</ul>
<p><a name="extractMaxAge"></a></p>
<h2 id="func-extractmaxage">func extractMaxAge<a class="headerlink" href="#func-extractmaxage" title="Permanent link">&para;</a></h2>
<div class="language-go highlight"><pre><span></span><code><span id="__span-37-1"><a id="__codelineno-37-1" name="__codelineno-37-1" href="#__codelineno-37-1"></a><span class="kd">func</span><span class="w"> </span><span class="nx">extractMaxAge</span><span class="p">(</span><span class="nx">hstsHeader</span><span class="w"> </span><span class="kt">string</span><span class="p">)</span><span class="w"> </span><span class="kt">int</span>
</span></code></pre></div>
<p>extractMaxAge extracts and parses the max-age directive value from the HSTS header. The max-age directive specifies the duration (in seconds) that the browser should remember to access the site exclusively over HTTPS.</p>
<p>The function performs case-insensitive parsing and handles various formats:</p>
<ul>
<li>"max-age=31536000"</li>
<li>"MAX-AGE=31536000"</li>
<li>"max-age=31536000; includeSubDomains"</li>
</ul>
<p>Parsing process:</p>
<ol>
<li>Split header by semicolon to separate directives</li>
<li>Trim whitespace from each directive</li>
<li>Look for "max-age=" prefix (case-insensitive)</li>
<li>Extract numeric value after the equals sign</li>
<li>Convert to integer</li>
</ol>
<p>Parameters:</p>
<ul>
<li>hstsHeader: Raw Strict-Transport-Security header value</li>
</ul>
<p>Returns:</p>
<ul>
<li>int: max-age value in seconds, or 0 if not found or invalid</li>
</ul>
<p>Example:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-38-1"><a id="__codelineno-38-1" name="__codelineno-38-1" href="#__codelineno-38-1"></a>age1 := extractMaxAge(&quot;max-age=31536000; includeSubDomains&quot;)  // Returns: 31536000
</span><span id="__span-38-2"><a id="__codelineno-38-2" name="__codelineno-38-2" href="#__codelineno-38-2"></a>age2 := extractMaxAge(&quot;includeSubDomains; preload&quot;)           // Returns: 0
</span><span id="__span-38-3"><a id="__codelineno-38-3" name="__codelineno-38-3" href="#__codelineno-38-3"></a>age3 := extractMaxAge(&quot;max-age=invalid&quot;)                      // Returns: 0
</span></code></pre></div>
<p><a name="extractScriptContent"></a></p>
<h2 id="func-extractscriptcontent">func extractScriptContent<a class="headerlink" href="#func-extractscriptcontent" title="Permanent link">&para;</a></h2>
<div class="language-go highlight"><pre><span></span><code><span id="__span-39-1"><a id="__codelineno-39-1" name="__codelineno-39-1" href="#__codelineno-39-1"></a><span class="kd">func</span><span class="w"> </span><span class="nx">extractScriptContent</span><span class="p">(</span><span class="nx">html</span><span class="w"> </span><span class="kt">string</span><span class="p">)</span><span class="w"> </span><span class="p">[]</span><span class="kt">string</span>
</span></code></pre></div>
<p>extractScriptContent extracts JavaScript from script tags</p>
<p><a name="extractVersion"></a></p>
<h2 id="func-extractversion">func extractVersion<a class="headerlink" href="#func-extractversion" title="Permanent link">&para;</a></h2>
<div class="language-go highlight"><pre><span></span><code><span id="__span-40-1"><a id="__codelineno-40-1" name="__codelineno-40-1" href="#__codelineno-40-1"></a><span class="kd">func</span><span class="w"> </span><span class="nx">extractVersion</span><span class="p">(</span><span class="nx">headerValue</span><span class="p">,</span><span class="w"> </span><span class="nx">technology</span><span class="w"> </span><span class="kt">string</span><span class="p">)</span><span class="w"> </span><span class="kt">string</span>
</span></code></pre></div>
<p>extractVersion attempts to extract version information from HTTP header values using pattern recognition for common version formatting conventions.</p>
<p>This function parses header values to isolate version numbers following technology names, handling various separator styles and formats commonly used in HTTP headers.</p>
<p>Supported Version Patterns:</p>
<ul>
<li>Slash separator: "nginx/1.18.0"</li>
<li>Hyphen separator: "PHP-7.4.3"</li>
<li>Direct placement: "Apache 2.4.41"</li>
<li>Version prefix: "v1.18.0" or "V1.18.0"</li>
</ul>
<p>Algorithm:</p>
<ol>
<li>Convert to lowercase for case-insensitive matching</li>
<li>Locate the technology name within the header value</li>
<li>Examine characters after the technology name</li>
<li>Identify version start (first digit or after separator)</li>
<li>Extract consecutive version characters (digits, dots, hyphens)</li>
<li>Return the isolated version string</li>
</ol>
<p>Version Character Rules:</p>
<ul>
<li>Digits (0-9): Valid version characters</li>
<li>Dots (.): Valid separators (1.18.0)</li>
<li>Hyphens (-): Valid for pre-release versions (1.0.0-beta)</li>
<li>Any other character: Terminates version extraction</li>
</ul>
<p>Parameters:</p>
<ul>
<li>headerValue: The complete HTTP header value (e.g., "nginx/1.18.0 (Ubuntu)")</li>
<li>technology: The technology name to locate (e.g., "nginx")</li>
</ul>
<p>Returns:</p>
<ul>
<li>string: Extracted version number, or empty string if not found</li>
</ul>
<p>Example:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-41-1"><a id="__codelineno-41-1" name="__codelineno-41-1" href="#__codelineno-41-1"></a>// Standard slash format
</span><span id="__span-41-2"><a id="__codelineno-41-2" name="__codelineno-41-2" href="#__codelineno-41-2"></a>version := extractVersion(&quot;nginx/1.18.0 (Ubuntu)&quot;, &quot;nginx&quot;)
</span><span id="__span-41-3"><a id="__codelineno-41-3" name="__codelineno-41-3" href="#__codelineno-41-3"></a>// Returns: &quot;1.18.0&quot;
</span><span id="__span-41-4"><a id="__codelineno-41-4" name="__codelineno-41-4" href="#__codelineno-41-4"></a>
</span><span id="__span-41-5"><a id="__codelineno-41-5" name="__codelineno-41-5" href="#__codelineno-41-5"></a>// Hyphen separator
</span><span id="__span-41-6"><a id="__codelineno-41-6" name="__codelineno-41-6" href="#__codelineno-41-6"></a>version := extractVersion(&quot;PHP-7.4.3&quot;, &quot;PHP&quot;)
</span><span id="__span-41-7"><a id="__codelineno-41-7" name="__codelineno-41-7" href="#__codelineno-41-7"></a>// Returns: &quot;7.4.3&quot;
</span><span id="__span-41-8"><a id="__codelineno-41-8" name="__codelineno-41-8" href="#__codelineno-41-8"></a>
</span><span id="__span-41-9"><a id="__codelineno-41-9" name="__codelineno-41-9" href="#__codelineno-41-9"></a>// Version prefix
</span><span id="__span-41-10"><a id="__codelineno-41-10" name="__codelineno-41-10" href="#__codelineno-41-10"></a>version := extractVersion(&quot;Apache v2.4.41&quot;, &quot;Apache&quot;)
</span><span id="__span-41-11"><a id="__codelineno-41-11" name="__codelineno-41-11" href="#__codelineno-41-11"></a>// Returns: &quot;2.4.41&quot;
</span><span id="__span-41-12"><a id="__codelineno-41-12" name="__codelineno-41-12" href="#__codelineno-41-12"></a>
</span><span id="__span-41-13"><a id="__codelineno-41-13" name="__codelineno-41-13" href="#__codelineno-41-13"></a>// Direct placement
</span><span id="__span-41-14"><a id="__codelineno-41-14" name="__codelineno-41-14" href="#__codelineno-41-14"></a>version := extractVersion(&quot;IIS 10.0&quot;, &quot;IIS&quot;)
</span><span id="__span-41-15"><a id="__codelineno-41-15" name="__codelineno-41-15" href="#__codelineno-41-15"></a>// Returns: &quot;10.0&quot;
</span><span id="__span-41-16"><a id="__codelineno-41-16" name="__codelineno-41-16" href="#__codelineno-41-16"></a>
</span><span id="__span-41-17"><a id="__codelineno-41-17" name="__codelineno-41-17" href="#__codelineno-41-17"></a>// No version found
</span><span id="__span-41-18"><a id="__codelineno-41-18" name="__codelineno-41-18" href="#__codelineno-41-18"></a>version := extractVersion(&quot;Cloudflare&quot;, &quot;Cloudflare&quot;)
</span><span id="__span-41-19"><a id="__codelineno-41-19" name="__codelineno-41-19" href="#__codelineno-41-19"></a>// Returns: &quot;&quot;
</span><span id="__span-41-20"><a id="__codelineno-41-20" name="__codelineno-41-20" href="#__codelineno-41-20"></a>
</span><span id="__span-41-21"><a id="__codelineno-41-21" name="__codelineno-41-21" href="#__codelineno-41-21"></a>// Complex header
</span><span id="__span-41-22"><a id="__codelineno-41-22" name="__codelineno-41-22" href="#__codelineno-41-22"></a>version := extractVersion(&quot;Apache/2.4.41 (Ubuntu) OpenSSL/1.1.1f&quot;, &quot;Apache&quot;)
</span><span id="__span-41-23"><a id="__codelineno-41-23" name="__codelineno-41-23" href="#__codelineno-41-23"></a>// Returns: &quot;2.4.41&quot;
</span></code></pre></div>
<p>Note:</p>
<p>This function uses case-insensitive matching for robustness. It only extracts the first version number encountered after the technology name.</p>
<p><a name="formatDuration"></a></p>
<h2 id="func-formatduration">func formatDuration<a class="headerlink" href="#func-formatduration" title="Permanent link">&para;</a></h2>
<div class="language-go highlight"><pre><span></span><code><span id="__span-42-1"><a id="__codelineno-42-1" name="__codelineno-42-1" href="#__codelineno-42-1"></a><span class="kd">func</span><span class="w"> </span><span class="nx">formatDuration</span><span class="p">(</span><span class="nx">d</span><span class="w"> </span><span class="nx">time</span><span class="p">.</span><span class="nx">Duration</span><span class="p">)</span><span class="w"> </span><span class="kt">string</span>
</span></code></pre></div>
<p>formatDuration formats a duration in human-readable format</p>
<p><a name="formatMaxAge"></a></p>
<h2 id="func-formatmaxage">func formatMaxAge<a class="headerlink" href="#func-formatmaxage" title="Permanent link">&para;</a></h2>
<div class="language-go highlight"><pre><span></span><code><span id="__span-43-1"><a id="__codelineno-43-1" name="__codelineno-43-1" href="#__codelineno-43-1"></a><span class="kd">func</span><span class="w"> </span><span class="nx">formatMaxAge</span><span class="p">(</span><span class="nx">seconds</span><span class="w"> </span><span class="kt">int</span><span class="p">)</span><span class="w"> </span><span class="kt">string</span>
</span></code></pre></div>
<p>formatMaxAge converts a max-age value in seconds to a human-readable duration string. The function automatically selects the most appropriate time unit (years, months, days, hours, or seconds) based on the magnitude of the value.</p>
<p>Conversion logic:</p>
<ul>
<li> 1 year (31,536,000 sec): Express in years</li>
<li> 1 month (2,592,000 sec): Express in months</li>
<li> 1 day (86,400 sec): Express in days</li>
<li> 1 hour (3,600 sec): Express in hours</li>
<li>\&lt; 1 hour: Express in seconds</li>
</ul>
<p>Singular/plural handling:</p>
<ul>
<li>Uses singular form for value of 1 (e.g., "1 year", "1 day")</li>
<li>Uses plural form for all other values (e.g., "2 years", "30 days")</li>
</ul>
<p>Parameters:</p>
<ul>
<li>seconds: max-age value in seconds</li>
</ul>
<p>Returns:</p>
<ul>
<li>string: Human-readable duration with appropriate unit</li>
</ul>
<p>Examples:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-44-1"><a id="__codelineno-44-1" name="__codelineno-44-1" href="#__codelineno-44-1"></a>formatMaxAge(31536000)     // Returns: &quot;1 year max-age&quot;
</span><span id="__span-44-2"><a id="__codelineno-44-2" name="__codelineno-44-2" href="#__codelineno-44-2"></a>formatMaxAge(63072000)     // Returns: &quot;2 years max-age&quot;
</span><span id="__span-44-3"><a id="__codelineno-44-3" name="__codelineno-44-3" href="#__codelineno-44-3"></a>formatMaxAge(2592000)      // Returns: &quot;1 month max-age&quot;
</span><span id="__span-44-4"><a id="__codelineno-44-4" name="__codelineno-44-4" href="#__codelineno-44-4"></a>formatMaxAge(7776000)      // Returns: &quot;3 months max-age&quot;
</span><span id="__span-44-5"><a id="__codelineno-44-5" name="__codelineno-44-5" href="#__codelineno-44-5"></a>formatMaxAge(86400)        // Returns: &quot;1 day max-age&quot;
</span><span id="__span-44-6"><a id="__codelineno-44-6" name="__codelineno-44-6" href="#__codelineno-44-6"></a>formatMaxAge(259200)       // Returns: &quot;3 days max-age&quot;
</span><span id="__span-44-7"><a id="__codelineno-44-7" name="__codelineno-44-7" href="#__codelineno-44-7"></a>formatMaxAge(3600)         // Returns: &quot;1 hour max-age&quot;
</span><span id="__span-44-8"><a id="__codelineno-44-8" name="__codelineno-44-8" href="#__codelineno-44-8"></a>formatMaxAge(7200)         // Returns: &quot;2 hours max-age&quot;
</span><span id="__span-44-9"><a id="__codelineno-44-9" name="__codelineno-44-9" href="#__codelineno-44-9"></a>formatMaxAge(300)          // Returns: &quot;300 seconds max-age&quot;
</span></code></pre></div>
<p><a name="generateCSPDescription"></a></p>
<h2 id="func-generatecspdescription">func generateCSPDescription<a class="headerlink" href="#func-generatecspdescription" title="Permanent link">&para;</a></h2>
<div class="language-go highlight"><pre><span></span><code><span id="__span-45-1"><a id="__codelineno-45-1" name="__codelineno-45-1" href="#__codelineno-45-1"></a><span class="kd">func</span><span class="w"> </span><span class="nx">generateCSPDescription</span><span class="p">(</span><span class="nx">analysis</span><span class="w"> </span><span class="nx">CSPAnalysis</span><span class="p">)</span><span class="w"> </span><span class="kt">string</span>
</span></code></pre></div>
<p>generateCSPDescription creates a detailed description of CSP findings</p>
<p><a name="generateCookieDescription"></a></p>
<h2 id="func-generatecookiedescription">func generateCookieDescription<a class="headerlink" href="#func-generatecookiedescription" title="Permanent link">&para;</a></h2>
<div class="language-go highlight"><pre><span></span><code><span id="__span-46-1"><a id="__codelineno-46-1" name="__codelineno-46-1" href="#__codelineno-46-1"></a><span class="kd">func</span><span class="w"> </span><span class="nx">generateCookieDescription</span><span class="p">(</span><span class="nx">analysis</span><span class="w"> </span><span class="nx">CookieSecurityAnalysis</span><span class="p">)</span><span class="w"> </span><span class="kt">string</span>
</span></code></pre></div>
<p>generateCookieDescription creates detailed description of findings</p>
<p><a name="generateCrossOriginDescription"></a></p>
<h2 id="func-generatecrossorigindescription">func generateCrossOriginDescription<a class="headerlink" href="#func-generatecrossorigindescription" title="Permanent link">&para;</a></h2>
<div class="language-go highlight"><pre><span></span><code><span id="__span-47-1"><a id="__codelineno-47-1" name="__codelineno-47-1" href="#__codelineno-47-1"></a><span class="kd">func</span><span class="w"> </span><span class="nx">generateCrossOriginDescription</span><span class="p">(</span><span class="nx">metadata</span><span class="w"> </span><span class="kd">map</span><span class="p">[</span><span class="kt">string</span><span class="p">]</span><span class="kd">interface</span><span class="p">{})</span><span class="w"> </span><span class="kt">string</span>
</span></code></pre></div>
<p>generateCrossOriginDescription creates a detailed description of the cross-origin security headers analysis results, including findings and recommendations.</p>
<p>Parameters:</p>
<ul>
<li>metadata: Analyzed cross-origin headers metadata</li>
</ul>
<p>Returns:</p>
<ul>
<li>string: Comprehensive description of cross-origin security status</li>
</ul>
<p><a name="generateDescription"></a></p>
<h2 id="func-generatedescription">func generateDescription<a class="headerlink" href="#func-generatedescription" title="Permanent link">&para;</a></h2>
<div class="language-go highlight"><pre><span></span><code><span id="__span-48-1"><a id="__codelineno-48-1" name="__codelineno-48-1" href="#__codelineno-48-1"></a><span class="kd">func</span><span class="w"> </span><span class="nx">generateDescription</span><span class="p">(</span><span class="nx">protectionLevel</span><span class="w"> </span><span class="kt">string</span><span class="p">,</span><span class="w"> </span><span class="nx">hasXFrame</span><span class="p">,</span><span class="w"> </span><span class="nx">hasCSP</span><span class="w"> </span><span class="kt">bool</span><span class="p">,</span><span class="w"> </span><span class="nx">canBeEmbedded</span><span class="w"> </span><span class="kt">string</span><span class="p">)</span><span class="w"> </span><span class="kt">string</span>
</span></code></pre></div>
<p>generateDescription creates a description based on protection analysis</p>
<p><a name="generateHSTSDescription"></a></p>
<h2 id="func-generatehstsdescription">func generateHSTSDescription<a class="headerlink" href="#func-generatehstsdescription" title="Permanent link">&para;</a></h2>
<div class="language-go highlight"><pre><span></span><code><span id="__span-49-1"><a id="__codelineno-49-1" name="__codelineno-49-1" href="#__codelineno-49-1"></a><span class="kd">func</span><span class="w"> </span><span class="nx">generateHSTSDescription</span><span class="p">(</span><span class="nx">metadata</span><span class="w"> </span><span class="kd">map</span><span class="p">[</span><span class="kt">string</span><span class="p">]</span><span class="kd">interface</span><span class="p">{})</span><span class="w"> </span><span class="kt">string</span>
</span></code></pre></div>
<p>generateHSTSDescription creates a human-readable description of the HSTS configuration analysis including the configuration details and security assessment. The description provides actionable information about the HSTS implementation quality.</p>
<p>Description components:</p>
<ul>
<li>Human-readable max-age duration (e.g., "1 year", "6 months", "30 days")</li>
<li>List of present directives (includeSubDomains, preload)</li>
<li>Security assessment (Excellent, Good, Acceptable, or Weak)</li>
<li>Recommendations for improvement when applicable</li>
</ul>
<p>Special cases handled:</p>
<ul>
<li>max-age = 0 or missing: "HSTS header present but missing or invalid max-age directive"</li>
<li>Weak configuration: Includes suggestion to increase max-age</li>
</ul>
<p>Parameters:</p>
<ul>
<li>metadata: Parsed HSTS header metadata containing max_age, directives, and flags</li>
</ul>
<p>Returns:</p>
<ul>
<li>string: Formatted description for the TestResult</li>
</ul>
<p>Example outputs:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-50-1"><a id="__codelineno-50-1" name="__codelineno-50-1" href="#__codelineno-50-1"></a>// Excellent configuration
</span><span id="__span-50-2"><a id="__codelineno-50-2" name="__codelineno-50-2" href="#__codelineno-50-2"></a>&quot;HSTS header configured with 1 year max-age and includes: includeSubDomains, preload - Excellent security configuration&quot;
</span><span id="__span-50-3"><a id="__codelineno-50-3" name="__codelineno-50-3" href="#__codelineno-50-3"></a>
</span><span id="__span-50-4"><a id="__codelineno-50-4" name="__codelineno-50-4" href="#__codelineno-50-4"></a>// Good configuration
</span><span id="__span-50-5"><a id="__codelineno-50-5" name="__codelineno-50-5" href="#__codelineno-50-5"></a>&quot;HSTS header configured with 2 years max-age and includes: includeSubDomains - Good security configuration&quot;
</span><span id="__span-50-6"><a id="__codelineno-50-6" name="__codelineno-50-6" href="#__codelineno-50-6"></a>
</span><span id="__span-50-7"><a id="__codelineno-50-7" name="__codelineno-50-7" href="#__codelineno-50-7"></a>// Weak configuration
</span><span id="__span-50-8"><a id="__codelineno-50-8" name="__codelineno-50-8" href="#__codelineno-50-8"></a>&quot;HSTS header configured with 30 days max-age - Weak security configuration, consider increasing max-age&quot;
</span><span id="__span-50-9"><a id="__codelineno-50-9" name="__codelineno-50-9" href="#__codelineno-50-9"></a>
</span><span id="__span-50-10"><a id="__codelineno-50-10" name="__codelineno-50-10" href="#__codelineno-50-10"></a>// Missing max-age
</span><span id="__span-50-11"><a id="__codelineno-50-11" name="__codelineno-50-11" href="#__codelineno-50-11"></a>&quot;HSTS header present but missing or invalid max-age directive&quot;
</span></code></pre></div>
<p><a name="generateObfuscationDescription"></a></p>
<h2 id="func-generateobfuscationdescription">func generateObfuscationDescription<a class="headerlink" href="#func-generateobfuscationdescription" title="Permanent link">&para;</a></h2>
<div class="language-go highlight"><pre><span></span><code><span id="__span-51-1"><a id="__codelineno-51-1" name="__codelineno-51-1" href="#__codelineno-51-1"></a><span class="kd">func</span><span class="w"> </span><span class="nx">generateObfuscationDescription</span><span class="p">(</span><span class="nx">analysis</span><span class="w"> </span><span class="nx">JSObfuscationAnalysis</span><span class="p">)</span><span class="w"> </span><span class="kt">string</span>
</span></code></pre></div>
<p>generateObfuscationDescription creates detailed description</p>
<p><a name="generatePermissionsPolicyDescription"></a></p>
<h2 id="func-generatepermissionspolicydescription">func generatePermissionsPolicyDescription<a class="headerlink" href="#func-generatepermissionspolicydescription" title="Permanent link">&para;</a></h2>
<div class="language-go highlight"><pre><span></span><code><span id="__span-52-1"><a id="__codelineno-52-1" name="__codelineno-52-1" href="#__codelineno-52-1"></a><span class="kd">func</span><span class="w"> </span><span class="nx">generatePermissionsPolicyDescription</span><span class="p">(</span><span class="nx">metadata</span><span class="w"> </span><span class="kd">map</span><span class="p">[</span><span class="kt">string</span><span class="p">]</span><span class="kd">interface</span><span class="p">{})</span><span class="w"> </span><span class="kt">string</span>
</span></code></pre></div>
<p>generatePermissionsPolicyDescription creates a human-readable description of the Permissions-Policy analysis results.</p>
<p><a name="generateReferrerPolicyDescription"></a></p>
<h2 id="func-generatereferrerpolicydescription">func generateReferrerPolicyDescription<a class="headerlink" href="#func-generatereferrerpolicydescription" title="Permanent link">&para;</a></h2>
<div class="language-go highlight"><pre><span></span><code><span id="__span-53-1"><a id="__codelineno-53-1" name="__codelineno-53-1" href="#__codelineno-53-1"></a><span class="kd">func</span><span class="w"> </span><span class="nx">generateReferrerPolicyDescription</span><span class="p">(</span><span class="nx">metadata</span><span class="w"> </span><span class="kd">map</span><span class="p">[</span><span class="kt">string</span><span class="p">]</span><span class="kd">interface</span><span class="p">{})</span><span class="w"> </span><span class="kt">string</span>
</span></code></pre></div>
<p>generateReferrerPolicyDescription creates a human-readable description of the Referrer-Policy analysis results, including findings, risks, and recommendations.</p>
<p>The description covers:</p>
<ul>
<li>Current policy configuration assessment</li>
<li>Privacy and security implications</li>
<li>Information leakage risks</li>
<li>Specific recommendations for improvement</li>
<li>Policy conflicts or configuration warnings</li>
</ul>
<p>Parameters:</p>
<ul>
<li>metadata: Parsed referrer policy metadata from analyzeReferrerPolicyHeader</li>
</ul>
<p>Returns:</p>
<ul>
<li>string: Detailed human-readable description of findings and recommendations</li>
</ul>
<p>Example output:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-54-1"><a id="__codelineno-54-1" name="__codelineno-54-1" href="#__codelineno-54-1"></a>&quot;Referrer-Policy configured with &#39;strict-origin-when-cross-origin&#39; - excellent privacy
</span><span id="__span-54-2"><a id="__codelineno-54-2" name="__codelineno-54-2" href="#__codelineno-54-2"></a> protection that balances security with functionality. This W3C recommended policy sends
</span><span id="__span-54-3"><a id="__codelineno-54-3" name="__codelineno-54-3" href="#__codelineno-54-3"></a> full URL for same-origin requests and only origin for cross-origin requests...&quot;
</span></code></pre></div>
<p><a name="generateServerExposureDescription"></a></p>
<h2 id="func-generateserverexposuredescription">func generateServerExposureDescription<a class="headerlink" href="#func-generateserverexposuredescription" title="Permanent link">&para;</a></h2>
<div class="language-go highlight"><pre><span></span><code><span id="__span-55-1"><a id="__codelineno-55-1" name="__codelineno-55-1" href="#__codelineno-55-1"></a><span class="kd">func</span><span class="w"> </span><span class="nx">generateServerExposureDescription</span><span class="p">(</span><span class="nx">analysis</span><span class="w"> </span><span class="o">*</span><span class="nx">ServerHeaderAnalysis</span><span class="p">)</span><span class="w"> </span><span class="kt">string</span>
</span></code></pre></div>
<p>generateServerExposureDescription creates a human-readable description of server header information disclosure findings.</p>
<p>This function synthesizes the analysis results into clear, concise descriptions suitable for security reports, console output, and API responses. It provides context about the exposure scope and identified technologies.</p>
<p>Description Format:</p>
<p>No Exposure:</p>
<ul>
<li>"No server technology information disclosed in headers - good security practice"</li>
</ul>
<p>With Exposure:</p>
<ul>
<li>Pattern: "{count} header(s) expose server information. Detected technologies: {tech_list}"</li>
<li>Single: "1 header exposes server information. Detected technologies: Nginx"</li>
<li>Multiple: "5 headers expose server information. Detected technologies: Apache, PHP, OpenSSL"</li>
</ul>
<p>Description Components:</p>
<ol>
<li>Exposure Count: Quantifies how many headers reveal information</li>
<li>Technology List: Comma-separated list of detected technologies</li>
<li>Grammar: Proper singular/plural handling ("header" vs "headers")</li>
</ol>
<p>Parameters:</p>
<ul>
<li>analysis: ServerHeaderAnalysis containing exposure and technology data</li>
</ul>
<p>Returns:</p>
<ul>
<li>string: Human-readable description of findings</li>
</ul>
<p>Example:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-56-1"><a id="__codelineno-56-1" name="__codelineno-56-1" href="#__codelineno-56-1"></a>// No exposure scenario
</span><span id="__span-56-2"><a id="__codelineno-56-2" name="__codelineno-56-2" href="#__codelineno-56-2"></a>analysis := &amp;ServerHeaderAnalysis{
</span><span id="__span-56-3"><a id="__codelineno-56-3" name="__codelineno-56-3" href="#__codelineno-56-3"></a>    total_exposures: 0,
</span><span id="__span-56-4"><a id="__codelineno-56-4" name="__codelineno-56-4" href="#__codelineno-56-4"></a>    technologies: []string{},
</span><span id="__span-56-5"><a id="__codelineno-56-5" name="__codelineno-56-5" href="#__codelineno-56-5"></a>}
</span><span id="__span-56-6"><a id="__codelineno-56-6" name="__codelineno-56-6" href="#__codelineno-56-6"></a>desc := generateServerExposureDescription(analysis)
</span><span id="__span-56-7"><a id="__codelineno-56-7" name="__codelineno-56-7" href="#__codelineno-56-7"></a>// Returns: &quot;No server technology information disclosed in headers - good security practice&quot;
</span><span id="__span-56-8"><a id="__codelineno-56-8" name="__codelineno-56-8" href="#__codelineno-56-8"></a>
</span><span id="__span-56-9"><a id="__codelineno-56-9" name="__codelineno-56-9" href="#__codelineno-56-9"></a>// Single exposure
</span><span id="__span-56-10"><a id="__codelineno-56-10" name="__codelineno-56-10" href="#__codelineno-56-10"></a>analysis := &amp;ServerHeaderAnalysis{
</span><span id="__span-56-11"><a id="__codelineno-56-11" name="__codelineno-56-11" href="#__codelineno-56-11"></a>    total_exposures: 1,
</span><span id="__span-56-12"><a id="__codelineno-56-12" name="__codelineno-56-12" href="#__codelineno-56-12"></a>    technologies: []string{&quot;Cloudflare&quot;},
</span><span id="__span-56-13"><a id="__codelineno-56-13" name="__codelineno-56-13" href="#__codelineno-56-13"></a>}
</span><span id="__span-56-14"><a id="__codelineno-56-14" name="__codelineno-56-14" href="#__codelineno-56-14"></a>desc := generateServerExposureDescription(analysis)
</span><span id="__span-56-15"><a id="__codelineno-56-15" name="__codelineno-56-15" href="#__codelineno-56-15"></a>// Returns: &quot;1 header exposes server information. Detected technologies: Cloudflare&quot;
</span><span id="__span-56-16"><a id="__codelineno-56-16" name="__codelineno-56-16" href="#__codelineno-56-16"></a>
</span><span id="__span-56-17"><a id="__codelineno-56-17" name="__codelineno-56-17" href="#__codelineno-56-17"></a>// Multiple exposures
</span><span id="__span-56-18"><a id="__codelineno-56-18" name="__codelineno-56-18" href="#__codelineno-56-18"></a>analysis := &amp;ServerHeaderAnalysis{
</span><span id="__span-56-19"><a id="__codelineno-56-19" name="__codelineno-56-19" href="#__codelineno-56-19"></a>    total_exposures: 3,
</span><span id="__span-56-20"><a id="__codelineno-56-20" name="__codelineno-56-20" href="#__codelineno-56-20"></a>    technologies: []string{&quot;Apache&quot;, &quot;PHP&quot;, &quot;OpenSSL&quot;},
</span><span id="__span-56-21"><a id="__codelineno-56-21" name="__codelineno-56-21" href="#__codelineno-56-21"></a>}
</span><span id="__span-56-22"><a id="__codelineno-56-22" name="__codelineno-56-22" href="#__codelineno-56-22"></a>desc := generateServerExposureDescription(analysis)
</span><span id="__span-56-23"><a id="__codelineno-56-23" name="__codelineno-56-23" href="#__codelineno-56-23"></a>// Returns: &quot;3 headers expose server information. Detected technologies: Apache, PHP, OpenSSL&quot;
</span></code></pre></div>
<p>Usage Context:</p>
<p>These descriptions appear in:</p>
<ul>
<li>TestResult.Description field for test results</li>
<li>CLI reporter output for console display</li>
<li>Backend reporter API payloads</li>
<li>Security audit reports</li>
<li>Log files and monitoring systems</li>
</ul>
<p>Note:</p>
<p>The description provides high-level summary information. Detailed header values and version information are available in the ServerHeaderAnalysis metadata structure.</p>
<p><a name="generateXContentTypeOptionsDescription"></a></p>
<h2 id="func-generatexcontenttypeoptionsdescription">func generateXContentTypeOptionsDescription<a class="headerlink" href="#func-generatexcontenttypeoptionsdescription" title="Permanent link">&para;</a></h2>
<div class="language-go highlight"><pre><span></span><code><span id="__span-57-1"><a id="__codelineno-57-1" name="__codelineno-57-1" href="#__codelineno-57-1"></a><span class="kd">func</span><span class="w"> </span><span class="nx">generateXContentTypeOptionsDescription</span><span class="p">(</span><span class="nx">metadata</span><span class="w"> </span><span class="kd">map</span><span class="p">[</span><span class="kt">string</span><span class="p">]</span><span class="kd">interface</span><span class="p">{})</span><span class="w"> </span><span class="kt">string</span>
</span></code></pre></div>
<p>generateXContentTypeOptionsDescription creates a human-readable description</p>
<p><a name="getSameSiteString"></a></p>
<h2 id="func-getsamesitestring">func getSameSiteString<a class="headerlink" href="#func-getsamesitestring" title="Permanent link">&para;</a></h2>
<div class="language-go highlight"><pre><span></span><code><span id="__span-58-1"><a id="__codelineno-58-1" name="__codelineno-58-1" href="#__codelineno-58-1"></a><span class="kd">func</span><span class="w"> </span><span class="nx">getSameSiteString</span><span class="p">(</span><span class="nx">sameSite</span><span class="w"> </span><span class="nx">http</span><span class="p">.</span><span class="nx">SameSite</span><span class="p">)</span><span class="w"> </span><span class="kt">string</span>
</span></code></pre></div>
<p>getSameSiteString converts SameSite enum to string</p>
<p><a name="hasOnlyBroadSources"></a></p>
<h2 id="func-hasonlybroadsources">func hasOnlyBroadSources<a class="headerlink" href="#func-hasonlybroadsources" title="Permanent link">&para;</a></h2>
<div class="language-go highlight"><pre><span></span><code><span id="__span-59-1"><a id="__codelineno-59-1" name="__codelineno-59-1" href="#__codelineno-59-1"></a><span class="kd">func</span><span class="w"> </span><span class="nx">hasOnlyBroadSources</span><span class="p">(</span><span class="nx">cspLower</span><span class="w"> </span><span class="kt">string</span><span class="p">)</span><span class="w"> </span><span class="kt">bool</span>
</span></code></pre></div>
<p>hasOnlyBroadSources checks if the CSP frame-ancestors value contains only broad scheme sources (https:, http:, *) without specific domains. Values like "https:" alone allow all HTTPS sources, providing minimal real protection.</p>
<p>Parameters:</p>
<ul>
<li>cspLower: Lowercase CSP frame-ancestors value</li>
</ul>
<p>Returns:</p>
<ul>
<li>bool: true if value only contains broad sources without specific domains</li>
</ul>
<p><a name="hasSpecificDomains"></a></p>
<h2 id="func-hasspecificdomains">func hasSpecificDomains<a class="headerlink" href="#func-hasspecificdomains" title="Permanent link">&para;</a></h2>
<div class="language-go highlight"><pre><span></span><code><span id="__span-60-1"><a id="__codelineno-60-1" name="__codelineno-60-1" href="#__codelineno-60-1"></a><span class="kd">func</span><span class="w"> </span><span class="nx">hasSpecificDomains</span><span class="p">(</span><span class="nx">cspLower</span><span class="w"> </span><span class="kt">string</span><span class="p">)</span><span class="w"> </span><span class="kt">bool</span>
</span></code></pre></div>
<p>hasSpecificDomains checks if the CSP frame-ancestors value contains specific domain restrictions (not just scheme sources, wildcards, or CSP keywords).</p>
<p>Parameters:</p>
<ul>
<li>cspLower: Lowercase CSP frame-ancestors value</li>
</ul>
<p>Returns:</p>
<ul>
<li>bool: true if value contains at least one specific domain</li>
</ul>
<p><a name="isAllowlistRestricted"></a></p>
<h2 id="func-isallowlistrestricted">func isAllowlistRestricted<a class="headerlink" href="#func-isallowlistrestricted" title="Permanent link">&para;</a></h2>
<div class="language-go highlight"><pre><span></span><code><span id="__span-61-1"><a id="__codelineno-61-1" name="__codelineno-61-1" href="#__codelineno-61-1"></a><span class="kd">func</span><span class="w"> </span><span class="nx">isAllowlistRestricted</span><span class="p">(</span><span class="nx">allowlist</span><span class="w"> </span><span class="kt">string</span><span class="p">)</span><span class="w"> </span><span class="kt">bool</span>
</span></code></pre></div>
<p>isAllowlistRestricted determines if an allowlist value represents a restricted/safe configuration. According to the Permissions-Policy specification:</p>
<ul>
<li>"()" means disabled for all origins (restricted)</li>
<li>"(self)" means allowed only for same-origin (restricted/safe)</li>
<li>"" empty value means disabled (restricted)</li>
<li>`(self "https://example.com" "https://other.com")` means allowed for self and specific origins (potentially dangerous), where additional origins must be quoted strings with full URLs</li>
</ul>
<p><a name="isPredictableValue"></a></p>
<h2 id="func-ispredictablevalue">func isPredictableValue<a class="headerlink" href="#func-ispredictablevalue" title="Permanent link">&para;</a></h2>
<div class="language-go highlight"><pre><span></span><code><span id="__span-62-1"><a id="__codelineno-62-1" name="__codelineno-62-1" href="#__codelineno-62-1"></a><span class="kd">func</span><span class="w"> </span><span class="nx">isPredictableValue</span><span class="p">(</span><span class="nx">value</span><span class="w"> </span><span class="kt">string</span><span class="p">)</span><span class="w"> </span><span class="kt">bool</span>
</span></code></pre></div>
<p>isPredictableValue checks if cookie value appears predictable</p>
<p><a name="isSessionCookie"></a></p>
<h2 id="func-issessioncookie">func isSessionCookie<a class="headerlink" href="#func-issessioncookie" title="Permanent link">&para;</a></h2>
<div class="language-go highlight"><pre><span></span><code><span id="__span-63-1"><a id="__codelineno-63-1" name="__codelineno-63-1" href="#__codelineno-63-1"></a><span class="kd">func</span><span class="w"> </span><span class="nx">isSessionCookie</span><span class="p">(</span><span class="nx">cookie</span><span class="w"> </span><span class="o">*</span><span class="nx">http</span><span class="p">.</span><span class="nx">Cookie</span><span class="p">)</span><span class="w"> </span><span class="kt">bool</span>
</span></code></pre></div>
<p>isSessionCookie determines if a cookie is likely a session cookie</p>
<p><a name="CSPAnalysis"></a></p>
<h2 id="type-cspanalysis">type CSPAnalysis<a class="headerlink" href="#type-cspanalysis" title="Permanent link">&para;</a></h2>
<p>CSPAnalysis represents the parsed and analyzed CSP configuration</p>
<div class="language-go highlight"><pre><span></span><code><span id="__span-64-1"><a id="__codelineno-64-1" name="__codelineno-64-1" href="#__codelineno-64-1"></a><span class="kd">type</span><span class="w"> </span><span class="nx">CSPAnalysis</span><span class="w"> </span><span class="kd">struct</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-64-2"><a id="__codelineno-64-2" name="__codelineno-64-2" href="#__codelineno-64-2"></a><span class="w">    </span><span class="nx">HasCSP</span><span class="w">              </span><span class="kt">bool</span><span class="w">                </span><span class="s">`json:&quot;hasCSP&quot;`</span>
</span><span id="__span-64-3"><a id="__codelineno-64-3" name="__codelineno-64-3" href="#__codelineno-64-3"></a><span class="w">    </span><span class="nx">Directives</span><span class="w">          </span><span class="kd">map</span><span class="p">[</span><span class="kt">string</span><span class="p">][]</span><span class="kt">string</span><span class="w"> </span><span class="s">`json:&quot;directives&quot;`</span>
</span><span id="__span-64-4"><a id="__codelineno-64-4" name="__codelineno-64-4" href="#__codelineno-64-4"></a><span class="w">    </span><span class="nx">SecurityIssues</span><span class="w">      </span><span class="p">[]</span><span class="kt">string</span><span class="w">            </span><span class="s">`json:&quot;securityIssues&quot;`</span>
</span><span id="__span-64-5"><a id="__codelineno-64-5" name="__codelineno-64-5" href="#__codelineno-64-5"></a><span class="w">    </span><span class="nx">MissingDirectives</span><span class="w">   </span><span class="p">[]</span><span class="kt">string</span><span class="w">            </span><span class="s">`json:&quot;missingDirectives&quot;`</span>
</span><span id="__span-64-6"><a id="__codelineno-64-6" name="__codelineno-64-6" href="#__codelineno-64-6"></a><span class="w">    </span><span class="nx">UnsafeDirectives</span><span class="w">    </span><span class="p">[]</span><span class="kt">string</span><span class="w">            </span><span class="s">`json:&quot;unsafeDirectives&quot;`</span>
</span><span id="__span-64-7"><a id="__codelineno-64-7" name="__codelineno-64-7" href="#__codelineno-64-7"></a><span class="w">    </span><span class="nx">ProtectionLevel</span><span class="w">     </span><span class="kt">string</span><span class="w">              </span><span class="s">`json:&quot;protectionLevel&quot;`</span>
</span><span id="__span-64-8"><a id="__codelineno-64-8" name="__codelineno-64-8" href="#__codelineno-64-8"></a><span class="w">    </span><span class="nx">RecommendedActions</span><span class="w">  </span><span class="p">[]</span><span class="kt">string</span><span class="w">            </span><span class="s">`json:&quot;recommendedActions&quot;`</span>
</span><span id="__span-64-9"><a id="__codelineno-64-9" name="__codelineno-64-9" href="#__codelineno-64-9"></a><span class="w">    </span><span class="nx">DirectiveCompliance</span><span class="w"> </span><span class="kd">map</span><span class="p">[</span><span class="kt">string</span><span class="p">]</span><span class="kt">string</span><span class="w">   </span><span class="s">`json:&quot;directiveCompliance&quot;`</span>
</span><span id="__span-64-10"><a id="__codelineno-64-10" name="__codelineno-64-10" href="#__codelineno-64-10"></a><span class="w">    </span><span class="nx">PolicyStrength</span><span class="w">      </span><span class="kt">int</span><span class="w">                 </span><span class="s">`json:&quot;policyStrength&quot;`</span><span class="w"> </span><span class="c1">// 0-100 score</span>
</span><span id="__span-64-11"><a id="__codelineno-64-11" name="__codelineno-64-11" href="#__codelineno-64-11"></a><span class="w">    </span><span class="nx">CriticalVulns</span><span class="w">       </span><span class="p">[]</span><span class="kt">string</span><span class="w">            </span><span class="s">`json:&quot;criticalVulns&quot;`</span>
</span><span id="__span-64-12"><a id="__codelineno-64-12" name="__codelineno-64-12" href="#__codelineno-64-12"></a><span class="p">}</span>
</span></code></pre></div>
<p><a name="analyzeCSPHeader"></a></p>
<h3 id="func-analyzecspheader">func analyzeCSPHeader<a class="headerlink" href="#func-analyzecspheader" title="Permanent link">&para;</a></h3>
<div class="language-go highlight"><pre><span></span><code><span id="__span-65-1"><a id="__codelineno-65-1" name="__codelineno-65-1" href="#__codelineno-65-1"></a><span class="kd">func</span><span class="w"> </span><span class="nx">analyzeCSPHeader</span><span class="p">(</span><span class="nx">cspHeader</span><span class="w"> </span><span class="kt">string</span><span class="p">)</span><span class="w"> </span><span class="nx">CSPAnalysis</span>
</span></code></pre></div>
<p>analyzeCSPHeader performs comprehensive analysis of the CSP header configuration</p>
<p><a name="CookieSecurityAnalysis"></a></p>
<h2 id="type-cookiesecurityanalysis">type CookieSecurityAnalysis<a class="headerlink" href="#type-cookiesecurityanalysis" title="Permanent link">&para;</a></h2>
<p>CookieSecurityAnalysis represents the comprehensive cookie security assessment</p>
<div class="language-go highlight"><pre><span></span><code><span id="__span-66-1"><a id="__codelineno-66-1" name="__codelineno-66-1" href="#__codelineno-66-1"></a><span class="kd">type</span><span class="w"> </span><span class="nx">CookieSecurityAnalysis</span><span class="w"> </span><span class="kd">struct</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-66-2"><a id="__codelineno-66-2" name="__codelineno-66-2" href="#__codelineno-66-2"></a><span class="w">    </span><span class="nx">TotalCookies</span><span class="w">         </span><span class="kt">int</span><span class="w">                    </span><span class="s">`json:&quot;totalCookies&quot;`</span>
</span><span id="__span-66-3"><a id="__codelineno-66-3" name="__codelineno-66-3" href="#__codelineno-66-3"></a><span class="w">    </span><span class="nx">CookieDetails</span><span class="w">        </span><span class="p">[]</span><span class="nx">CookieSecurityDetail</span><span class="w"> </span><span class="s">`json:&quot;cookieDetails&quot;`</span>
</span><span id="__span-66-4"><a id="__codelineno-66-4" name="__codelineno-66-4" href="#__codelineno-66-4"></a><span class="w">    </span><span class="nx">SecurityIssues</span><span class="w">       </span><span class="p">[]</span><span class="kt">string</span><span class="w">               </span><span class="s">`json:&quot;securityIssues&quot;`</span>
</span><span id="__span-66-5"><a id="__codelineno-66-5" name="__codelineno-66-5" href="#__codelineno-66-5"></a><span class="w">    </span><span class="nx">CriticalIssues</span><span class="w">       </span><span class="p">[]</span><span class="kt">string</span><span class="w">               </span><span class="s">`json:&quot;criticalIssues&quot;`</span>
</span><span id="__span-66-6"><a id="__codelineno-66-6" name="__codelineno-66-6" href="#__codelineno-66-6"></a><span class="w">    </span><span class="nx">MissingHttpOnly</span><span class="w">      </span><span class="kt">int</span><span class="w">                    </span><span class="s">`json:&quot;missingHttpOnly&quot;`</span>
</span><span id="__span-66-7"><a id="__codelineno-66-7" name="__codelineno-66-7" href="#__codelineno-66-7"></a><span class="w">    </span><span class="nx">MissingSecure</span><span class="w">        </span><span class="kt">int</span><span class="w">                    </span><span class="s">`json:&quot;missingSecure&quot;`</span>
</span><span id="__span-66-8"><a id="__codelineno-66-8" name="__codelineno-66-8" href="#__codelineno-66-8"></a><span class="w">    </span><span class="nx">MissingSameSite</span><span class="w">      </span><span class="kt">int</span><span class="w">                    </span><span class="s">`json:&quot;missingSameSite&quot;`</span>
</span><span id="__span-66-9"><a id="__codelineno-66-9" name="__codelineno-66-9" href="#__codelineno-66-9"></a><span class="w">    </span><span class="nx">LongExpiration</span><span class="w">       </span><span class="kt">int</span><span class="w">                    </span><span class="s">`json:&quot;longExpiration&quot;`</span>
</span><span id="__span-66-10"><a id="__codelineno-66-10" name="__codelineno-66-10" href="#__codelineno-66-10"></a><span class="w">    </span><span class="nx">SessionCookies</span><span class="w">       </span><span class="kt">int</span><span class="w">                    </span><span class="s">`json:&quot;sessionCookies&quot;`</span>
</span><span id="__span-66-11"><a id="__codelineno-66-11" name="__codelineno-66-11" href="#__codelineno-66-11"></a><span class="w">    </span><span class="nx">InsecureSession</span><span class="w">      </span><span class="kt">bool</span><span class="w">                   </span><span class="s">`json:&quot;insecureSession&quot;`</span>
</span><span id="__span-66-12"><a id="__codelineno-66-12" name="__codelineno-66-12" href="#__codelineno-66-12"></a><span class="w">    </span><span class="nx">FixationRisk</span><span class="w">         </span><span class="kt">bool</span><span class="w">                   </span><span class="s">`json:&quot;fixationRisk&quot;`</span>
</span><span id="__span-66-13"><a id="__codelineno-66-13" name="__codelineno-66-13" href="#__codelineno-66-13"></a><span class="w">    </span><span class="nx">OverallSecurityScore</span><span class="w"> </span><span class="kt">int</span><span class="w">                    </span><span class="s">`json:&quot;overallSecurityScore&quot;`</span><span class="w"> </span><span class="c1">// 0-100</span>
</span><span id="__span-66-14"><a id="__codelineno-66-14" name="__codelineno-66-14" href="#__codelineno-66-14"></a><span class="p">}</span>
</span></code></pre></div>
<p><a name="analyzeCookieSecurity"></a></p>
<h3 id="func-analyzecookiesecurity">func analyzeCookieSecurity<a class="headerlink" href="#func-analyzecookiesecurity" title="Permanent link">&para;</a></h3>
<div class="language-go highlight"><pre><span></span><code><span id="__span-67-1"><a id="__codelineno-67-1" name="__codelineno-67-1" href="#__codelineno-67-1"></a><span class="kd">func</span><span class="w"> </span><span class="nx">analyzeCookieSecurity</span><span class="p">(</span><span class="nx">cookies</span><span class="w"> </span><span class="p">[]</span><span class="o">*</span><span class="nx">http</span><span class="p">.</span><span class="nx">Cookie</span><span class="p">,</span><span class="w"> </span><span class="nx">headers</span><span class="w"> </span><span class="nx">http</span><span class="p">.</span><span class="nx">Header</span><span class="p">)</span><span class="w"> </span><span class="nx">CookieSecurityAnalysis</span>
</span></code></pre></div>
<p>analyzeCookieSecurity performs comprehensive analysis of all cookies</p>
<p><a name="CookieSecurityDetail"></a></p>
<h2 id="type-cookiesecuritydetail">type CookieSecurityDetail<a class="headerlink" href="#type-cookiesecuritydetail" title="Permanent link">&para;</a></h2>
<p>CookieSecurityDetail represents security analysis for a single cookie</p>
<div class="language-go highlight"><pre><span></span><code><span id="__span-68-1"><a id="__codelineno-68-1" name="__codelineno-68-1" href="#__codelineno-68-1"></a><span class="kd">type</span><span class="w"> </span><span class="nx">CookieSecurityDetail</span><span class="w"> </span><span class="kd">struct</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-68-2"><a id="__codelineno-68-2" name="__codelineno-68-2" href="#__codelineno-68-2"></a><span class="w">    </span><span class="nx">Name</span><span class="w">             </span><span class="kt">string</span><span class="w">   </span><span class="s">`json:&quot;name&quot;`</span>
</span><span id="__span-68-3"><a id="__codelineno-68-3" name="__codelineno-68-3" href="#__codelineno-68-3"></a><span class="w">    </span><span class="nx">HasHttpOnly</span><span class="w">      </span><span class="kt">bool</span><span class="w">     </span><span class="s">`json:&quot;hasHttpOnly&quot;`</span>
</span><span id="__span-68-4"><a id="__codelineno-68-4" name="__codelineno-68-4" href="#__codelineno-68-4"></a><span class="w">    </span><span class="nx">HasSecure</span><span class="w">        </span><span class="kt">bool</span><span class="w">     </span><span class="s">`json:&quot;hasSecure&quot;`</span>
</span><span id="__span-68-5"><a id="__codelineno-68-5" name="__codelineno-68-5" href="#__codelineno-68-5"></a><span class="w">    </span><span class="nx">SameSite</span><span class="w">         </span><span class="kt">string</span><span class="w">   </span><span class="s">`json:&quot;sameSite&quot;`</span>
</span><span id="__span-68-6"><a id="__codelineno-68-6" name="__codelineno-68-6" href="#__codelineno-68-6"></a><span class="w">    </span><span class="nx">MaxAge</span><span class="w">           </span><span class="kt">int</span><span class="w">      </span><span class="s">`json:&quot;maxAge&quot;`</span>
</span><span id="__span-68-7"><a id="__codelineno-68-7" name="__codelineno-68-7" href="#__codelineno-68-7"></a><span class="w">    </span><span class="nx">ExpiresIn</span><span class="w">        </span><span class="kt">string</span><span class="w">   </span><span class="s">`json:&quot;expiresIn&quot;`</span>
</span><span id="__span-68-8"><a id="__codelineno-68-8" name="__codelineno-68-8" href="#__codelineno-68-8"></a><span class="w">    </span><span class="nx">IsSessionCookie</span><span class="w">  </span><span class="kt">bool</span><span class="w">     </span><span class="s">`json:&quot;isSessionCookie&quot;`</span>
</span><span id="__span-68-9"><a id="__codelineno-68-9" name="__codelineno-68-9" href="#__codelineno-68-9"></a><span class="w">    </span><span class="nx">SecurityIssues</span><span class="w">   </span><span class="p">[]</span><span class="kt">string</span><span class="w"> </span><span class="s">`json:&quot;securityIssues&quot;`</span>
</span><span id="__span-68-10"><a id="__codelineno-68-10" name="__codelineno-68-10" href="#__codelineno-68-10"></a><span class="w">    </span><span class="nx">SecurityScore</span><span class="w">    </span><span class="kt">int</span><span class="w">      </span><span class="s">`json:&quot;securityScore&quot;`</span><span class="w"> </span><span class="c1">// 0-100</span>
</span><span id="__span-68-11"><a id="__codelineno-68-11" name="__codelineno-68-11" href="#__codelineno-68-11"></a><span class="w">    </span><span class="nx">PredictableValue</span><span class="w"> </span><span class="kt">bool</span><span class="w">     </span><span class="s">`json:&quot;predictableValue&quot;`</span>
</span><span id="__span-68-12"><a id="__codelineno-68-12" name="__codelineno-68-12" href="#__codelineno-68-12"></a><span class="p">}</span>
</span></code></pre></div>
<p><a name="analyzeSingleCookie"></a></p>
<h3 id="func-analyzesinglecookie">func analyzeSingleCookie<a class="headerlink" href="#func-analyzesinglecookie" title="Permanent link">&para;</a></h3>
<div class="language-go highlight"><pre><span></span><code><span id="__span-69-1"><a id="__codelineno-69-1" name="__codelineno-69-1" href="#__codelineno-69-1"></a><span class="kd">func</span><span class="w"> </span><span class="nx">analyzeSingleCookie</span><span class="p">(</span><span class="nx">cookie</span><span class="w"> </span><span class="o">*</span><span class="nx">http</span><span class="p">.</span><span class="nx">Cookie</span><span class="p">,</span><span class="w"> </span><span class="nx">setCookieHeaders</span><span class="w"> </span><span class="p">[]</span><span class="kt">string</span><span class="p">,</span><span class="w"> </span><span class="nx">index</span><span class="w"> </span><span class="kt">int</span><span class="p">)</span><span class="w"> </span><span class="nx">CookieSecurityDetail</span>
</span></code></pre></div>
<p>analyzeSingleCookie performs detailed security analysis of a single cookie</p>
<p><a name="CrossOriginAnalysis"></a></p>
<h2 id="type-crossoriginanalysis">type CrossOriginAnalysis<a class="headerlink" href="#type-crossoriginanalysis" title="Permanent link">&para;</a></h2>
<p>CrossOriginAnalysis represents the parsed and analyzed cross-origin security headers configuration</p>
<div class="language-go highlight"><pre><span></span><code><span id="__span-70-1"><a id="__codelineno-70-1" name="__codelineno-70-1" href="#__codelineno-70-1"></a><span class="kd">type</span><span class="w"> </span><span class="nx">CrossOriginAnalysis</span><span class="w"> </span><span class="kd">struct</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-70-2"><a id="__codelineno-70-2" name="__codelineno-70-2" href="#__codelineno-70-2"></a><span class="w">    </span><span class="nx">HasCOEP</span><span class="w">            </span><span class="kt">bool</span><span class="w">     </span><span class="s">`json:&quot;hasCOEP&quot;`</span>
</span><span id="__span-70-3"><a id="__codelineno-70-3" name="__codelineno-70-3" href="#__codelineno-70-3"></a><span class="w">    </span><span class="nx">HasCORP</span><span class="w">            </span><span class="kt">bool</span><span class="w">     </span><span class="s">`json:&quot;hasCORP&quot;`</span>
</span><span id="__span-70-4"><a id="__codelineno-70-4" name="__codelineno-70-4" href="#__codelineno-70-4"></a><span class="w">    </span><span class="nx">HasCOOP</span><span class="w">            </span><span class="kt">bool</span><span class="w">     </span><span class="s">`json:&quot;hasCOOP&quot;`</span>
</span><span id="__span-70-5"><a id="__codelineno-70-5" name="__codelineno-70-5" href="#__codelineno-70-5"></a><span class="w">    </span><span class="nx">COEPValue</span><span class="w">          </span><span class="kt">string</span><span class="w">   </span><span class="s">`json:&quot;coepValue&quot;`</span>
</span><span id="__span-70-6"><a id="__codelineno-70-6" name="__codelineno-70-6" href="#__codelineno-70-6"></a><span class="w">    </span><span class="nx">CORPValue</span><span class="w">          </span><span class="kt">string</span><span class="w">   </span><span class="s">`json:&quot;corpValue&quot;`</span>
</span><span id="__span-70-7"><a id="__codelineno-70-7" name="__codelineno-70-7" href="#__codelineno-70-7"></a><span class="w">    </span><span class="nx">COOPValue</span><span class="w">          </span><span class="kt">string</span><span class="w">   </span><span class="s">`json:&quot;coopValue&quot;`</span>
</span><span id="__span-70-8"><a id="__codelineno-70-8" name="__codelineno-70-8" href="#__codelineno-70-8"></a><span class="w">    </span><span class="nx">SecurityIssues</span><span class="w">     </span><span class="p">[]</span><span class="kt">string</span><span class="w"> </span><span class="s">`json:&quot;securityIssues&quot;`</span>
</span><span id="__span-70-9"><a id="__codelineno-70-9" name="__codelineno-70-9" href="#__codelineno-70-9"></a><span class="w">    </span><span class="nx">ConfiguredHeaders</span><span class="w">  </span><span class="p">[]</span><span class="kt">string</span><span class="w"> </span><span class="s">`json:&quot;configuredHeaders&quot;`</span>
</span><span id="__span-70-10"><a id="__codelineno-70-10" name="__codelineno-70-10" href="#__codelineno-70-10"></a><span class="w">    </span><span class="nx">MissingHeaders</span><span class="w">     </span><span class="p">[]</span><span class="kt">string</span><span class="w"> </span><span class="s">`json:&quot;missingHeaders&quot;`</span>
</span><span id="__span-70-11"><a id="__codelineno-70-11" name="__codelineno-70-11" href="#__codelineno-70-11"></a><span class="w">    </span><span class="nx">ProtectionLevel</span><span class="w">    </span><span class="kt">string</span><span class="w">   </span><span class="s">`json:&quot;protectionLevel&quot;`</span>
</span><span id="__span-70-12"><a id="__codelineno-70-12" name="__codelineno-70-12" href="#__codelineno-70-12"></a><span class="w">    </span><span class="nx">RecommendedActions</span><span class="w"> </span><span class="p">[]</span><span class="kt">string</span><span class="w"> </span><span class="s">`json:&quot;recommendedActions&quot;`</span>
</span><span id="__span-70-13"><a id="__codelineno-70-13" name="__codelineno-70-13" href="#__codelineno-70-13"></a><span class="w">    </span><span class="nx">IsolationEffective</span><span class="w"> </span><span class="kt">bool</span><span class="w">     </span><span class="s">`json:&quot;isolationEffective&quot;`</span>
</span><span id="__span-70-14"><a id="__codelineno-70-14" name="__codelineno-70-14" href="#__codelineno-70-14"></a><span class="p">}</span>
</span></code></pre></div>
<p><a name="JSObfuscationAnalysis"></a></p>
<h2 id="type-jsobfuscationanalysis">type JSObfuscationAnalysis<a class="headerlink" href="#type-jsobfuscationanalysis" title="Permanent link">&para;</a></h2>
<p>JSObfuscationAnalysis represents the comprehensive obfuscation analysis</p>
<div class="language-go highlight"><pre><span></span><code><span id="__span-71-1"><a id="__codelineno-71-1" name="__codelineno-71-1" href="#__codelineno-71-1"></a><span class="kd">type</span><span class="w"> </span><span class="nx">JSObfuscationAnalysis</span><span class="w"> </span><span class="kd">struct</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-71-2"><a id="__codelineno-71-2" name="__codelineno-71-2" href="#__codelineno-71-2"></a><span class="w">    </span><span class="nx">HasObfuscation</span><span class="w">      </span><span class="kt">bool</span><span class="w">     </span><span class="s">`json:&quot;hasObfuscation&quot;`</span>
</span><span id="__span-71-3"><a id="__codelineno-71-3" name="__codelineno-71-3" href="#__codelineno-71-3"></a><span class="w">    </span><span class="nx">ObfuscationScore</span><span class="w">    </span><span class="kt">int</span><span class="w">      </span><span class="s">`json:&quot;obfuscationScore&quot;`</span><span class="w"> </span><span class="c1">// 0-100</span>
</span><span id="__span-71-4"><a id="__codelineno-71-4" name="__codelineno-71-4" href="#__codelineno-71-4"></a><span class="w">    </span><span class="nx">ObfuscationPatterns</span><span class="w"> </span><span class="p">[]</span><span class="kt">string</span><span class="w"> </span><span class="s">`json:&quot;obfuscationPatterns&quot;`</span>
</span><span id="__span-71-5"><a id="__codelineno-71-5" name="__codelineno-71-5" href="#__codelineno-71-5"></a><span class="w">    </span><span class="nx">SuspiciousPatterns</span><span class="w">  </span><span class="p">[]</span><span class="kt">string</span><span class="w"> </span><span class="s">`json:&quot;suspiciousPatterns&quot;`</span>
</span><span id="__span-71-6"><a id="__codelineno-71-6" name="__codelineno-71-6" href="#__codelineno-71-6"></a><span class="w">    </span><span class="nx">MaliciousIndicators</span><span class="w"> </span><span class="p">[]</span><span class="kt">string</span><span class="w"> </span><span class="s">`json:&quot;maliciousIndicators&quot;`</span>
</span><span id="__span-71-7"><a id="__codelineno-71-7" name="__codelineno-71-7" href="#__codelineno-71-7"></a><span class="w">    </span><span class="nx">EncodingMethods</span><span class="w">     </span><span class="p">[]</span><span class="kt">string</span><span class="w"> </span><span class="s">`json:&quot;encodingMethods&quot;`</span>
</span><span id="__span-71-8"><a id="__codelineno-71-8" name="__codelineno-71-8" href="#__codelineno-71-8"></a><span class="w">    </span><span class="nx">DynamicExecution</span><span class="w">    </span><span class="kt">int</span><span class="w">      </span><span class="s">`json:&quot;dynamicExecution&quot;`</span><span class="w"> </span><span class="c1">// Count of eval/Function calls</span>
</span><span id="__span-71-9"><a id="__codelineno-71-9" name="__codelineno-71-9" href="#__codelineno-71-9"></a><span class="w">    </span><span class="nx">EncodedStrings</span><span class="w">      </span><span class="kt">int</span><span class="w">      </span><span class="s">`json:&quot;encodedStrings&quot;`</span><span class="w">   </span><span class="c1">// Count of encoded strings</span>
</span><span id="__span-71-10"><a id="__codelineno-71-10" name="__codelineno-71-10" href="#__codelineno-71-10"></a><span class="w">    </span><span class="nx">CharCodeUsage</span><span class="w">       </span><span class="kt">int</span><span class="w">      </span><span class="s">`json:&quot;charCodeUsage&quot;`</span><span class="w">    </span><span class="c1">// String.fromCharCode usage</span>
</span><span id="__span-71-11"><a id="__codelineno-71-11" name="__codelineno-71-11" href="#__codelineno-71-11"></a><span class="w">    </span><span class="nx">HexEscapes</span><span class="w">          </span><span class="kt">int</span><span class="w">      </span><span class="s">`json:&quot;hexEscapes&quot;`</span><span class="w">       </span><span class="c1">// \x escape sequences</span>
</span><span id="__span-71-12"><a id="__codelineno-71-12" name="__codelineno-71-12" href="#__codelineno-71-12"></a><span class="w">    </span><span class="nx">UnicodeEscapes</span><span class="w">      </span><span class="kt">int</span><span class="w">      </span><span class="s">`json:&quot;unicodeEscapes&quot;`</span><span class="w">   </span><span class="c1">// \u escape sequences</span>
</span><span id="__span-71-13"><a id="__codelineno-71-13" name="__codelineno-71-13" href="#__codelineno-71-13"></a><span class="w">    </span><span class="nx">Base64Strings</span><span class="w">       </span><span class="kt">int</span><span class="w">      </span><span class="s">`json:&quot;base64Strings&quot;`</span><span class="w">    </span><span class="c1">// Base64 encoded strings</span>
</span><span id="__span-71-14"><a id="__codelineno-71-14" name="__codelineno-71-14" href="#__codelineno-71-14"></a><span class="w">    </span><span class="nx">ObfuscationLevel</span><span class="w">    </span><span class="kt">string</span><span class="w">   </span><span class="s">`json:&quot;obfuscationLevel&quot;`</span><span class="w"> </span><span class="c1">// none, light, moderate, heavy, extreme</span>
</span><span id="__span-71-15"><a id="__codelineno-71-15" name="__codelineno-71-15" href="#__codelineno-71-15"></a><span class="w">    </span><span class="nx">Certainty</span><span class="w">           </span><span class="kt">int</span><span class="w">      </span><span class="s">`json:&quot;certainty&quot;`</span><span class="w">        </span><span class="c1">// 0-100</span>
</span><span id="__span-71-16"><a id="__codelineno-71-16" name="__codelineno-71-16" href="#__codelineno-71-16"></a><span class="p">}</span>
</span></code></pre></div>
<p><a name="analyzeJSObfuscation"></a></p>
<h3 id="func-analyzejsobfuscation">func analyzeJSObfuscation<a class="headerlink" href="#func-analyzejsobfuscation" title="Permanent link">&para;</a></h3>
<div class="language-go highlight"><pre><span></span><code><span id="__span-72-1"><a id="__codelineno-72-1" name="__codelineno-72-1" href="#__codelineno-72-1"></a><span class="kd">func</span><span class="w"> </span><span class="nx">analyzeJSObfuscation</span><span class="p">(</span><span class="nx">content</span><span class="w"> </span><span class="kt">string</span><span class="p">)</span><span class="w"> </span><span class="nx">JSObfuscationAnalysis</span>
</span></code></pre></div>
<p>analyzeJSObfuscation performs comprehensive JavaScript obfuscation analysis</p>
<p><a name="ResponseTest"></a></p>
<h2 id="type-responsetest">type ResponseTest<a class="headerlink" href="#type-responsetest" title="Permanent link">&para;</a></h2>
<p>ResponseTest defines a security test that analyzes an HTTP response for vulnerabilities, misconfigurations, or security issues. It provides the structure and execution interface for all security tests in the framework.</p>
<p>The structure uses composition with a function field for flexible test implementation:</p>
<ul>
<li>Allows inline test definition without separate structs</li>
<li>Enables closure-based tests with captured context</li>
<li>Simplifies test registration and discovery</li>
<li>Supports both simple and complex test logic</li>
</ul>
<p>Each test should:</p>
<ul>
<li>Analyze specific security aspects (HTTPS, HSTS, headers, etc.)</li>
<li>Return structured TestResult with appropriate ThreatLevel</li>
<li>Include detailed Metadata for findings</li>
<li>Provide actionable Description for remediation</li>
</ul>
<p>Fields:</p>
<ul>
<li>Id: Unique identifier for test registration and selection (e.g., "https", "hsts")</li>
<li>Name: Human-readable test name for display</li>
<li>Description: Detailed explanation of what the test checks</li>
<li>RunTest: Function that executes the test logic</li>
</ul>
<div class="language-go highlight"><pre><span></span><code><span id="__span-73-1"><a id="__codelineno-73-1" name="__codelineno-73-1" href="#__codelineno-73-1"></a><span class="kd">type</span><span class="w"> </span><span class="nx">ResponseTest</span><span class="w"> </span><span class="kd">struct</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-73-2"><a id="__codelineno-73-2" name="__codelineno-73-2" href="#__codelineno-73-2"></a><span class="w">    </span><span class="nx">Id</span><span class="w">          </span><span class="kt">string</span><span class="w">                                     </span><span class="c1">// Unique test identifier (e.g., &quot;https&quot;, &quot;hsts&quot;, &quot;csp&quot;)</span>
</span><span id="__span-73-3"><a id="__codelineno-73-3" name="__codelineno-73-3" href="#__codelineno-73-3"></a><span class="w">    </span><span class="nx">Name</span><span class="w">        </span><span class="kt">string</span><span class="w">                                     </span><span class="c1">// Human-readable test name</span>
</span><span id="__span-73-4"><a id="__codelineno-73-4" name="__codelineno-73-4" href="#__codelineno-73-4"></a><span class="w">    </span><span class="nx">Description</span><span class="w"> </span><span class="kt">string</span><span class="w">                                     </span><span class="c1">// Detailed test description</span>
</span><span id="__span-73-5"><a id="__codelineno-73-5" name="__codelineno-73-5" href="#__codelineno-73-5"></a><span class="w">    </span><span class="nx">RunTest</span><span class="w">     </span><span class="kd">func</span><span class="p">(</span><span class="nx">params</span><span class="w"> </span><span class="nx">ResponseTestParams</span><span class="p">)</span><span class="w"> </span><span class="nx">TestResult</span><span class="w"> </span><span class="c1">// Test execution function</span>
</span><span id="__span-73-6"><a id="__codelineno-73-6" name="__codelineno-73-6" href="#__codelineno-73-6"></a><span class="p">}</span>
</span></code></pre></div>
<p><a name="NewCSPTest"></a></p>
<h3 id="func-newcsptest">func NewCSPTest<a class="headerlink" href="#func-newcsptest" title="Permanent link">&para;</a></h3>
<div class="language-go highlight"><pre><span></span><code><span id="__span-74-1"><a id="__codelineno-74-1" name="__codelineno-74-1" href="#__codelineno-74-1"></a><span class="kd">func</span><span class="w"> </span><span class="nx">NewCSPTest</span><span class="p">()</span><span class="w"> </span><span class="o">*</span><span class="nx">ResponseTest</span>
</span></code></pre></div>
<p>NewCSPTest creates a new ResponseTest that analyzes Content Security Policy (CSP) header configuration. CSP is a security mechanism that helps prevent cross-site scripting (XSS), data injection attacks, and other code injection vulnerabilities by controlling which resources the browser is allowed to load for a given page.</p>
<p>The test evaluates:</p>
<ul>
<li>Presence of Content-Security-Policy header</li>
<li>Critical directive configurations (default-src, script-src, object-src, etc.)</li>
<li>Unsafe directive values ('unsafe-inline', 'unsafe-eval', '*')</li>
<li>Missing security-critical directives</li>
<li>Policy syntax and validity</li>
</ul>
<p>Threat level assessment:</p>
<ul>
<li>None (0): Excellent - Comprehensive CSP with strict directives, no unsafe values</li>
<li>Info (1): Good - Well-configured CSP with minor improvements possible</li>
<li>Low (2): Acceptable - Basic CSP present with some weaknesses</li>
<li>Medium (3): Weak - CSP present but with significant security issues</li>
<li>High (4): Poor - CSP present but severely misconfigured or ineffective</li>
<li>Critical (5): Missing - No CSP header found, vulnerable to injection attacks</li>
</ul>
<p>Security implications:</p>
<ul>
<li>Missing CSP: Vulnerable to XSS, data injection, and clickjacking attacks</li>
<li>unsafe-inline: Allows inline scripts/styles, negating XSS protection</li>
<li>unsafe-eval: Permits eval() and similar functions, enabling code injection</li>
<li>Wildcard (*): Allows loading from any source, undermining security</li>
<li>Missing object-src: May allow Flash/plugin-based attacks</li>
<li>Missing base-uri: Vulnerable to base tag injection attacks</li>
</ul>
<p>Standards compliance:</p>
<ul>
<li>Content Security Policy Level 2 (W3C Recommendation)</li>
<li>Content Security Policy Level 3 (W3C Working Draft)</li>
</ul>
<p>Returns:</p>
<ul>
<li>*ResponseTest: Configured CSP test ready for execution</li>
</ul>
<p>Example usage:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-75-1"><a id="__codelineno-75-1" name="__codelineno-75-1" href="#__codelineno-75-1"></a>cspTest := NewCSPTest()
</span><span id="__span-75-2"><a id="__codelineno-75-2" name="__codelineno-75-2" href="#__codelineno-75-2"></a>result := cspTest.Run(ResponseTestParams{Response: httpResponse})
</span><span id="__span-75-3"><a id="__codelineno-75-3" name="__codelineno-75-3" href="#__codelineno-75-3"></a>// Result includes threat level and detailed CSP configuration analysis
</span></code></pre></div>
<p><a name="NewCookieSecurityTest"></a></p>
<h3 id="func-newcookiesecuritytest">func NewCookieSecurityTest<a class="headerlink" href="#func-newcookiesecuritytest" title="Permanent link">&para;</a></h3>
<div class="language-go highlight"><pre><span></span><code><span id="__span-76-1"><a id="__codelineno-76-1" name="__codelineno-76-1" href="#__codelineno-76-1"></a><span class="kd">func</span><span class="w"> </span><span class="nx">NewCookieSecurityTest</span><span class="p">()</span><span class="w"> </span><span class="o">*</span><span class="nx">ResponseTest</span>
</span></code></pre></div>
<p>NewCookieSecurityTest creates a new ResponseTest that analyzes cookie security configurations. Cookies are critical for session management and authentication, making their security paramount. Improperly configured cookies can lead to session hijacking, XSS exploitation, CSRF attacks, and session fixation vulnerabilities.</p>
<p>The test evaluates:</p>
<ul>
<li>HttpOnly flag (prevents JavaScript access to cookies)</li>
<li>Secure flag (ensures transmission only over HTTPS)</li>
<li>SameSite attribute (protects against CSRF attacks)</li>
<li>Expiration times (Max-Age/Expires values)</li>
<li>Cookie predictability and session fixation risks</li>
<li>Cookie name patterns indicating sensitive data</li>
</ul>
<p>Threat level assessment:</p>
<ul>
<li>None (0): All cookies properly secured with HttpOnly, Secure, SameSite, and reasonable expiration</li>
<li>Info (1): Minor issues like long expiration times but critical flags present</li>
<li>Low (2): Some cookies missing non-critical security attributes</li>
<li>Medium (3): Cookies missing important security flags (HttpOnly or Secure)</li>
<li>High (4): Multiple security issues or session cookies without protection</li>
<li>Critical (5): Session cookies completely unsecured or high fixation risk</li>
</ul>
<p>Security implications:</p>
<ul>
<li>Missing HttpOnly: Vulnerable to XSS-based cookie theft</li>
<li>Missing Secure: Cookies can be intercepted over HTTP (MITM attacks)</li>
<li>Missing SameSite: Vulnerable to CSRF attacks</li>
<li>Long expiration: Extended window for cookie theft/replay attacks</li>
<li>Predictable values: Session fixation and prediction attacks</li>
</ul>
<p>Returns:</p>
<ul>
<li>*ResponseTest: Configured cookie security test ready for execution</li>
</ul>
<p>Example usage:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-77-1"><a id="__codelineno-77-1" name="__codelineno-77-1" href="#__codelineno-77-1"></a>cookieTest := NewCookieSecurityTest()
</span><span id="__span-77-2"><a id="__codelineno-77-2" name="__codelineno-77-2" href="#__codelineno-77-2"></a>result := cookieTest.Run(ResponseTestParams{Response: httpResponse})
</span><span id="__span-77-3"><a id="__codelineno-77-3" name="__codelineno-77-3" href="#__codelineno-77-3"></a>// Result includes threat level and detailed cookie security analysis
</span></code></pre></div>
<p><a name="NewCrossOriginTest"></a></p>
<h3 id="func-newcrossorigintest">func NewCrossOriginTest<a class="headerlink" href="#func-newcrossorigintest" title="Permanent link">&para;</a></h3>
<div class="language-go highlight"><pre><span></span><code><span id="__span-78-1"><a id="__codelineno-78-1" name="__codelineno-78-1" href="#__codelineno-78-1"></a><span class="kd">func</span><span class="w"> </span><span class="nx">NewCrossOriginTest</span><span class="p">()</span><span class="w"> </span><span class="o">*</span><span class="nx">ResponseTest</span>
</span></code></pre></div>
<p>NewCrossOriginTest creates a new ResponseTest that analyzes Cross-Origin security headers configuration. These headers provide defense-in-depth protection against cross-origin attacks, Spectre-like vulnerabilities, and help enforce browser-level isolation boundaries.</p>
<p>The test evaluates:</p>
<ul>
<li>Cross-Origin-Embedder-Policy (COEP): Controls cross-origin resource embedding</li>
<li>Cross-Origin-Resource-Policy (CORP): Controls cross-origin resource access</li>
<li>Cross-Origin-Opener-Policy (COOP): Controls cross-origin window opener access</li>
<li>Header value validation and security implications</li>
<li>Combination effectiveness for comprehensive isolation</li>
</ul>
<p>Threat level assessment:</p>
<ul>
<li>None (0): Excellent - All three headers properly configured with strict values</li>
<li>Info (1): Good - Two headers configured with secure values</li>
<li>Low (2): Acceptable - One header configured or less strict configuration</li>
<li>Medium (3): Weak - Headers present but with permissive values</li>
<li>High (4): Poor - No cross-origin security headers found</li>
</ul>
<p>Security implications:</p>
<ul>
<li>Missing COEP: Vulnerable to cross-origin resource embedding attacks</li>
<li>Missing CORP: Resources can be accessed cross-origin without restrictions</li>
<li>Missing COOP: Vulnerable to cross-origin opener attacks and window references</li>
<li>Permissive values: Reduced isolation effectiveness</li>
<li>No headers: Full exposure to cross-origin attacks and Spectre-like vulnerabilities</li>
</ul>
<p>Standards compliance:</p>
<ul>
<li>Cross-Origin-Embedder-Policy (W3C Draft)</li>
<li>Cross-Origin-Resource-Policy (W3C Recommendation)</li>
<li>Cross-Origin-Opener-Policy (W3C Draft)</li>
</ul>
<p>Returns:</p>
<ul>
<li>*ResponseTest: Configured cross-origin security test ready for execution</li>
</ul>
<p>Example usage:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-79-1"><a id="__codelineno-79-1" name="__codelineno-79-1" href="#__codelineno-79-1"></a>crossOriginTest := NewCrossOriginTest()
</span><span id="__span-79-2"><a id="__codelineno-79-2" name="__codelineno-79-2" href="#__codelineno-79-2"></a>result := crossOriginTest.Run(ResponseTestParams{Response: httpResponse})
</span><span id="__span-79-3"><a id="__codelineno-79-3" name="__codelineno-79-3" href="#__codelineno-79-3"></a>// Result includes threat level and detailed cross-origin security analysis
</span></code></pre></div>
<p><a name="NewHSTSTest"></a></p>
<h3 id="func-newhststest">func NewHSTSTest<a class="headerlink" href="#func-newhststest" title="Permanent link">&para;</a></h3>
<div class="language-go highlight"><pre><span></span><code><span id="__span-80-1"><a id="__codelineno-80-1" name="__codelineno-80-1" href="#__codelineno-80-1"></a><span class="kd">func</span><span class="w"> </span><span class="nx">NewHSTSTest</span><span class="p">()</span><span class="w"> </span><span class="o">*</span><span class="nx">ResponseTest</span>
</span></code></pre></div>
<p>NewHSTSTest creates a new ResponseTest that analyzes HTTP Strict Transport Security (HSTS) header configuration. HSTS is a security mechanism that forces browsers to interact with websites exclusively over HTTPS, protecting against protocol downgrade attacks and cookie hijacking.</p>
<p>The test evaluates:</p>
<ul>
<li>Presence of Strict-Transport-Security header</li>
<li>max-age directive value (minimum recommended: 6 months, ideal: 1+ year)</li>
<li>includeSubDomains directive (protects all subdomains)</li>
<li>preload directive (enables HSTS preload list inclusion)</li>
</ul>
<p>Threat level assessment:</p>
<ul>
<li>None (0): Excellent - max-age  1 year + includeSubDomains + preload</li>
<li>Info (1): Good - max-age  1 year + includeSubDomains</li>
<li>Low (2): Acceptable - max-age  6 months</li>
<li>Medium (3): Weak - max-age present but \&lt; 6 months</li>
<li>Medium (3): Missing - No HSTS header found</li>
<li>High (4): Invalid - HSTS header present but missing/invalid max-age</li>
</ul>
<p>Security implications:</p>
<ul>
<li>Missing HSTS: Vulnerable to SSL stripping attacks, protocol downgrades, and MITM attacks</li>
<li>Short max-age: Limited protection window, requires frequent policy refreshes</li>
<li>No includeSubDomains: Subdomains remain vulnerable to attacks</li>
<li>No preload: Not eligible for browser HSTS preload lists</li>
</ul>
<p>Returns:</p>
<ul>
<li>*ResponseTest: Configured HSTS test ready for execution</li>
</ul>
<p>Example usage:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-81-1"><a id="__codelineno-81-1" name="__codelineno-81-1" href="#__codelineno-81-1"></a>hstsTest := NewHSTSTest()
</span><span id="__span-81-2"><a id="__codelineno-81-2" name="__codelineno-81-2" href="#__codelineno-81-2"></a>result := hstsTest.Run(ResponseTestParams{Response: httpResponse})
</span><span id="__span-81-3"><a id="__codelineno-81-3" name="__codelineno-81-3" href="#__codelineno-81-3"></a>// Result includes threat level and detailed configuration analysis
</span></code></pre></div>
<p><a name="NewHTTPSTest"></a></p>
<h3 id="func-newhttpstest">func NewHTTPSTest<a class="headerlink" href="#func-newhttpstest" title="Permanent link">&para;</a></h3>
<div class="language-go highlight"><pre><span></span><code><span id="__span-82-1"><a id="__codelineno-82-1" name="__codelineno-82-1" href="#__codelineno-82-1"></a><span class="kd">func</span><span class="w"> </span><span class="nx">NewHTTPSTest</span><span class="p">()</span><span class="w"> </span><span class="o">*</span><span class="nx">ResponseTest</span>
</span></code></pre></div>
<p>NewHTTPSTest creates a new security test that verifies HTTPS protocol usage. This test checks whether the target website enforces encrypted HTTPS connections or allows insecure HTTP communication.</p>
<p>Test Behavior:</p>
<p>The test examines the URL scheme of the HTTP response to determine the protocol:</p>
<ul>
<li>If scheme is "https": Returns ThreatLevel.None (secure)</li>
<li>If scheme is "http": Returns ThreatLevel.High (insecure)</li>
</ul>
<p>Security Implications:</p>
<p>HTTP connections transmit data in plaintext, making them vulnerable to:</p>
<ul>
<li>Packet sniffing and eavesdropping</li>
<li>Man-in-the-middle (MITM) attacks</li>
<li>Data tampering and injection</li>
<li>Session hijacking</li>
<li>Credential theft</li>
</ul>
<p>HTTPS provides:</p>
<ul>
<li>End-to-end encryption (TLS/SSL)</li>
<li>Server authentication via certificates</li>
<li>Data integrity verification</li>
<li>Protection against passive and active attacks</li>
</ul>
<p>Certainty:</p>
<p>This test always returns 100% certainty as protocol detection is deterministic based on the URL scheme in the HTTP response object.</p>
<p>Returns:</p>
<ul>
<li>*ResponseTest: Configured test instance ready for execution</li>
</ul>
<p>Example:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-83-1"><a id="__codelineno-83-1" name="__codelineno-83-1" href="#__codelineno-83-1"></a>// Create the HTTPS test
</span><span id="__span-83-2"><a id="__codelineno-83-2" name="__codelineno-83-2" href="#__codelineno-83-2"></a>httpsTest := NewHTTPSTest()
</span><span id="__span-83-3"><a id="__codelineno-83-3" name="__codelineno-83-3" href="#__codelineno-83-3"></a>
</span><span id="__span-83-4"><a id="__codelineno-83-4" name="__codelineno-83-4" href="#__codelineno-83-4"></a>// Execute against target (via Runner)
</span><span id="__span-83-5"><a id="__codelineno-83-5" name="__codelineno-83-5" href="#__codelineno-83-5"></a>params := ResponseTestParams{
</span><span id="__span-83-6"><a id="__codelineno-83-6" name="__codelineno-83-6" href="#__codelineno-83-6"></a>    Response: httpResponse,
</span><span id="__span-83-7"><a id="__codelineno-83-7" name="__codelineno-83-7" href="#__codelineno-83-7"></a>    Url:      &quot;https://example.com&quot;,
</span><span id="__span-83-8"><a id="__codelineno-83-8" name="__codelineno-83-8" href="#__codelineno-83-8"></a>}
</span><span id="__span-83-9"><a id="__codelineno-83-9" name="__codelineno-83-9" href="#__codelineno-83-9"></a>result := httpsTest.Run(params)
</span><span id="__span-83-10"><a id="__codelineno-83-10" name="__codelineno-83-10" href="#__codelineno-83-10"></a>
</span><span id="__span-83-11"><a id="__codelineno-83-11" name="__codelineno-83-11" href="#__codelineno-83-11"></a>// Secure site (HTTPS)
</span><span id="__span-83-12"><a id="__codelineno-83-12" name="__codelineno-83-12" href="#__codelineno-83-12"></a>// result.ThreatLevel = None
</span><span id="__span-83-13"><a id="__codelineno-83-13" name="__codelineno-83-13" href="#__codelineno-83-13"></a>// result.Description = &quot;Connection is secured with HTTPS protocol...&quot;
</span><span id="__span-83-14"><a id="__codelineno-83-14" name="__codelineno-83-14" href="#__codelineno-83-14"></a>
</span><span id="__span-83-15"><a id="__codelineno-83-15" name="__codelineno-83-15" href="#__codelineno-83-15"></a>// Insecure site (HTTP)
</span><span id="__span-83-16"><a id="__codelineno-83-16" name="__codelineno-83-16" href="#__codelineno-83-16"></a>// result.ThreatLevel = High
</span><span id="__span-83-17"><a id="__codelineno-83-17" name="__codelineno-83-17" href="#__codelineno-83-17"></a>// result.Description = &quot;Connection uses insecure HTTP protocol...&quot;
</span></code></pre></div>
<p>Related Tests:</p>
<ul>
<li>HSTSTest: Validates HTTP Strict Transport Security headers</li>
<li>ServerHeaderTest: Analyzes server headers for security issues</li>
</ul>
<p><a name="NewJSObfuscationTest"></a></p>
<h3 id="func-newjsobfuscationtest">func NewJSObfuscationTest<a class="headerlink" href="#func-newjsobfuscationtest" title="Permanent link">&para;</a></h3>
<div class="language-go highlight"><pre><span></span><code><span id="__span-84-1"><a id="__codelineno-84-1" name="__codelineno-84-1" href="#__codelineno-84-1"></a><span class="kd">func</span><span class="w"> </span><span class="nx">NewJSObfuscationTest</span><span class="p">()</span><span class="w"> </span><span class="o">*</span><span class="nx">ResponseTest</span>
</span></code></pre></div>
<p>NewJSObfuscationTest creates a new ResponseTest that analyzes JavaScript code for obfuscation. Obfuscated JavaScript is often used by attackers to hide malicious payloads, evade detection, or make reverse engineering difficult. While legitimate sites may use minification, heavy obfuscation is a red flag for potential security threats.</p>
<p>The test evaluates:</p>
<ul>
<li>Encoded strings (Base64, hex, unicode escape sequences)</li>
<li>Character substitution patterns</li>
<li>Excessive use of eval(), Function(), or similar dynamic execution</li>
<li>String concatenation obfuscation</li>
<li>Highly compressed or minimized code patterns</li>
<li>Suspicious variable/function naming patterns</li>
<li>Code that decodes or decrypts itself at runtime</li>
</ul>
<p>Threat level assessment:</p>
<ul>
<li>None (0): No obfuscation detected, clean JavaScript code</li>
<li>Info (1): Minor minification or basic optimization detected</li>
<li>Low (2): Some obfuscation patterns but likely legitimate (e.g., webpack bundles)</li>
<li>Medium (3): Moderate obfuscation with multiple suspicious patterns</li>
<li>High (4): Heavy obfuscation with clear intent to hide functionality</li>
<li>Critical (5): Extremely obfuscated code with malicious indicators</li>
</ul>
<p>Security implications:</p>
<ul>
<li>Obfuscated code can hide malicious payloads (keyloggers, data exfiltration)</li>
<li>May indicate compromised website or injected malware</li>
<li>Can evade security scanners and code review</li>
<li>Often used in drive-by download attacks</li>
<li>May hide cryptocurrency miners or ad fraud scripts</li>
</ul>
<p>Detection patterns:</p>
<ul>
<li>Base64 encoded strings followed by decode/atob</li>
<li>Hex escape sequences (\x41\x42\x43)</li>
<li>Unicode escape sequences (\u0041\u0042\u0043)</li>
<li>eval() with encoded or constructed strings</li>
<li>String.fromCharCode() with numeric arrays</li>
<li>Excessive string concatenation</li>
<li>Self-modifying or self-decrypting code</li>
</ul>
<p>Returns:</p>
<ul>
<li>*ResponseTest: Configured JavaScript obfuscation test ready for execution</li>
</ul>
<p>Example usage:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-85-1"><a id="__codelineno-85-1" name="__codelineno-85-1" href="#__codelineno-85-1"></a>jsObfTest := NewJSObfuscationTest()
</span><span id="__span-85-2"><a id="__codelineno-85-2" name="__codelineno-85-2" href="#__codelineno-85-2"></a>result := jsObfTest.Run(ResponseTestParams{Response: httpResponse})
</span><span id="__span-85-3"><a id="__codelineno-85-3" name="__codelineno-85-3" href="#__codelineno-85-3"></a>// Result includes threat level and detailed obfuscation analysis
</span></code></pre></div>
<p><a name="NewPermissionsPolicyTest"></a></p>
<h3 id="func-newpermissionspolicytest">func NewPermissionsPolicyTest<a class="headerlink" href="#func-newpermissionspolicytest" title="Permanent link">&para;</a></h3>
<div class="language-go highlight"><pre><span></span><code><span id="__span-86-1"><a id="__codelineno-86-1" name="__codelineno-86-1" href="#__codelineno-86-1"></a><span class="kd">func</span><span class="w"> </span><span class="nx">NewPermissionsPolicyTest</span><span class="p">()</span><span class="w"> </span><span class="o">*</span><span class="nx">ResponseTest</span>
</span></code></pre></div>
<p>NewPermissionsPolicyTest creates a new ResponseTest that analyzes Permissions-Policy header configuration. The Permissions-Policy header controls which browser features and APIs can be used by the page and its embedded content, replacing the deprecated Feature-Policy.</p>
<p>The test evaluates:</p>
<ul>
<li>Presence of Permissions-Policy header</li>
<li>Dangerous permissions that should be restricted</li>
<li>Overly permissive wildcard (*) usage</li>
<li>Common security-sensitive features</li>
</ul>
<p>Threat level assessment:</p>
<ul>
<li>None (0): Excellent - Comprehensive policy with restricted dangerous features</li>
<li>Info (1): Good - Policy present with minor issues</li>
<li>Low (2): Acceptable - Basic policy with some unrestricted features</li>
<li>Medium (3): Weak - Policy present but allows dangerous features</li>
<li>High (4): Missing - No policy header found</li>
</ul>
<p>Security implications:</p>
<ul>
<li>Missing header: All features available to page and embedded content</li>
<li>Unrestricted dangerous features: Risk of abuse (camera, microphone, geolocation)</li>
<li>Wildcard usage: Overly permissive access to sensitive APIs</li>
</ul>
<p>Returns:</p>
<ul>
<li>*ResponseTest: Configured Permissions-Policy test ready for execution</li>
</ul>
<p><a name="NewReferrerPolicyTest"></a></p>
<h3 id="func-newreferrerpolicytest">func NewReferrerPolicyTest<a class="headerlink" href="#func-newreferrerpolicytest" title="Permanent link">&para;</a></h3>
<div class="language-go highlight"><pre><span></span><code><span id="__span-87-1"><a id="__codelineno-87-1" name="__codelineno-87-1" href="#__codelineno-87-1"></a><span class="kd">func</span><span class="w"> </span><span class="nx">NewReferrerPolicyTest</span><span class="p">()</span><span class="w"> </span><span class="o">*</span><span class="nx">ResponseTest</span>
</span></code></pre></div>
<p>NewReferrerPolicyTest creates a new ResponseTest that analyzes Referrer-Policy header configuration. The Referrer-Policy header controls how much referrer information (sent via the Referer header) should be included with requests made from your site. Proper configuration prevents information leakage and protects user privacy.</p>
<p>The test evaluates:</p>
<ul>
<li>Presence of Referrer-Policy header</li>
<li>Policy directive values and their security implications</li>
<li>Multiple policy values and their precedence</li>
<li>Insecure policy configurations</li>
</ul>
<p>Threat level assessment:</p>
<ul>
<li>None (0): Excellent - strict-origin-when-cross-origin, strict-origin, or no-referrer</li>
<li>Info (1): Good - origin-when-cross-origin or origin</li>
<li>Low (2): Acceptable - same-origin</li>
<li>Medium (3): Weak - no-referrer-when-downgrade (default behavior)</li>
<li>High (4): Vulnerable - unsafe-url or missing header with default behavior</li>
</ul>
<p>Security implications:</p>
<ul>
<li>Missing header: Uses browser default (typically no-referrer-when-downgrade)</li>
<li>unsafe-url: Full URL sent as referrer to all origins (including HTTP)</li>
<li>origin/origin-when-cross-origin: May leak origin information unnecessarily</li>
<li>no-referrer: Maximum privacy but may break some functionality</li>
<li>strict-origin-when-cross-origin: Recommended balance of security and functionality</li>
</ul>
<p>Policy values and security levels:</p>
<ul>
<li>no-referrer: Excellent - No referrer information sent</li>
<li>no-referrer-when-downgrade: Medium - Default, leaks info on HTTPSHTTP</li>
<li>origin: Info - Only origin sent, reasonable privacy</li>
<li>origin-when-cross-origin: Info - Full URL for same-origin, origin for cross-origin</li>
<li>same-origin: Low - Full URL for same-origin only</li>
<li>strict-origin: Excellent - Origin only, no referrer on downgrade</li>
<li>strict-origin-when-cross-origin: Excellent - Recommended by W3C</li>
<li>unsafe-url: High - Always sends full URL (insecure)</li>
</ul>
<p>Returns:</p>
<ul>
<li>*ResponseTest: Configured Referrer-Policy test ready for execution</li>
</ul>
<p>Example usage:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-88-1"><a id="__codelineno-88-1" name="__codelineno-88-1" href="#__codelineno-88-1"></a>referrerTest := NewReferrerPolicyTest()
</span><span id="__span-88-2"><a id="__codelineno-88-2" name="__codelineno-88-2" href="#__codelineno-88-2"></a>result := referrerTest.Run(ResponseTestParams{Response: httpResponse})
</span><span id="__span-88-3"><a id="__codelineno-88-3" name="__codelineno-88-3" href="#__codelineno-88-3"></a>// Result includes threat level and detailed policy analysis
</span></code></pre></div>
<p><a name="NewServerHeaderTest"></a></p>
<h3 id="func-newserverheadertest">func NewServerHeaderTest<a class="headerlink" href="#func-newserverheadertest" title="Permanent link">&para;</a></h3>
<div class="language-go highlight"><pre><span></span><code><span id="__span-89-1"><a id="__codelineno-89-1" name="__codelineno-89-1" href="#__codelineno-89-1"></a><span class="kd">func</span><span class="w"> </span><span class="nx">NewServerHeaderTest</span><span class="p">()</span><span class="w"> </span><span class="o">*</span><span class="nx">ResponseTest</span>
</span></code></pre></div>
<p>NewServerHeaderTest creates a new security test that analyzes HTTP response headers for server technology information disclosure vulnerabilities.</p>
<p>This test examines 12 common HTTP headers that frequently expose sensitive information about the server technology stack, frameworks, and hosting infrastructure. It performs technology detection, version extraction, and CVE vulnerability assessment.</p>
<p>Test Workflow:</p>
<ol>
<li>Extract Target Headers: Collect values from 12 predefined headers</li>
<li>Analyze Headers: Identify exposed headers and detect technologies</li>
<li>CVE Assessment: Query NIST NVD for known vulnerabilities</li>
<li>Threat Evaluation: Calculate threat level based on exposure and CVEs</li>
<li>Generate Report: Create human-readable description</li>
</ol>
<p>Detected Technologies:</p>
<p>Web Servers:</p>
<ul>
<li>Apache, Nginx, Microsoft IIS, Cloudflare, Gunicorn, Uvicorn</li>
</ul>
<p>Application Frameworks:</p>
<ul>
<li>Express.js, Django, ASP.NET, PHP, Laravel, Ruby on Rails, Flask, Spring Framework</li>
</ul>
<p>Content Management Systems:</p>
<ul>
<li>Drupal, WordPress</li>
</ul>
<p>Infrastructure:</p>
<ul>
<li>Google PageSpeed, Varnish Cache, Dynamic Runtime</li>
</ul>
<p>Security Impact:</p>
<p>Information disclosure enables:</p>
<ul>
<li>Vulnerability scanning with version-specific exploit databases</li>
<li>Targeted attack preparation based on known weaknesses</li>
<li>Technology stack fingerprinting</li>
<li>Reduced attacker reconnaissance time</li>
</ul>
<p>The test assigns higher threat levels when:</p>
<ul>
<li>Multiple headers expose information (5+ = Medium)</li>
<li>Technologies have known high-severity CVEs (Critical)</li>
<li>Debug/test/dev indicators present (Critical)</li>
<li>Common web servers revealed (High)</li>
</ul>
<p>Certainty:</p>
<p>This test reports 95% certainty as header analysis is highly reliable, but some false positives may occur from customized or obfuscated headers.</p>
<p>Returns:</p>
<ul>
<li>*ResponseTest: Configured test instance ready for execution</li>
</ul>
<p>Example:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-90-1"><a id="__codelineno-90-1" name="__codelineno-90-1" href="#__codelineno-90-1"></a>// Create the server header test
</span><span id="__span-90-2"><a id="__codelineno-90-2" name="__codelineno-90-2" href="#__codelineno-90-2"></a>headerTest := NewServerHeaderTest()
</span><span id="__span-90-3"><a id="__codelineno-90-3" name="__codelineno-90-3" href="#__codelineno-90-3"></a>
</span><span id="__span-90-4"><a id="__codelineno-90-4" name="__codelineno-90-4" href="#__codelineno-90-4"></a>// Execute against target (via Runner)
</span><span id="__span-90-5"><a id="__codelineno-90-5" name="__codelineno-90-5" href="#__codelineno-90-5"></a>params := ResponseTestParams{
</span><span id="__span-90-6"><a id="__codelineno-90-6" name="__codelineno-90-6" href="#__codelineno-90-6"></a>    Response: httpResponse,
</span><span id="__span-90-7"><a id="__codelineno-90-7" name="__codelineno-90-7" href="#__codelineno-90-7"></a>    Url:      &quot;https://example.com&quot;,
</span><span id="__span-90-8"><a id="__codelineno-90-8" name="__codelineno-90-8" href="#__codelineno-90-8"></a>}
</span><span id="__span-90-9"><a id="__codelineno-90-9" name="__codelineno-90-9" href="#__codelineno-90-9"></a>result := headerTest.Run(params)
</span><span id="__span-90-10"><a id="__codelineno-90-10" name="__codelineno-90-10" href="#__codelineno-90-10"></a>
</span><span id="__span-90-11"><a id="__codelineno-90-11" name="__codelineno-90-11" href="#__codelineno-90-11"></a>// No exposure (secure)
</span><span id="__span-90-12"><a id="__codelineno-90-12" name="__codelineno-90-12" href="#__codelineno-90-12"></a>// result.ThreatLevel = None
</span><span id="__span-90-13"><a id="__codelineno-90-13" name="__codelineno-90-13" href="#__codelineno-90-13"></a>// result.Description = &quot;No server technology information disclosed...&quot;
</span><span id="__span-90-14"><a id="__codelineno-90-14" name="__codelineno-90-14" href="#__codelineno-90-14"></a>
</span><span id="__span-90-15"><a id="__codelineno-90-15" name="__codelineno-90-15" href="#__codelineno-90-15"></a>// Multiple exposures (insecure)
</span><span id="__span-90-16"><a id="__codelineno-90-16" name="__codelineno-90-16" href="#__codelineno-90-16"></a>// result.ThreatLevel = High
</span><span id="__span-90-17"><a id="__codelineno-90-17" name="__codelineno-90-17" href="#__codelineno-90-17"></a>// result.Description = &quot;5 headers expose server information. Detected: Apache/2.4.41, PHP/7.4.3...&quot;
</span><span id="__span-90-18"><a id="__codelineno-90-18" name="__codelineno-90-18" href="#__codelineno-90-18"></a>// result.Metadata = ServerHeaderAnalysis{...}
</span></code></pre></div>
<p>CVE Integration Example:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-91-1"><a id="__codelineno-91-1" name="__codelineno-91-1" href="#__codelineno-91-1"></a>// If Apache 2.4.41 is detected and has known CVEs:
</span><span id="__span-91-2"><a id="__codelineno-91-2" name="__codelineno-91-2" href="#__codelineno-91-2"></a>// - Query NVD API for &quot;Apache&quot; vulnerabilities
</span><span id="__span-91-3"><a id="__codelineno-91-3" name="__codelineno-91-3" href="#__codelineno-91-3"></a>// - Assess severity levels (High/Medium/Low)
</span><span id="__span-91-4"><a id="__codelineno-91-4" name="__codelineno-91-4" href="#__codelineno-91-4"></a>// - Elevate threat level to Critical if high-severity CVEs found
</span></code></pre></div>
<p>Related Tests:</p>
<ul>
<li>HTTPSTest: Validates encrypted connections</li>
<li>HSTSTest: Checks HTTP Strict Transport Security enforcement</li>
</ul>
<p><a name="NewXContentTypeOptionsTest"></a></p>
<h3 id="func-newxcontenttypeoptionstest">func NewXContentTypeOptionsTest<a class="headerlink" href="#func-newxcontenttypeoptionstest" title="Permanent link">&para;</a></h3>
<div class="language-go highlight"><pre><span></span><code><span id="__span-92-1"><a id="__codelineno-92-1" name="__codelineno-92-1" href="#__codelineno-92-1"></a><span class="kd">func</span><span class="w"> </span><span class="nx">NewXContentTypeOptionsTest</span><span class="p">()</span><span class="w"> </span><span class="o">*</span><span class="nx">ResponseTest</span>
</span></code></pre></div>
<p>NewXContentTypeOptionsTest creates a new ResponseTest that analyzes X-Content-Type-Options header configuration. The X-Content-Type-Options header prevents browsers from MIME-sniffing a response away from the declared content-type, which helps prevent XSS attacks and other security issues.</p>
<p>The test evaluates:</p>
<ul>
<li>Presence of X-Content-Type-Options header</li>
<li>Correct "nosniff" directive value</li>
<li>Case sensitivity and formatting</li>
</ul>
<p>Threat level assessment:</p>
<ul>
<li>None (0): Excellent - X-Content-Type-Options: nosniff properly configured</li>
<li>High (4): Missing - No header found, vulnerable to MIME sniffing attacks</li>
<li>Medium (3): Invalid - Header present but with incorrect value</li>
</ul>
<p>Security implications:</p>
<ul>
<li>Missing header: Browsers may MIME-sniff content leading to XSS vulnerabilities</li>
<li>Invalid value: Header ignored by browsers, same risk as missing</li>
<li>Correct "nosniff": Prevents MIME type sniffing attacks</li>
</ul>
<p>Returns:</p>
<ul>
<li>*ResponseTest: Configured X-Content-Type-Options test ready for execution</li>
</ul>
<p><a name="NewXFrameTest"></a></p>
<h3 id="func-newxframetest">func NewXFrameTest<a class="headerlink" href="#func-newxframetest" title="Permanent link">&para;</a></h3>
<div class="language-go highlight"><pre><span></span><code><span id="__span-93-1"><a id="__codelineno-93-1" name="__codelineno-93-1" href="#__codelineno-93-1"></a><span class="kd">func</span><span class="w"> </span><span class="nx">NewXFrameTest</span><span class="p">()</span><span class="w"> </span><span class="o">*</span><span class="nx">ResponseTest</span>
</span></code></pre></div>
<p>NewXFrameTest creates a new ResponseTest that analyzes X-Frame-Options header and CSP frame directives to assess clickjacking protection. Clickjacking attacks embed target pages in iframes to trick users into performing unintended actions on the embedded content.</p>
<p>The test evaluates:</p>
<ul>
<li>Presence of X-Frame-Options header (legacy protection)</li>
<li>X-Frame-Options directive values (DENY, SAMEORIGIN, ALLOW-FROM)</li>
<li>Content-Security-Policy frame-ancestors directive (modern protection)</li>
<li>Conflicting or invalid configurations</li>
</ul>
<p>Threat level assessment:</p>
<ul>
<li>None (0): Excellent - CSP frame-ancestors 'none' or X-Frame-Options DENY</li>
<li>Info (1): Good - CSP frame-ancestors 'self' or X-Frame-Options SAMEORIGIN</li>
<li>Low (2): Limited - X-Frame-Options ALLOW-FROM (deprecated and limited browser support)</li>
<li>Medium (3): Weak - Only CSP frame-ancestors with specific domains (partial protection)</li>
<li>High (4): Vulnerable - Missing both X-Frame-Options and CSP frame-ancestors</li>
<li>High (4): Invalid - Present but with invalid/malformed directives</li>
</ul>
<p>Security implications:</p>
<ul>
<li>Missing protection: Vulnerable to clickjacking attacks, UI redressing, and iframe abuse</li>
<li>ALLOW-FROM directive: Deprecated and not supported in modern browsers</li>
<li>Conflicting headers: May lead to inconsistent protection across browsers</li>
<li>Invalid values: Browsers may ignore protection, leaving site vulnerable</li>
</ul>
<p>Standards compliance:</p>
<ul>
<li>X-Frame-Options: RFC 7034 (legacy, but widely supported)</li>
<li>CSP frame-ancestors: CSP Level 2 (modern, preferred approach)</li>
</ul>
<p>Returns:</p>
<ul>
<li>*ResponseTest: Configured X-Frame-Options test ready for execution</li>
</ul>
<p>Example usage:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-94-1"><a id="__codelineno-94-1" name="__codelineno-94-1" href="#__codelineno-94-1"></a>xframeTest := NewXFrameTest()
</span><span id="__span-94-2"><a id="__codelineno-94-2" name="__codelineno-94-2" href="#__codelineno-94-2"></a>result := xframeTest.Run(ResponseTestParams{Response: httpResponse})
</span><span id="__span-94-3"><a id="__codelineno-94-3" name="__codelineno-94-3" href="#__codelineno-94-3"></a>// Result includes threat level and detailed iframe embedding analysis
</span></code></pre></div>
<p><a name="ResponseTest.GetDescription"></a></p>
<h3 id="func-responsetest-getdescription">func (*ResponseTest) GetDescription<a class="headerlink" href="#func-responsetest-getdescription" title="Permanent link">&para;</a></h3>
<div class="language-go highlight"><pre><span></span><code><span id="__span-95-1"><a id="__codelineno-95-1" name="__codelineno-95-1" href="#__codelineno-95-1"></a><span class="kd">func</span><span class="w"> </span><span class="p">(</span><span class="nx">brt</span><span class="w"> </span><span class="o">*</span><span class="nx">ResponseTest</span><span class="p">)</span><span class="w"> </span><span class="nx">GetDescription</span><span class="p">()</span><span class="w"> </span><span class="kt">string</span>
</span></code></pre></div>
<p>GetDescription returns the detailed description of what the test analyzes. This method provides read-only access to the test's purpose and functionality.</p>
<p>Returns:</p>
<ul>
<li>string: The test's detailed description</li>
</ul>
<p><a name="ResponseTest.GetId"></a></p>
<h3 id="func-responsetest-getid">func (*ResponseTest) GetId<a class="headerlink" href="#func-responsetest-getid" title="Permanent link">&para;</a></h3>
<div class="language-go highlight"><pre><span></span><code><span id="__span-96-1"><a id="__codelineno-96-1" name="__codelineno-96-1" href="#__codelineno-96-1"></a><span class="kd">func</span><span class="w"> </span><span class="p">(</span><span class="nx">brt</span><span class="w"> </span><span class="o">*</span><span class="nx">ResponseTest</span><span class="p">)</span><span class="w"> </span><span class="nx">GetId</span><span class="p">()</span><span class="w"> </span><span class="kt">string</span>
</span></code></pre></div>
<p>GetId returns the unique identifier of the test used for registration and lookup. This method provides read-only access to the test's ID.</p>
<p>Returns:</p>
<ul>
<li>string: The test's unique identifier</li>
</ul>
<p><a name="ResponseTest.GetName"></a></p>
<h3 id="func-responsetest-getname">func (*ResponseTest) GetName<a class="headerlink" href="#func-responsetest-getname" title="Permanent link">&para;</a></h3>
<div class="language-go highlight"><pre><span></span><code><span id="__span-97-1"><a id="__codelineno-97-1" name="__codelineno-97-1" href="#__codelineno-97-1"></a><span class="kd">func</span><span class="w"> </span><span class="p">(</span><span class="nx">brt</span><span class="w"> </span><span class="o">*</span><span class="nx">ResponseTest</span><span class="p">)</span><span class="w"> </span><span class="nx">GetName</span><span class="p">()</span><span class="w"> </span><span class="kt">string</span>
</span></code></pre></div>
<p>GetName returns the human-readable name of the test for display purposes. This method provides read-only access to the test's display name.</p>
<p>Returns:</p>
<ul>
<li>string: The test's display name</li>
</ul>
<p><a name="ResponseTest.Run"></a></p>
<h3 id="func-responsetest-run">func (*ResponseTest) Run<a class="headerlink" href="#func-responsetest-run" title="Permanent link">&para;</a></h3>
<div class="language-go highlight"><pre><span></span><code><span id="__span-98-1"><a id="__codelineno-98-1" name="__codelineno-98-1" href="#__codelineno-98-1"></a><span class="kd">func</span><span class="w"> </span><span class="p">(</span><span class="nx">rt</span><span class="w"> </span><span class="o">*</span><span class="nx">ResponseTest</span><span class="p">)</span><span class="w"> </span><span class="nx">Run</span><span class="p">(</span><span class="nx">params</span><span class="w"> </span><span class="nx">ResponseTestParams</span><span class="p">)</span><span class="w"> </span><span class="nx">TestResult</span>
</span></code></pre></div>
<p>Run executes the test logic against the provided HTTP response parameters and returns the security analysis results. This is the main entry point for test execution.</p>
<p>The method validates that RunTest is implemented before execution and panics if not, ensuring tests are properly configured before use.</p>
<p>Parameters:</p>
<ul>
<li>params: ResponseTestParams containing the HTTP response to analyze</li>
</ul>
<p>Returns:</p>
<ul>
<li>TestResult: Structured results including threat level and findings</li>
</ul>
<p>Panics:</p>
<ul>
<li>string: "Run method not implemented" if RunTest function is nil</li>
</ul>
<p>Example:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-99-1"><a id="__codelineno-99-1" name="__codelineno-99-1" href="#__codelineno-99-1"></a>test := NewHTTPSTest()
</span><span id="__span-99-2"><a id="__codelineno-99-2" name="__codelineno-99-2" href="#__codelineno-99-2"></a>params := ResponseTestParams{Response: httpResponse}
</span><span id="__span-99-3"><a id="__codelineno-99-3" name="__codelineno-99-3" href="#__codelineno-99-3"></a>result := test.Run(params)
</span><span id="__span-99-4"><a id="__codelineno-99-4" name="__codelineno-99-4" href="#__codelineno-99-4"></a>fmt.Printf(&quot;Threat Level: %v\n&quot;, result.ThreatLevel)
</span></code></pre></div>
<p><a name="ResponseTestParams"></a></p>
<h2 id="type-responsetestparams">type ResponseTestParams<a class="headerlink" href="#type-responsetestparams" title="Permanent link">&para;</a></h2>
<p>ResponseTestParams encapsulates the parameters passed to a ResponseTest for execution. It provides the HTTP response object that tests analyze to detect security issues, misconfigurations, and vulnerabilities.</p>
<p>The structure enables:</p>
<ul>
<li>Clean test interface with extensibility</li>
<li>Sharing of HTTP response across multiple tests</li>
<li>Future addition of context or configuration parameters</li>
</ul>
<p>The Response object contains:</p>
<ul>
<li>HTTP headers (security headers, server information, etc.)</li>
<li>Status code</li>
<li>Request details (URL, method, original request)</li>
<li>Body content (if read by test)</li>
</ul>
<div class="language-go highlight"><pre><span></span><code><span id="__span-100-1"><a id="__codelineno-100-1" name="__codelineno-100-1" href="#__codelineno-100-1"></a><span class="kd">type</span><span class="w"> </span><span class="nx">ResponseTestParams</span><span class="w"> </span><span class="kd">struct</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-100-2"><a id="__codelineno-100-2" name="__codelineno-100-2" href="#__codelineno-100-2"></a><span class="w">    </span><span class="nx">Response</span><span class="w"> </span><span class="o">*</span><span class="nx">http</span><span class="p">.</span><span class="nx">Response</span><span class="w"> </span><span class="c1">// HTTP response to analyze for security issues</span>
</span><span id="__span-100-3"><a id="__codelineno-100-3" name="__codelineno-100-3" href="#__codelineno-100-3"></a><span class="p">}</span>
</span></code></pre></div>
<p><a name="ServerHeaderAnalysis"></a></p>
<h2 id="type-serverheaderanalysis">type ServerHeaderAnalysis<a class="headerlink" href="#type-serverheaderanalysis" title="Permanent link">&para;</a></h2>
<p>ServerHeaderAnalysis represents the comprehensive analysis results of HTTP headers for server technology information disclosure.</p>
<p>This structure aggregates data about exposed headers, detected technologies, and their potential security implications. It serves as metadata for test results and provides detailed insights for security reporting.</p>
<p>Fields:</p>
<ul>
<li>exposed_headers: List of header names that revealed information</li>
<li>technologies: Detected technology stack components (deduplicated)</li>
<li>total_exposures: Count of headers exposing information</li>
<li>header_details: Map of header names to their actual values</li>
<li>technology_stack: Map of detected technologies to their versions</li>
</ul>
<p>Example structure:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-101-1"><a id="__codelineno-101-1" name="__codelineno-101-1" href="#__codelineno-101-1"></a>{
</span><span id="__span-101-2"><a id="__codelineno-101-2" name="__codelineno-101-2" href="#__codelineno-101-2"></a>    exposed_headers: [&quot;Server&quot;, &quot;X-Powered-By&quot;],
</span><span id="__span-101-3"><a id="__codelineno-101-3" name="__codelineno-101-3" href="#__codelineno-101-3"></a>    technologies: [&quot;Nginx&quot;, &quot;PHP&quot;],
</span><span id="__span-101-4"><a id="__codelineno-101-4" name="__codelineno-101-4" href="#__codelineno-101-4"></a>    total_exposures: 2,
</span><span id="__span-101-5"><a id="__codelineno-101-5" name="__codelineno-101-5" href="#__codelineno-101-5"></a>    header_details: {
</span><span id="__span-101-6"><a id="__codelineno-101-6" name="__codelineno-101-6" href="#__codelineno-101-6"></a>        &quot;Server&quot;: &quot;nginx/1.18.0&quot;,
</span><span id="__span-101-7"><a id="__codelineno-101-7" name="__codelineno-101-7" href="#__codelineno-101-7"></a>        &quot;X-Powered-By&quot;: &quot;PHP/7.4.3&quot;
</span><span id="__span-101-8"><a id="__codelineno-101-8" name="__codelineno-101-8" href="#__codelineno-101-8"></a>    },
</span><span id="__span-101-9"><a id="__codelineno-101-9" name="__codelineno-101-9" href="#__codelineno-101-9"></a>    technology_stack: {
</span><span id="__span-101-10"><a id="__codelineno-101-10" name="__codelineno-101-10" href="#__codelineno-101-10"></a>        &quot;Nginx&quot;: &quot;1.18.0&quot;,
</span><span id="__span-101-11"><a id="__codelineno-101-11" name="__codelineno-101-11" href="#__codelineno-101-11"></a>        &quot;PHP&quot;: &quot;7.4.3&quot;
</span><span id="__span-101-12"><a id="__codelineno-101-12" name="__codelineno-101-12" href="#__codelineno-101-12"></a>    }
</span><span id="__span-101-13"><a id="__codelineno-101-13" name="__codelineno-101-13" href="#__codelineno-101-13"></a>}
</span></code></pre></div>
<div class="language-go highlight"><pre><span></span><code><span id="__span-102-1"><a id="__codelineno-102-1" name="__codelineno-102-1" href="#__codelineno-102-1"></a><span class="kd">type</span><span class="w"> </span><span class="nx">ServerHeaderAnalysis</span><span class="w"> </span><span class="kd">struct</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-102-2"><a id="__codelineno-102-2" name="__codelineno-102-2" href="#__codelineno-102-2"></a><span class="w">    </span><span class="nx">exposed_headers</span><span class="w">  </span><span class="p">[]</span><span class="kt">string</span>
</span><span id="__span-102-3"><a id="__codelineno-102-3" name="__codelineno-102-3" href="#__codelineno-102-3"></a><span class="w">    </span><span class="nx">technologies</span><span class="w">     </span><span class="p">[]</span><span class="kt">string</span>
</span><span id="__span-102-4"><a id="__codelineno-102-4" name="__codelineno-102-4" href="#__codelineno-102-4"></a><span class="w">    </span><span class="nx">total_exposures</span><span class="w">  </span><span class="kt">int</span>
</span><span id="__span-102-5"><a id="__codelineno-102-5" name="__codelineno-102-5" href="#__codelineno-102-5"></a><span class="w">    </span><span class="nx">header_details</span><span class="w">   </span><span class="kd">map</span><span class="p">[</span><span class="kt">string</span><span class="p">]</span><span class="kt">string</span>
</span><span id="__span-102-6"><a id="__codelineno-102-6" name="__codelineno-102-6" href="#__codelineno-102-6"></a><span class="w">    </span><span class="nx">technology_stack</span><span class="w"> </span><span class="kd">map</span><span class="p">[</span><span class="kt">string</span><span class="p">]</span><span class="kt">string</span>
</span><span id="__span-102-7"><a id="__codelineno-102-7" name="__codelineno-102-7" href="#__codelineno-102-7"></a><span class="p">}</span>
</span></code></pre></div>
<p><a name="analyzeServerHeaders"></a></p>
<h3 id="func-analyzeserverheaders">func analyzeServerHeaders<a class="headerlink" href="#func-analyzeserverheaders" title="Permanent link">&para;</a></h3>
<div class="language-go highlight"><pre><span></span><code><span id="__span-103-1"><a id="__codelineno-103-1" name="__codelineno-103-1" href="#__codelineno-103-1"></a><span class="kd">func</span><span class="w"> </span><span class="nx">analyzeServerHeaders</span><span class="p">(</span><span class="nx">headers</span><span class="w"> </span><span class="kd">map</span><span class="p">[</span><span class="kt">string</span><span class="p">]</span><span class="kt">string</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="nx">ServerHeaderAnalysis</span>
</span></code></pre></div>
<p>analyzeServerHeaders examines HTTP headers for technology disclosure patterns and constructs a comprehensive analysis of exposed information.</p>
<p>This function processes the collected headers to identify:</p>
<ul>
<li>Which headers expose information</li>
<li>What technologies are revealed</li>
<li>Version information when available</li>
<li>Overall exposure count</li>
</ul>
<p>The analysis involves:</p>
<ol>
<li>Filtering out empty headers</li>
<li>Recording exposed header names</li>
<li>Detecting technologies from header values</li>
<li>Extracting version information</li>
<li>Building technology stack mapping</li>
<li>Deduplicating technology entries</li>
</ol>
<p>Technology Detection:</p>
<p>For each non-empty header, the function calls detectTechnologies() which uses pattern matching to identify specific software, frameworks, and services.</p>
<p>Parameters:</p>
<ul>
<li>headers: Map of header names to their values from HTTP response</li>
</ul>
<p>Returns:</p>
<ul>
<li>*ServerHeaderAnalysis: Comprehensive analysis structure with:</li>
<li>exposed_headers: List of header names containing information</li>
<li>technologies: Deduplicated list of detected technologies</li>
<li>total_exposures: Count of exposed headers</li>
<li>header_details: Original header name-value pairs</li>
<li>technology_stack: Technology-to-version mapping</li>
</ul>
<p>Example:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-104-1"><a id="__codelineno-104-1" name="__codelineno-104-1" href="#__codelineno-104-1"></a>headers := map[string]string{
</span><span id="__span-104-2"><a id="__codelineno-104-2" name="__codelineno-104-2" href="#__codelineno-104-2"></a>    &quot;Server&quot;: &quot;nginx/1.18.0&quot;,
</span><span id="__span-104-3"><a id="__codelineno-104-3" name="__codelineno-104-3" href="#__codelineno-104-3"></a>    &quot;X-Powered-By&quot;: &quot;PHP/7.4.3&quot;,
</span><span id="__span-104-4"><a id="__codelineno-104-4" name="__codelineno-104-4" href="#__codelineno-104-4"></a>    &quot;X-Cache&quot;: &quot;&quot;,  // Empty, will be filtered
</span><span id="__span-104-5"><a id="__codelineno-104-5" name="__codelineno-104-5" href="#__codelineno-104-5"></a>}
</span><span id="__span-104-6"><a id="__codelineno-104-6" name="__codelineno-104-6" href="#__codelineno-104-6"></a>
</span><span id="__span-104-7"><a id="__codelineno-104-7" name="__codelineno-104-7" href="#__codelineno-104-7"></a>analysis := analyzeServerHeaders(headers)
</span><span id="__span-104-8"><a id="__codelineno-104-8" name="__codelineno-104-8" href="#__codelineno-104-8"></a>// analysis.exposed_headers = [&quot;Server&quot;, &quot;X-Powered-By&quot;]
</span><span id="__span-104-9"><a id="__codelineno-104-9" name="__codelineno-104-9" href="#__codelineno-104-9"></a>// analysis.technologies = [&quot;Nginx&quot;, &quot;PHP&quot;]
</span><span id="__span-104-10"><a id="__codelineno-104-10" name="__codelineno-104-10" href="#__codelineno-104-10"></a>// analysis.total_exposures = 2
</span><span id="__span-104-11"><a id="__codelineno-104-11" name="__codelineno-104-11" href="#__codelineno-104-11"></a>// analysis.technology_stack = {&quot;Nginx&quot;: &quot;1.18.0&quot;, &quot;PHP&quot;: &quot;7.4.3&quot;}
</span></code></pre></div>
<p><a name="TestResult"></a></p>
<h2 id="type-testresult">type TestResult<a class="headerlink" href="#type-testresult" title="Permanent link">&para;</a></h2>
<p>TestResult represents the comprehensive output of a security test execution. It encapsulates all information about the test findings including classification, confidence level, detailed metadata, and human-readable descriptions.</p>
<p>The structure is designed for:</p>
<ul>
<li>JSON serialization for API reporting</li>
<li>Human-readable console output</li>
<li>Automated processing and aggregation</li>
<li>Detailed forensic analysis</li>
</ul>
<p>Fields provide multiple levels of detail:</p>
<ul>
<li>Name: Test identifier for categorization</li>
<li>Certainty: Confidence percentage (0-100) in the finding</li>
<li>ThreatLevel: Security classification (None to Critical)</li>
<li>Metadata: Test-specific data (headers, configurations, CVEs, etc.)</li>
<li>Description: Human-readable explanation of findings</li>
</ul>
<div class="language-go highlight"><pre><span></span><code><span id="__span-105-1"><a id="__codelineno-105-1" name="__codelineno-105-1" href="#__codelineno-105-1"></a><span class="kd">type</span><span class="w"> </span><span class="nx">TestResult</span><span class="w"> </span><span class="kd">struct</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-105-2"><a id="__codelineno-105-2" name="__codelineno-105-2" href="#__codelineno-105-2"></a><span class="w">    </span><span class="nx">Name</span><span class="w">        </span><span class="kt">string</span><span class="w">      </span><span class="s">`json:&quot;Name&quot;`</span><span class="w">        </span><span class="c1">// Test name for identification</span>
</span><span id="__span-105-3"><a id="__codelineno-105-3" name="__codelineno-105-3" href="#__codelineno-105-3"></a><span class="w">    </span><span class="nx">Certainty</span><span class="w">   </span><span class="kt">int</span><span class="w">         </span><span class="s">`json:&quot;Certainty&quot;`</span><span class="w">   </span><span class="c1">// Confidence percentage (0-100)</span>
</span><span id="__span-105-4"><a id="__codelineno-105-4" name="__codelineno-105-4" href="#__codelineno-105-4"></a><span class="w">    </span><span class="nx">ThreatLevel</span><span class="w"> </span><span class="nx">ThreatLevel</span><span class="w"> </span><span class="s">`json:&quot;ThreatLevel&quot;`</span><span class="w"> </span><span class="c1">// Security threat classification</span>
</span><span id="__span-105-5"><a id="__codelineno-105-5" name="__codelineno-105-5" href="#__codelineno-105-5"></a><span class="w">    </span><span class="nx">Metadata</span><span class="w">    </span><span class="kt">any</span><span class="w">         </span><span class="s">`json:&quot;Metadata&quot;`</span><span class="w">    </span><span class="c1">// Test-specific detailed data</span>
</span><span id="__span-105-6"><a id="__codelineno-105-6" name="__codelineno-105-6" href="#__codelineno-105-6"></a><span class="w">    </span><span class="nx">Description</span><span class="w"> </span><span class="kt">string</span><span class="w">      </span><span class="s">`json:&quot;Description&quot;`</span><span class="w"> </span><span class="c1">// Human-readable findings explanation</span>
</span><span id="__span-105-7"><a id="__codelineno-105-7" name="__codelineno-105-7" href="#__codelineno-105-7"></a><span class="p">}</span>
</span></code></pre></div>
<p><a name="TestResultWrapper"></a></p>
<h2 id="type-testresultwrapper">type TestResultWrapper<a class="headerlink" href="#type-testresultwrapper" title="Permanent link">&para;</a></h2>
<p>TestResultWrapper represents fully structured response sent to the backend Fields:</p>
<ul>
<li>Target: Given target</li>
<li>TestId: id related to full scan</li>
<li>Result: Core data of test</li>
<li>EndFlag: Check if engine finished its job</li>
</ul>
<div class="language-go highlight"><pre><span></span><code><span id="__span-106-1"><a id="__codelineno-106-1" name="__codelineno-106-1" href="#__codelineno-106-1"></a><span class="kd">type</span><span class="w"> </span><span class="nx">TestResultWrapper</span><span class="w"> </span><span class="kd">struct</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-106-2"><a id="__codelineno-106-2" name="__codelineno-106-2" href="#__codelineno-106-2"></a><span class="w">    </span><span class="nx">Target</span><span class="w">  </span><span class="kt">string</span><span class="w">     </span><span class="s">`json:&quot;target&quot;`</span>
</span><span id="__span-106-3"><a id="__codelineno-106-3" name="__codelineno-106-3" href="#__codelineno-106-3"></a><span class="w">    </span><span class="nx">TestId</span><span class="w">  </span><span class="kt">string</span><span class="w">     </span><span class="s">`json:&quot;testId&quot;`</span>
</span><span id="__span-106-4"><a id="__codelineno-106-4" name="__codelineno-106-4" href="#__codelineno-106-4"></a><span class="w">    </span><span class="nx">Result</span><span class="w">  </span><span class="nx">TestResult</span><span class="w"> </span><span class="s">`json:&quot;result&quot;`</span>
</span><span id="__span-106-5"><a id="__codelineno-106-5" name="__codelineno-106-5" href="#__codelineno-106-5"></a><span class="w">    </span><span class="nx">EndFlag</span><span class="w"> </span><span class="kt">bool</span><span class="w">       </span><span class="s">`json:&quot;endFlag&quot;`</span>
</span><span id="__span-106-6"><a id="__codelineno-106-6" name="__codelineno-106-6" href="#__codelineno-106-6"></a><span class="p">}</span>
</span></code></pre></div>
<p><a name="ThreatLevel"></a></p>
<h2 id="type-threatlevel">type ThreatLevel<a class="headerlink" href="#type-threatlevel" title="Permanent link">&para;</a></h2>
<p>ThreatLevel represents the security threat classification for test results. It provides a standardized scale from None (no threat) to Critical (severe vulnerability) aligned with industry security standards and risk assessment frameworks.</p>
<p>The enumeration enables:</p>
<ul>
<li>Consistent threat classification across all tests</li>
<li>Priority-based vulnerability triage</li>
<li>Risk-based decision making</li>
<li>Compliance with security reporting standards</li>
</ul>
<div class="language-go highlight"><pre><span></span><code><span id="__span-107-1"><a id="__codelineno-107-1" name="__codelineno-107-1" href="#__codelineno-107-1"></a><span class="kd">type</span><span class="w"> </span><span class="nx">ThreatLevel</span><span class="w"> </span><span class="kt">int</span>
</span></code></pre></div>
<p><a name="None"></a>ThreatLevel enumeration constants representing increasing levels of security concern. These levels align with CVSS severity ratings and common security frameworks.</p>
<p>Level definitions:</p>
<ul>
<li>None (0): No security issues detected, configuration meets best practices</li>
<li>Info (1): Informational findings, no immediate security impact</li>
<li>Low (2): Minor security issues with low exploitability or impact</li>
<li>Medium (3): Moderate security concerns requiring attention</li>
<li>High (4): Serious vulnerabilities with significant security impact</li>
<li>Critical (5): Severe vulnerabilities requiring immediate remediation</li>
</ul>
<div class="language-go highlight"><pre><span></span><code><span id="__span-108-1"><a id="__codelineno-108-1" name="__codelineno-108-1" href="#__codelineno-108-1"></a><span class="kd">const</span><span class="w"> </span><span class="p">(</span>
</span><span id="__span-108-2"><a id="__codelineno-108-2" name="__codelineno-108-2" href="#__codelineno-108-2"></a><span class="w">    </span><span class="nx">None</span><span class="w">     </span><span class="nx">ThreatLevel</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="kc">iota</span><span class="w"> </span><span class="c1">// 0 - No security issues</span>
</span><span id="__span-108-3"><a id="__codelineno-108-3" name="__codelineno-108-3" href="#__codelineno-108-3"></a><span class="w">    </span><span class="nx">Info</span><span class="w">                        </span><span class="c1">// 1 - Informational findings</span>
</span><span id="__span-108-4"><a id="__codelineno-108-4" name="__codelineno-108-4" href="#__codelineno-108-4"></a><span class="w">    </span><span class="nx">Low</span><span class="w">                         </span><span class="c1">// 2 - Low severity issues</span>
</span><span id="__span-108-5"><a id="__codelineno-108-5" name="__codelineno-108-5" href="#__codelineno-108-5"></a><span class="w">    </span><span class="nx">Medium</span><span class="w">                      </span><span class="c1">// 3 - Medium severity issues</span>
</span><span id="__span-108-6"><a id="__codelineno-108-6" name="__codelineno-108-6" href="#__codelineno-108-6"></a><span class="w">    </span><span class="nx">High</span><span class="w">                        </span><span class="c1">// 4 - High severity vulnerabilities</span>
</span><span id="__span-108-7"><a id="__codelineno-108-7" name="__codelineno-108-7" href="#__codelineno-108-7"></a><span class="w">    </span><span class="nx">Critical</span><span class="w">                    </span><span class="c1">// 5 - Critical vulnerabilities</span>
</span><span id="__span-108-8"><a id="__codelineno-108-8" name="__codelineno-108-8" href="#__codelineno-108-8"></a><span class="p">)</span>
</span></code></pre></div>
<p><a name="evaluateCSPThreatLevel"></a></p>
<h3 id="func-evaluatecspthreatlevel">func evaluateCSPThreatLevel<a class="headerlink" href="#func-evaluatecspthreatlevel" title="Permanent link">&para;</a></h3>
<div class="language-go highlight"><pre><span></span><code><span id="__span-109-1"><a id="__codelineno-109-1" name="__codelineno-109-1" href="#__codelineno-109-1"></a><span class="kd">func</span><span class="w"> </span><span class="nx">evaluateCSPThreatLevel</span><span class="p">(</span><span class="nx">analysis</span><span class="w"> </span><span class="nx">CSPAnalysis</span><span class="p">)</span><span class="w"> </span><span class="nx">ThreatLevel</span>
</span></code></pre></div>
<p>evaluateCSPThreatLevel determines the threat level based on CSP analysis</p>
<p><a name="evaluateCookieThreatLevel"></a></p>
<h3 id="func-evaluatecookiethreatlevel">func evaluateCookieThreatLevel<a class="headerlink" href="#func-evaluatecookiethreatlevel" title="Permanent link">&para;</a></h3>
<div class="language-go highlight"><pre><span></span><code><span id="__span-110-1"><a id="__codelineno-110-1" name="__codelineno-110-1" href="#__codelineno-110-1"></a><span class="kd">func</span><span class="w"> </span><span class="nx">evaluateCookieThreatLevel</span><span class="p">(</span><span class="nx">analysis</span><span class="w"> </span><span class="nx">CookieSecurityAnalysis</span><span class="p">)</span><span class="w"> </span><span class="nx">ThreatLevel</span>
</span></code></pre></div>
<p>evaluateCookieThreatLevel determines threat level based on analysis</p>
<p><a name="evaluateCrossOriginThreatLevel"></a></p>
<h3 id="func-evaluatecrossoriginthreatlevel">func evaluateCrossOriginThreatLevel<a class="headerlink" href="#func-evaluatecrossoriginthreatlevel" title="Permanent link">&para;</a></h3>
<div class="language-go highlight"><pre><span></span><code><span id="__span-111-1"><a id="__codelineno-111-1" name="__codelineno-111-1" href="#__codelineno-111-1"></a><span class="kd">func</span><span class="w"> </span><span class="nx">evaluateCrossOriginThreatLevel</span><span class="p">(</span><span class="nx">metadata</span><span class="w"> </span><span class="kd">map</span><span class="p">[</span><span class="kt">string</span><span class="p">]</span><span class="kd">interface</span><span class="p">{})</span><span class="w"> </span><span class="nx">ThreatLevel</span>
</span></code></pre></div>
<p>evaluateCrossOriginThreatLevel determines the security threat level based on cross-origin headers configuration and their security implications.</p>
<p>Parameters:</p>
<ul>
<li>metadata: Analyzed cross-origin headers metadata</li>
</ul>
<p>Returns:</p>
<ul>
<li>ThreatLevel: Security threat level based on configuration</li>
</ul>
<p><a name="evaluateHSTSThreatLevel"></a></p>
<h3 id="func-evaluatehststhreatlevel">func evaluateHSTSThreatLevel<a class="headerlink" href="#func-evaluatehststhreatlevel" title="Permanent link">&para;</a></h3>
<div class="language-go highlight"><pre><span></span><code><span id="__span-112-1"><a id="__codelineno-112-1" name="__codelineno-112-1" href="#__codelineno-112-1"></a><span class="kd">func</span><span class="w"> </span><span class="nx">evaluateHSTSThreatLevel</span><span class="p">(</span><span class="nx">metadata</span><span class="w"> </span><span class="kd">map</span><span class="p">[</span><span class="kt">string</span><span class="p">]</span><span class="kd">interface</span><span class="p">{})</span><span class="w"> </span><span class="nx">ThreatLevel</span>
</span></code></pre></div>
<p>evaluateHSTSThreatLevel determines the security threat level based on HSTS configuration quality. It applies industry best practices and security standards to classify the HSTS implementation strength.</p>
<p>Threat level classification:</p>
<ul>
<li>
<p>None (0): Excellent configuration</p>
</li>
<li>
<p>max-age  1 year (31,536,000 seconds)</p>
</li>
<li>
<p>includeSubDomains present</p>
</li>
<li>
<p>preload present</p>
</li>
<li>
<p>Meets HSTS preload list requirements</p>
</li>
<li>
<p>Maximum protection against protocol downgrade attacks</p>
</li>
<li>
<p>Info (1): Good configuration</p>
</li>
<li>
<p>max-age  1 year</p>
</li>
<li>
<p>includeSubDomains present</p>
</li>
<li>
<p>Strong protection, but not preload-eligible</p>
</li>
<li>
<p>Low (2): Acceptable configuration</p>
</li>
<li>
<p>max-age  6 months (15,552,000 seconds)</p>
</li>
<li>
<p>Provides reasonable protection</p>
</li>
<li>
<p>Should consider increasing max-age</p>
</li>
<li>
<p>Medium (3): Weak configuration</p>
</li>
<li>
<p>max-age present but \&lt; 6 months</p>
</li>
<li>
<p>Limited protection window</p>
</li>
<li>
<p>Requires frequent policy refreshes</p>
</li>
<li>
<p>Vulnerable during gaps</p>
</li>
<li>
<p>High (4): Invalid or critically weak</p>
</li>
<li>
<p>max-age = 0 or missing</p>
</li>
<li>
<p>HSTS effectively disabled</p>
</li>
<li>
<p>No protection against protocol downgrades</p>
</li>
</ul>
<p>Security standards reference:</p>
<ul>
<li>OWASP recommends minimum max-age of 1 year</li>
<li>HSTS preload list requires: max-age  1 year + includeSubDomains + preload</li>
<li>RFC 6797 specifies HSTS behavior and directives</li>
</ul>
<p>Parameters:</p>
<ul>
<li>metadata: Parsed HSTS header metadata from analyzeHSTSHeader</li>
</ul>
<p>Returns:</p>
<ul>
<li>ThreatLevel: Security classification (None, Info, Low, Medium, or High)</li>
</ul>
<p>Example:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-113-1"><a id="__codelineno-113-1" name="__codelineno-113-1" href="#__codelineno-113-1"></a>metadata := map[string]interface{}{
</span><span id="__span-113-2"><a id="__codelineno-113-2" name="__codelineno-113-2" href="#__codelineno-113-2"></a>    &quot;max_age&quot;: 31536000,
</span><span id="__span-113-3"><a id="__codelineno-113-3" name="__codelineno-113-3" href="#__codelineno-113-3"></a>    &quot;include_subdomains&quot;: true,
</span><span id="__span-113-4"><a id="__codelineno-113-4" name="__codelineno-113-4" href="#__codelineno-113-4"></a>    &quot;preload&quot;: true,
</span><span id="__span-113-5"><a id="__codelineno-113-5" name="__codelineno-113-5" href="#__codelineno-113-5"></a>}
</span><span id="__span-113-6"><a id="__codelineno-113-6" name="__codelineno-113-6" href="#__codelineno-113-6"></a>level := evaluateHSTSThreatLevel(metadata)  // Returns: None (Excellent)
</span></code></pre></div>
<p><a name="evaluateObfuscationThreat"></a></p>
<h3 id="func-evaluateobfuscationthreat">func evaluateObfuscationThreat<a class="headerlink" href="#func-evaluateobfuscationthreat" title="Permanent link">&para;</a></h3>
<div class="language-go highlight"><pre><span></span><code><span id="__span-114-1"><a id="__codelineno-114-1" name="__codelineno-114-1" href="#__codelineno-114-1"></a><span class="kd">func</span><span class="w"> </span><span class="nx">evaluateObfuscationThreat</span><span class="p">(</span><span class="nx">analysis</span><span class="w"> </span><span class="nx">JSObfuscationAnalysis</span><span class="p">)</span><span class="w"> </span><span class="nx">ThreatLevel</span>
</span></code></pre></div>
<p>evaluateObfuscationThreat determines threat level</p>
<p><a name="evaluatePermissionsPolicyThreatLevel"></a></p>
<h3 id="func-evaluatepermissionspolicythreatlevel">func evaluatePermissionsPolicyThreatLevel<a class="headerlink" href="#func-evaluatepermissionspolicythreatlevel" title="Permanent link">&para;</a></h3>
<div class="language-go highlight"><pre><span></span><code><span id="__span-115-1"><a id="__codelineno-115-1" name="__codelineno-115-1" href="#__codelineno-115-1"></a><span class="kd">func</span><span class="w"> </span><span class="nx">evaluatePermissionsPolicyThreatLevel</span><span class="p">(</span><span class="nx">metadata</span><span class="w"> </span><span class="kd">map</span><span class="p">[</span><span class="kt">string</span><span class="p">]</span><span class="kd">interface</span><span class="p">{})</span><span class="w"> </span><span class="nx">ThreatLevel</span>
</span></code></pre></div>
<p>evaluatePermissionsPolicyThreatLevel determines the security threat level based on Permissions-Policy configuration.</p>
<p><a name="evaluateReferrerPolicyThreatLevel"></a></p>
<h3 id="func-evaluatereferrerpolicythreatlevel">func evaluateReferrerPolicyThreatLevel<a class="headerlink" href="#func-evaluatereferrerpolicythreatlevel" title="Permanent link">&para;</a></h3>
<div class="language-go highlight"><pre><span></span><code><span id="__span-116-1"><a id="__codelineno-116-1" name="__codelineno-116-1" href="#__codelineno-116-1"></a><span class="kd">func</span><span class="w"> </span><span class="nx">evaluateReferrerPolicyThreatLevel</span><span class="p">(</span><span class="nx">metadata</span><span class="w"> </span><span class="kd">map</span><span class="p">[</span><span class="kt">string</span><span class="p">]</span><span class="kd">interface</span><span class="p">{})</span><span class="w"> </span><span class="nx">ThreatLevel</span>
</span></code></pre></div>
<p>evaluateReferrerPolicyThreatLevel determines the security threat level based on Referrer-Policy configuration quality. It applies privacy and security best practices to classify the referrer policy implementation strength.</p>
<p>Threat level classification:</p>
<ul>
<li>
<p>None (0): Excellent configuration</p>
</li>
<li>
<p>strict-origin-when-cross-origin (W3C recommended)</p>
</li>
<li>
<p>strict-origin (strong privacy)</p>
</li>
<li>
<p>no-referrer (maximum privacy)</p>
</li>
<li>
<p>Info (1): Good configuration</p>
</li>
<li>
<p>origin-when-cross-origin (reasonable balance)</p>
</li>
<li>
<p>origin (basic privacy protection)</p>
</li>
<li>
<p>Low (2): Acceptable configuration</p>
</li>
<li>
<p>same-origin (limited privacy protection)</p>
</li>
<li>
<p>Medium (3): Weak configuration</p>
</li>
<li>
<p>no-referrer-when-downgrade (browser default)</p>
</li>
<li>
<p>Multiple conflicting policies</p>
</li>
<li>
<p>Configurations relying solely on browser default behavior</p>
</li>
<li>
<p>High (4): Vulnerable configuration</p>
</li>
<li>
<p>unsafe-url (always sends full URL)</p>
</li>
<li>
<p>Invalid/unrecognized policies only</p>
</li>
<li>
<p>Malformed header</p>
</li>
</ul>
<p>The assessment considers:</p>
<ul>
<li>Privacy protection level</li>
<li>Information leakage potential</li>
<li>Cross-origin data exposure</li>
<li>Protocol downgrade behavior</li>
<li>Policy conflicts and precedence</li>
</ul>
<p>Parameters:</p>
<ul>
<li>metadata: Parsed referrer policy metadata from analyzeReferrerPolicyHeader</li>
</ul>
<p>Returns:</p>
<ul>
<li>ThreatLevel: Security classification (None, Info, Low, Medium, or High)</li>
</ul>
<p>Example:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-117-1"><a id="__codelineno-117-1" name="__codelineno-117-1" href="#__codelineno-117-1"></a>metadata := map[string]interface{}{
</span><span id="__span-117-2"><a id="__codelineno-117-2" name="__codelineno-117-2" href="#__codelineno-117-2"></a>    &quot;effective_policy&quot;: &quot;strict-origin-when-cross-origin&quot;,
</span><span id="__span-117-3"><a id="__codelineno-117-3" name="__codelineno-117-3" href="#__codelineno-117-3"></a>    &quot;has_unsafe&quot;: false,
</span><span id="__span-117-4"><a id="__codelineno-117-4" name="__codelineno-117-4" href="#__codelineno-117-4"></a>}
</span><span id="__span-117-5"><a id="__codelineno-117-5" name="__codelineno-117-5" href="#__codelineno-117-5"></a>level := evaluateReferrerPolicyThreatLevel(metadata)
</span><span id="__span-117-6"><a id="__codelineno-117-6" name="__codelineno-117-6" href="#__codelineno-117-6"></a>// Returns: None (excellent configuration)
</span></code></pre></div>
<p><a name="evaluateServerExposureThreatLevel"></a></p>
<h3 id="func-evaluateserverexposurethreatlevel">func evaluateServerExposureThreatLevel<a class="headerlink" href="#func-evaluateserverexposurethreatlevel" title="Permanent link">&para;</a></h3>
<div class="language-go highlight"><pre><span></span><code><span id="__span-118-1"><a id="__codelineno-118-1" name="__codelineno-118-1" href="#__codelineno-118-1"></a><span class="kd">func</span><span class="w"> </span><span class="nx">evaluateServerExposureThreatLevel</span><span class="p">(</span><span class="nx">analysis</span><span class="w"> </span><span class="o">*</span><span class="nx">ServerHeaderAnalysis</span><span class="p">)</span><span class="w"> </span><span class="nx">ThreatLevel</span>
</span></code></pre></div>
<p>evaluateServerExposureThreatLevel calculates the security threat level based on server header information disclosure and known vulnerabilities.</p>
<p>This function implements a sophisticated threat assessment algorithm that combines:</p>
<ul>
<li>Quantitative exposure analysis (number of headers revealing information)</li>
<li>CVE vulnerability assessment from NIST NVD database</li>
<li>Heuristic pattern matching for high-risk configurations</li>
</ul>
<p>Three-Layer Assessment:</p>
<p>Layer 1: Base Threat (Exposure Count)</p>
<ul>
<li>0 exposures  None: No information disclosed</li>
<li>1-2 exposures  Info: Minimal disclosure</li>
<li>3-4 exposures  Low: Moderate disclosure</li>
<li>5+ exposures  Medium: Extensive disclosure</li>
</ul>
<p>Layer 2: CVE Enhancement (Vulnerability Database)</p>
<ul>
<li>Query NIST NVD for each detected technology</li>
<li>Assess CVE severity levels (High/Medium/Low)</li>
<li>Map CVE severity to threat levels:</li>
<li>High severity CVE present  Critical</li>
<li>6+ medium severity CVEs  High</li>
<li>1-5 medium severity CVEs  Medium</li>
<li>11+ low severity CVEs  Medium</li>
<li>1-10 low severity CVEs  Low</li>
</ul>
<p>Layer 3: Heuristic Enhancement (Risk Patterns)</p>
<ul>
<li>Debug/test/dev identifiers  Critical</li>
<li>Common web servers (Apache/Nginx/IIS)  High</li>
</ul>
<p>Priority Logic:</p>
<p>The function uses maximum threat level logic - if any layer identifies a higher threat, that level becomes the final assessment. This ensures critical vulnerabilities are never downgraded.</p>
<p>CVE Integration:</p>
<p>For each detected technology, the function:</p>
<ol>
<li>Creates CVE client instance</li>
<li>Queries NIST NVD API with technology name</li>
<li>Receives vulnerability assessment with severity counts</li>
<li>Maps CVE severity to our ThreatLevel enum</li>
<li>Updates threat level if higher than current assessment</li>
</ol>
<p>Parameters:</p>
<ul>
<li>analysis: ServerHeaderAnalysis containing exposure and technology data</li>
</ul>
<p>Returns:</p>
<ul>
<li>ThreatLevel: Final calculated threat level (None/Info/Low/Medium/High/Critical)</li>
</ul>
<p>Example:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-119-1"><a id="__codelineno-119-1" name="__codelineno-119-1" href="#__codelineno-119-1"></a>// Minimal exposure, no CVEs
</span><span id="__span-119-2"><a id="__codelineno-119-2" name="__codelineno-119-2" href="#__codelineno-119-2"></a>analysis := &amp;ServerHeaderAnalysis{
</span><span id="__span-119-3"><a id="__codelineno-119-3" name="__codelineno-119-3" href="#__codelineno-119-3"></a>    total_exposures: 1,
</span><span id="__span-119-4"><a id="__codelineno-119-4" name="__codelineno-119-4" href="#__codelineno-119-4"></a>    technologies: []string{&quot;Cloudflare&quot;},
</span><span id="__span-119-5"><a id="__codelineno-119-5" name="__codelineno-119-5" href="#__codelineno-119-5"></a>}
</span><span id="__span-119-6"><a id="__codelineno-119-6" name="__codelineno-119-6" href="#__codelineno-119-6"></a>level := evaluateServerExposureThreatLevel(analysis)
</span><span id="__span-119-7"><a id="__codelineno-119-7" name="__codelineno-119-7" href="#__codelineno-119-7"></a>// Returns: Info
</span><span id="__span-119-8"><a id="__codelineno-119-8" name="__codelineno-119-8" href="#__codelineno-119-8"></a>
</span><span id="__span-119-9"><a id="__codelineno-119-9" name="__codelineno-119-9" href="#__codelineno-119-9"></a>// Multiple exposures with vulnerable technology
</span><span id="__span-119-10"><a id="__codelineno-119-10" name="__codelineno-119-10" href="#__codelineno-119-10"></a>analysis := &amp;ServerHeaderAnalysis{
</span><span id="__span-119-11"><a id="__codelineno-119-11" name="__codelineno-119-11" href="#__codelineno-119-11"></a>    total_exposures: 5,
</span><span id="__span-119-12"><a id="__codelineno-119-12" name="__codelineno-119-12" href="#__codelineno-119-12"></a>    technologies: []string{&quot;Apache&quot;, &quot;PHP&quot;},  // Has known CVEs
</span><span id="__span-119-13"><a id="__codelineno-119-13" name="__codelineno-119-13" href="#__codelineno-119-13"></a>}
</span><span id="__span-119-14"><a id="__codelineno-119-14" name="__codelineno-119-14" href="#__codelineno-119-14"></a>level := evaluateServerExposureThreatLevel(analysis)
</span><span id="__span-119-15"><a id="__codelineno-119-15" name="__codelineno-119-15" href="#__codelineno-119-15"></a>// Returns: Critical (due to CVE assessment)
</span><span id="__span-119-16"><a id="__codelineno-119-16" name="__codelineno-119-16" href="#__codelineno-119-16"></a>
</span><span id="__span-119-17"><a id="__codelineno-119-17" name="__codelineno-119-17" href="#__codelineno-119-17"></a>// Debug environment exposed
</span><span id="__span-119-18"><a id="__codelineno-119-18" name="__codelineno-119-18" href="#__codelineno-119-18"></a>analysis := &amp;ServerHeaderAnalysis{
</span><span id="__span-119-19"><a id="__codelineno-119-19" name="__codelineno-119-19" href="#__codelineno-119-19"></a>    total_exposures: 2,
</span><span id="__span-119-20"><a id="__codelineno-119-20" name="__codelineno-119-20" href="#__codelineno-119-20"></a>    technologies: []string{&quot;Express-debug&quot;},
</span><span id="__span-119-21"><a id="__codelineno-119-21" name="__codelineno-119-21" href="#__codelineno-119-21"></a>}
</span><span id="__span-119-22"><a id="__codelineno-119-22" name="__codelineno-119-22" href="#__codelineno-119-22"></a>level := evaluateServerExposureThreatLevel(analysis)
</span><span id="__span-119-23"><a id="__codelineno-119-23" name="__codelineno-119-23" href="#__codelineno-119-23"></a>// Returns: Critical (heuristic match)
</span></code></pre></div>
<p>Security Context:</p>
<p>The threat level indicates:</p>
<ul>
<li>Critical: Immediate remediation required (CVE High or debug exposed)</li>
<li>High: Significant risk (common servers or multiple medium CVEs)</li>
<li>Medium: Moderate risk (multiple exposures or some CVEs)</li>
<li>Low: Minor risk (few exposures, low-severity CVEs)</li>
<li>Info: Informational (minimal exposure, no vulnerabilities)</li>
<li>None: Secure configuration (no disclosure)</li>
</ul>
<p><a name="evaluateXContentTypeOptionsThreatLevel"></a></p>
<h3 id="func-evaluatexcontenttypeoptionsthreatlevel">func evaluateXContentTypeOptionsThreatLevel<a class="headerlink" href="#func-evaluatexcontenttypeoptionsthreatlevel" title="Permanent link">&para;</a></h3>
<div class="language-go highlight"><pre><span></span><code><span id="__span-120-1"><a id="__codelineno-120-1" name="__codelineno-120-1" href="#__codelineno-120-1"></a><span class="kd">func</span><span class="w"> </span><span class="nx">evaluateXContentTypeOptionsThreatLevel</span><span class="p">(</span><span class="nx">metadata</span><span class="w"> </span><span class="kd">map</span><span class="p">[</span><span class="kt">string</span><span class="p">]</span><span class="kd">interface</span><span class="p">{})</span><span class="w"> </span><span class="nx">ThreatLevel</span>
</span></code></pre></div>
<p>evaluateXContentTypeOptionsThreatLevel determines the security threat level</p>
<p><a name="mapCVEThreatLevel"></a></p>
<h3 id="func-mapcvethreatlevel">func mapCVEThreatLevel<a class="headerlink" href="#func-mapcvethreatlevel" title="Permanent link">&para;</a></h3>
<div class="language-go highlight"><pre><span></span><code><span id="__span-121-1"><a id="__codelineno-121-1" name="__codelineno-121-1" href="#__codelineno-121-1"></a><span class="kd">func</span><span class="w"> </span><span class="nx">mapCVEThreatLevel</span><span class="p">(</span><span class="nx">assessment</span><span class="w"> </span><span class="nx">CVE</span><span class="p">.</span><span class="nx">VulnerabilityAssessment</span><span class="p">)</span><span class="w"> </span><span class="nx">ThreatLevel</span>
</span></code></pre></div>
<p>mapCVEThreatLevel maps CVE vulnerability assessment results from the NIST NVD database to the Engine-AntiGinx ThreatLevel enumeration.</p>
<p>This function translates CVSS (Common Vulnerability Scoring System) severity classifications into our internal threat level system, enabling consistent risk assessment across different vulnerability sources.</p>
<p>CVSS to ThreatLevel Mapping:</p>
<p>High Severity CVEs:</p>
<ul>
<li>Any high-severity vulnerability  Critical</li>
<li>Rationale: High-severity CVEs (CVSS 7.0-10.0) indicate serious vulnerabilities requiring immediate attention</li>
</ul>
<p>Medium Severity CVEs:</p>
<ul>
<li>6+ medium-severity vulnerabilities  High</li>
<li>1-5 medium-severity vulnerabilities  Medium</li>
<li>Rationale: Multiple medium vulnerabilities (CVSS 4.0-6.9) compound risk and warrant elevated threat levels</li>
</ul>
<p>Low Severity CVEs:</p>
<ul>
<li>11+ low-severity vulnerabilities  Medium</li>
<li>1-10 low-severity vulnerabilities  Low</li>
<li>Rationale: Large numbers of low-severity issues (CVSS 0.1-3.9) indicate poor maintenance and potential security debt</li>
</ul>
<p>No Vulnerabilities:</p>
<ul>
<li>CVE count &gt; 0 but no severity classified  Info</li>
<li>CVE count = 0  None</li>
<li>Rationale: Presence in CVE database warrants awareness</li>
</ul>
<p>Priority Logic:</p>
<p>The function uses a cascading if-else structure that prioritizes higher severity findings. Once a match is found, lower severity checks are skipped.</p>
<p>Parameters:</p>
<ul>
<li>assessment: VulnerabilityAssessment structure from CVE client containing:</li>
<li>CVECount: Total number of CVEs found</li>
<li>HighSeverity: Count of high-severity vulnerabilities</li>
<li>MediumSeverity: Count of medium-severity vulnerabilities</li>
<li>LowSeverity: Count of low-severity vulnerabilities</li>
</ul>
<p>Returns:</p>
<ul>
<li>ThreatLevel: Mapped threat level (None/Info/Low/Medium/High/Critical)</li>
</ul>
<p>Example:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-122-1"><a id="__codelineno-122-1" name="__codelineno-122-1" href="#__codelineno-122-1"></a>// High severity vulnerability present
</span><span id="__span-122-2"><a id="__codelineno-122-2" name="__codelineno-122-2" href="#__codelineno-122-2"></a>assessment := CVE.VulnerabilityAssessment{
</span><span id="__span-122-3"><a id="__codelineno-122-3" name="__codelineno-122-3" href="#__codelineno-122-3"></a>    CVECount: 8,
</span><span id="__span-122-4"><a id="__codelineno-122-4" name="__codelineno-122-4" href="#__codelineno-122-4"></a>    HighSeverity: 2,
</span><span id="__span-122-5"><a id="__codelineno-122-5" name="__codelineno-122-5" href="#__codelineno-122-5"></a>    MediumSeverity: 4,
</span><span id="__span-122-6"><a id="__codelineno-122-6" name="__codelineno-122-6" href="#__codelineno-122-6"></a>    LowSeverity: 2,
</span><span id="__span-122-7"><a id="__codelineno-122-7" name="__codelineno-122-7" href="#__codelineno-122-7"></a>}
</span><span id="__span-122-8"><a id="__codelineno-122-8" name="__codelineno-122-8" href="#__codelineno-122-8"></a>level := mapCVEThreatLevel(assessment)
</span><span id="__span-122-9"><a id="__codelineno-122-9" name="__codelineno-122-9" href="#__codelineno-122-9"></a>// Returns: Critical
</span><span id="__span-122-10"><a id="__codelineno-122-10" name="__codelineno-122-10" href="#__codelineno-122-10"></a>
</span><span id="__span-122-11"><a id="__codelineno-122-11" name="__codelineno-122-11" href="#__codelineno-122-11"></a>// Multiple medium severity vulnerabilities
</span><span id="__span-122-12"><a id="__codelineno-122-12" name="__codelineno-122-12" href="#__codelineno-122-12"></a>assessment := CVE.VulnerabilityAssessment{
</span><span id="__span-122-13"><a id="__codelineno-122-13" name="__codelineno-122-13" href="#__codelineno-122-13"></a>    CVECount: 7,
</span><span id="__span-122-14"><a id="__codelineno-122-14" name="__codelineno-122-14" href="#__codelineno-122-14"></a>    HighSeverity: 0,
</span><span id="__span-122-15"><a id="__codelineno-122-15" name="__codelineno-122-15" href="#__codelineno-122-15"></a>    MediumSeverity: 7,
</span><span id="__span-122-16"><a id="__codelineno-122-16" name="__codelineno-122-16" href="#__codelineno-122-16"></a>    LowSeverity: 0,
</span><span id="__span-122-17"><a id="__codelineno-122-17" name="__codelineno-122-17" href="#__codelineno-122-17"></a>}
</span><span id="__span-122-18"><a id="__codelineno-122-18" name="__codelineno-122-18" href="#__codelineno-122-18"></a>level := mapCVEThreatLevel(assessment)
</span><span id="__span-122-19"><a id="__codelineno-122-19" name="__codelineno-122-19" href="#__codelineno-122-19"></a>// Returns: High
</span><span id="__span-122-20"><a id="__codelineno-122-20" name="__codelineno-122-20" href="#__codelineno-122-20"></a>
</span><span id="__span-122-21"><a id="__codelineno-122-21" name="__codelineno-122-21" href="#__codelineno-122-21"></a>// Many low severity vulnerabilities
</span><span id="__span-122-22"><a id="__codelineno-122-22" name="__codelineno-122-22" href="#__codelineno-122-22"></a>assessment := CVE.VulnerabilityAssessment{
</span><span id="__span-122-23"><a id="__codelineno-122-23" name="__codelineno-122-23" href="#__codelineno-122-23"></a>    CVECount: 15,
</span><span id="__span-122-24"><a id="__codelineno-122-24" name="__codelineno-122-24" href="#__codelineno-122-24"></a>    HighSeverity: 0,
</span><span id="__span-122-25"><a id="__codelineno-122-25" name="__codelineno-122-25" href="#__codelineno-122-25"></a>    MediumSeverity: 0,
</span><span id="__span-122-26"><a id="__codelineno-122-26" name="__codelineno-122-26" href="#__codelineno-122-26"></a>    LowSeverity: 15,
</span><span id="__span-122-27"><a id="__codelineno-122-27" name="__codelineno-122-27" href="#__codelineno-122-27"></a>}
</span><span id="__span-122-28"><a id="__codelineno-122-28" name="__codelineno-122-28" href="#__codelineno-122-28"></a>level := mapCVEThreatLevel(assessment)
</span><span id="__span-122-29"><a id="__codelineno-122-29" name="__codelineno-122-29" href="#__codelineno-122-29"></a>// Returns: Medium
</span><span id="__span-122-30"><a id="__codelineno-122-30" name="__codelineno-122-30" href="#__codelineno-122-30"></a>
</span><span id="__span-122-31"><a id="__codelineno-122-31" name="__codelineno-122-31" href="#__codelineno-122-31"></a>// No vulnerabilities found
</span><span id="__span-122-32"><a id="__codelineno-122-32" name="__codelineno-122-32" href="#__codelineno-122-32"></a>assessment := CVE.VulnerabilityAssessment{
</span><span id="__span-122-33"><a id="__codelineno-122-33" name="__codelineno-122-33" href="#__codelineno-122-33"></a>    CVECount: 0,
</span><span id="__span-122-34"><a id="__codelineno-122-34" name="__codelineno-122-34" href="#__codelineno-122-34"></a>    HighSeverity: 0,
</span><span id="__span-122-35"><a id="__codelineno-122-35" name="__codelineno-122-35" href="#__codelineno-122-35"></a>    MediumSeverity: 0,
</span><span id="__span-122-36"><a id="__codelineno-122-36" name="__codelineno-122-36" href="#__codelineno-122-36"></a>    LowSeverity: 0,
</span><span id="__span-122-37"><a id="__codelineno-122-37" name="__codelineno-122-37" href="#__codelineno-122-37"></a>}
</span><span id="__span-122-38"><a id="__codelineno-122-38" name="__codelineno-122-38" href="#__codelineno-122-38"></a>level := mapCVEThreatLevel(assessment)
</span><span id="__span-122-39"><a id="__codelineno-122-39" name="__codelineno-122-39" href="#__codelineno-122-39"></a>// Returns: None
</span></code></pre></div>
<p>Security Standards Alignment:</p>
<p>CVSS Severity Ranges:</p>
<ul>
<li>None: 0.0</li>
<li>Low: 0.1-3.9</li>
<li>Medium: 4.0-6.9</li>
<li>High: 7.0-8.9</li>
<li>Critical: 9.0-10.0</li>
</ul>
<p>Related Functions:</p>
<ul>
<li>evaluateServerExposureThreatLevel(): Uses this function for CVE assessment</li>
<li>CVE.AssessTechnologyVulnerabilities(): Provides assessment data</li>
</ul>
<p><a name="ThreatLevel.MarshalJSON"></a></p>
<h3 id="func-threatlevel-marshaljson">func (ThreatLevel) MarshalJSON<a class="headerlink" href="#func-threatlevel-marshaljson" title="Permanent link">&para;</a></h3>
<div class="language-go highlight"><pre><span></span><code><span id="__span-123-1"><a id="__codelineno-123-1" name="__codelineno-123-1" href="#__codelineno-123-1"></a><span class="kd">func</span><span class="w"> </span><span class="p">(</span><span class="nx">t</span><span class="w"> </span><span class="nx">ThreatLevel</span><span class="p">)</span><span class="w"> </span><span class="nx">MarshalJSON</span><span class="p">()</span><span class="w"> </span><span class="p">([]</span><span class="kt">byte</span><span class="p">,</span><span class="w"> </span><span class="kt">error</span><span class="p">)</span>
</span></code></pre></div>
<p>MarshalJSON implements custom JSON marshaling for ThreatLevel, converting the enumeration value to its string representation in JSON output. This ensures human-readable JSON instead of numeric values.</p>
<p>Without this method, ThreatLevel would serialize as integers (0, 1, 2, etc.). With this method, it serializes as strings ("None", "Info", "Low", etc.).</p>
<p>This is particularly important for:</p>
<ul>
<li>API responses that need to be human-readable</li>
<li>Log files and reports</li>
<li>Integration with external systems expecting string values</li>
<li>Debugging and analysis</li>
</ul>
<p>Returns:</p>
<ul>
<li>[]byte: JSON-encoded string representation of the threat level</li>
<li>error: Error from JSON marshaling (typically nil)</li>
</ul>
<p>Example:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-124-1"><a id="__codelineno-124-1" name="__codelineno-124-1" href="#__codelineno-124-1"></a>result := TestResult{
</span><span id="__span-124-2"><a id="__codelineno-124-2" name="__codelineno-124-2" href="#__codelineno-124-2"></a>    Name: &quot;HTTPS Test&quot;,
</span><span id="__span-124-3"><a id="__codelineno-124-3" name="__codelineno-124-3" href="#__codelineno-124-3"></a>    ThreatLevel: High,
</span><span id="__span-124-4"><a id="__codelineno-124-4" name="__codelineno-124-4" href="#__codelineno-124-4"></a>}
</span><span id="__span-124-5"><a id="__codelineno-124-5" name="__codelineno-124-5" href="#__codelineno-124-5"></a>jsonData, _ := json.Marshal(result)
</span><span id="__span-124-6"><a id="__codelineno-124-6" name="__codelineno-124-6" href="#__codelineno-124-6"></a>// Output includes: &quot;ThreatLevel&quot;: &quot;High&quot; (not &quot;ThreatLevel&quot;: 4)
</span></code></pre></div>
<p><a name="ThreatLevel.String"></a></p>
<h3 id="func-threatlevel-string">func (ThreatLevel) String<a class="headerlink" href="#func-threatlevel-string" title="Permanent link">&para;</a></h3>
<div class="language-go highlight"><pre><span></span><code><span id="__span-125-1"><a id="__codelineno-125-1" name="__codelineno-125-1" href="#__codelineno-125-1"></a><span class="kd">func</span><span class="w"> </span><span class="p">(</span><span class="nx">t</span><span class="w"> </span><span class="nx">ThreatLevel</span><span class="p">)</span><span class="w"> </span><span class="nx">String</span><span class="p">()</span><span class="w"> </span><span class="kt">string</span>
</span></code></pre></div>
<p>String converts a ThreatLevel value to its human-readable string representation. This method implements the Stringer interface enabling automatic string conversion for logging, display, and debugging purposes.</p>
<p>String representations:</p>
<ul>
<li>None (0)  "None"</li>
<li>Info (1)  "Info"</li>
<li>Low (2)  "Low"</li>
<li>Medium (3)  "Medium"</li>
<li>High (4)  "High"</li>
<li>Critical (5)  "Critical"</li>
</ul>
<p>Returns:</p>
<ul>
<li>string: Human-readable threat level name</li>
</ul>
<p>Panics:</p>
<ul>
<li>Errors.Error: If the ThreatLevel value is invalid/unknown</li>
</ul>
<p>Example:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-126-1"><a id="__codelineno-126-1" name="__codelineno-126-1" href="#__codelineno-126-1"></a>level := High
</span><span id="__span-126-2"><a id="__codelineno-126-2" name="__codelineno-126-2" href="#__codelineno-126-2"></a>fmt.Println(level.String())  // Output: &quot;High&quot;
</span><span id="__span-126-3"><a id="__codelineno-126-3" name="__codelineno-126-3" href="#__codelineno-126-3"></a>fmt.Printf(&quot;Threat: %v\n&quot;, level)  // Output: &quot;Threat: High&quot;
</span></code></pre></div>
<p>Generated by <a href="https://github.com/princjef/gomarkdoc">gomarkdoc</a></p>







  
    
  
  
    
  


  <aside class="md-source-file">
    
      
  <span class="md-source-file__fact">
    <span class="md-icon" title="Last update">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1zM12.5 7v5.2l4 2.4-1 1L11 13V7zM11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2z"/></svg>
    </span>
    <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-timeago" title="February 16, 2026 17:07:14 UTC"><span class="timeago" datetime="2026-02-16T17:07:14+00:00" locale="en"></span></span><span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-iso_date" title="February 16, 2026 17:07:14 UTC">2026-02-16</span>
  </span>

    
    
      
  <span class="md-source-file__fact">
    <span class="md-icon" title="Created">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M14.47 15.08 11 13V7h1.5v5.25l3.08 1.83c-.41.28-.79.62-1.11 1m-1.39 4.84c-.36.05-.71.08-1.08.08-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8c0 .37-.03.72-.08 1.08.69.1 1.33.32 1.92.64.1-.56.16-1.13.16-1.72 0-5.5-4.5-10-10-10S2 6.5 2 12s4.47 10 10 10c.59 0 1.16-.06 1.72-.16-.32-.59-.54-1.23-.64-1.92M18 15v3h-3v2h3v3h2v-3h3v-2h-3v-3z"/></svg>
    </span>
    <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-timeago" title="February 16, 2026 17:07:14 UTC"><span class="timeago" datetime="2026-02-16T17:07:14+00:00" locale="en"></span></span><span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-iso_date" title="February 16, 2026 17:07:14 UTC">2026-02-16</span>
  </span>

    
    
    
  </aside>





                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2025 Antiginx Team. All rights reserved.
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        
<div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/prawo-i-piesc/engine-antiginx" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../..", "features": ["navigation.tabs", "navigation.sections", "navigation.path", "navigation.top", "navigation.instant", "navigation.tracking", "search.suggest", "search.highlight", "content.code.copy", "content.tooltips"], "search": "../../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.79ae519e.min.js"></script>
      
        <script src="../../js/timeago.min.js"></script>
      
        <script src="../../js/timeago_mkdocs_material.js"></script>
      
    
  </body>
</html>